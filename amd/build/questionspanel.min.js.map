{"version":3,"file":"questionspanel.min.js","sources":["../src/questionspanel.js"],"sourcesContent":["\"use strict\";\n/* eslint-disable no-unused-vars */ // TODO remove.\n\nimport jQuery from 'jquery';\nimport {get_strings as getStrings} from 'core/str';\nimport Ajax from 'core/ajax';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\n\nlet ACTION = {\n    COPYQUESTION: '[data-action=\"copy_question\"]',\n    DELETEQUESTION: '[data-action=\"delete_question\"]',\n    SELECTCATEGORY: '#id_movetocategory',\n    ADDQUESTIONS: '[data-action=\"add_questions\"]',\n    ADDQUESTION: '[data-action=\"add_question\"]',\n    SELECTTALL: '#selectall',\n};\n\nlet SERVICES = {\n    COPYQUESTION: 'mod_jqshow_copyquestion',\n    DELETEQUESTION: 'mod_jqshow_deletequestion',\n    SELECTCATEGORY: 'mod_jqshow_selectquestionscategory',\n};\n\nlet REGION = {\n    PANEL: '[data-region=\"questions-panel\"]',\n    NUMBERSELECT: '#number_select',\n    SELECTQUESTION: '.select_question',\n    CONTENTQUESTIONS: '[data-region=\"content-question\"]',\n    LOADING: '[data-region=\"overlay-icon-container\"]'\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading',\n    SUCCESS: 'core/notification_success',\n    ERROR: 'core/notification_error',\n    QUESTIONSFORSELECT: 'mod_jqshow/createsession/contentquestions'\n};\n\nlet cmId;\nlet sId;\n\n/**\n * @constructor\n * @param {String} selector The selector for the page region containing the page.\n */\nfunction QuestionsPanel(selector) {\n    this.node = jQuery(selector);\n    sId = this.node.attr('data-sid');\n    cmId = this.node.attr('data-cmid');\n    this.initPanel();\n}\n\n/** @type {jQuery} The jQuery node for the page region. */\nQuestionsPanel.prototype.node = null;\n\nQuestionsPanel.prototype.initPanel = function() {\n    this.node.find(ACTION.COPYQUESTION).on('click', this.copyQuestion);\n    this.node.find(ACTION.DELETEQUESTION).on('click', this.deleteQuestion);\n    this.node.find(ACTION.SELECTCATEGORY).on('change', this.selectCategory.bind(this));\n};\n\nQuestionsPanel.prototype.selectCategory = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let categoryKey = jQuery(e.currentTarget).val();\n    let identifier = jQuery(REGION.CONTENTQUESTIONS);\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        let identifier = jQuery(REGION.PANEL);\n        identifier.append(html);\n    });\n    let request = {\n        methodname: SERVICES.SELECTCATEGORY,\n        args: {\n            categorykey: categoryKey,\n            cmid: cmId\n        }\n    };\n    Ajax.call([request])[0].done(function(response) {\n        let templateQuestions = TEMPLATES.QUESTIONSFORSELECT;\n        Templates.render(templateQuestions, response).then(function(html, js) {\n            identifier.html(html);\n            Templates.runTemplateJS(js);\n            jQuery(REGION.LOADING).remove();\n            // Templates.replaceNode(this.node, html, js);\n        }).fail(Notification.exception);\n    });\n};\n\nQuestionsPanel.prototype.copyQuestion = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let questionId = jQuery(e.currentTarget).attr('data-questionnid');\n    alert('copyQuestion ' + questionId);\n};\n\nQuestionsPanel.prototype.deleteQuestion = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let questionId = jQuery(e.currentTarget).attr('data-questionnid');\n    alert('deleteQuestion ' + questionId);\n};\n\nexport const initQuestionsPanel = (selector) => {\n    return new QuestionsPanel(selector);\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","Object","defineProperty","_exports","value","initQuestionsPanel","_jquery","_ajax","_modal_factory","_modal_events","_templates","_notification","cmId","ACTION","SERVICES","REGION","TEMPLATES","QuestionsPanel","selector","this","node","jQuery","attr","initPanel","prototype","find","on","copyQuestion","deleteQuestion","selectCategory","bind","e","preventDefault","stopPropagation","categoryKey","currentTarget","val","identifier","Templates","render","visible","done","html","append","request","methodname","args","categorykey","cmid","Ajax","call","response","templateQuestions","then","js","runTemplateJS","remove","fail","Notification","exception","questionId","alert"],"mappings":"0PAS6C,SAAAA,uBAAAC,KAAAA,OAAAA,KAAAA,IAAAC,WAAAD,IAAAE,CAAAA,QAAAF,IAAA,CAThCG,OAAAC,eAAAC,SAAA,aAAA,CAAAC,OAAA,IAAAD,SAAAE,wBAAA,EAGbC,QAAAT,uBAAAS,SAEAC,MAAAV,uBAAAU,OACAC,eAAAX,uBAAAW,gBACAC,cAAAZ,uBAAAY,eACAC,WAAAb,uBAAAa,YACAC,cAAAd,uBAAAc,eAEA,IA8BIC,KA9BAC,oBACc,gCADdA,sBAEgB,kCAFhBA,sBAGgB,qBAMhBC,wBAGgB,qCAGhBC,aACO,kCADPA,wBAIkB,mCAJlBA,eAKS,yCAGTC,kBACS,uBADTA,6BAIoB,4CAUxB,SAASC,eAAeC,UACpBC,KAAKC,MAAO,EAAAC,QAAMrB,SAACkB,UACbC,KAAKC,KAAKE,KAAK,YACrBV,KAAOO,KAAKC,KAAKE,KAAK,aACtBH,KAAKI,WACT,CAGAN,eAAeO,UAAUJ,KAAO,KAEhCH,eAAeO,UAAUD,UAAY,WACjCJ,KAAKC,KAAKK,KAAKZ,qBAAqBa,GAAG,QAASP,KAAKQ,cACrDR,KAAKC,KAAKK,KAAKZ,uBAAuBa,GAAG,QAASP,KAAKS,gBACvDT,KAAKC,KAAKK,KAAKZ,uBAAuBa,GAAG,SAAUP,KAAKU,eAAeC,KAAKX,QAGhFF,eAAeO,UAAUK,eAAiB,SAASE,GAC/CA,EAAEC,iBACFD,EAAEE,kBACF,IAAIC,aAAc,EAAAb,QAAMrB,SAAC+B,EAAEI,eAAeC,MACtCC,YAAa,EAAAhB,QAAAA,SAAON,yBACxBuB,WAAAA,QAAUC,OAAOvB,kBAAmB,CAACwB,SAAS,IAAOC,MAAK,SAASC,OAC9C,EAAArB,QAAAA,SAAON,cACb4B,OAAOD,KACtB,IACA,IAAIE,QAAU,CACVC,WAAY/B,wBACZgC,KAAM,CACFC,YAAab,YACbc,KAAMpC,OAGdqC,MAAAA,QAAKC,KAAK,CAACN,UAAU,GAAGH,MAAK,SAASU,UAClC,IAAIC,kBAAoBpC,6BACxBsB,WAAAA,QAAUC,OAAOa,kBAAmBD,UAAUE,MAAK,SAASX,KAAMY,IAC9DjB,WAAWK,KAAKA,MAChBJ,WAAAA,QAAUiB,cAAcD,KACxB,EAAAjC,QAAAA,SAAON,gBAAgByC,QAE1B,IAAEC,KAAKC,cAAY1D,QAAC2D,UACzB,KAGJ1C,eAAeO,UAAUG,aAAe,SAASI,GAC7CA,EAAEC,iBACFD,EAAEE,kBACF,IAAI2B,YAAa,EAAAvC,QAAAA,SAAOU,EAAEI,eAAeb,KAAK,oBAC9CuC,MAAM,gBAAkBD,aAG5B3C,eAAeO,UAAUI,eAAiB,SAASG,GAC/CA,EAAEC,iBACFD,EAAEE,kBACF,IAAI2B,YAAa,EAAAvC,QAAAA,SAAOU,EAAEI,eAAeb,KAAK,oBAC9CuC,MAAM,kBAAoBD,aAK5BzD,SAAAE,mBAFgC,SAACa,UAC/B,OAAO,IAAID,eAAeC,UAC5B"}