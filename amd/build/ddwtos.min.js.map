{"version":3,"file":"ddwtos.min.js","sources":["../src/ddwtos.js"],"sourcesContent":["\"use strict\";\n\nimport jQuery from 'jquery';\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport Notification from 'core/notification';\nimport mEvent from 'core/event';\n\nlet ACTION = {\n    SEND_RESPONSE: '[data-action=\"send-response\"]',\n};\n\nlet REGION = {\n    ROOT: '[data-region=\"question-content\"]',\n    LOADING: '[data-region=\"overlay-icon-container\"]',\n    NEXT: '[data-action=\"next-question\"]',\n    TIMER: '[data-region=\"question-timer\"]',\n    SECONDS: '[data-region=\"seconds\"]',\n    CONTENTFEEDBACKS: '[data-region=\"containt-feedbacks\"]',\n    FEEDBACK: '[data-region=\"statement-feedback\"]',\n    FEEDBACKANSWER: '[data-region=\"answer-feedback\"]',\n    FEEDBACKBACGROUND: '[data-region=\"feedback-background\"]',\n    AREA: '#drag_and_drop_area',\n    DRAGELEMENT: '.draghome.user-select-none',\n    DROPELEMENT: '.drop.active'\n};\n\nlet SERVICES = {\n    REPLY: 'mod_jqshow_ddwtos'\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading'\n};\n\nlet cmId;\nlet sId;\nlet questionid;\nlet jqshowId;\nlet jqid;\nlet questionEnd = false;\nlet showQuestionFeedback = false;\nlet manualMode = false;\n\n/** @type {jQuery} The jQuery node for the page region. */\nDdwtos.prototype.node = null;\nDdwtos.prototype.endTimer = new Event('endTimer');\nDdwtos.prototype.studentQuestionEnd = new Event('studentQuestionEnd');\n\n/**\n * @constructor\n * @param {String} selector\n * @param {Boolean} showquestionfeedback\n * @param {Boolean} manualmode\n * @param {String} jsonresponse\n */\nfunction Ddwtos(selector, showquestionfeedback = false, manualmode = false, jsonresponse = '') {\n    this.node = jQuery(selector);\n    sId = this.node.attr('data-sid');\n    cmId = this.node.attr('data-cmid');\n    questionid = this.node.attr('data-questionid');\n    jqshowId = this.node.attr('data-jqshowid');\n    jqid = this.node.attr('data-jqid');\n    showQuestionFeedback = showquestionfeedback;\n    manualMode = manualmode;\n    questionEnd = false;\n    if (jsonresponse !== '') {\n        this.answered(JSON.parse(jsonresponse));\n        if (manualMode === false || jQuery('.modal-body').length) {\n            questionEnd = true;\n            if (showQuestionFeedback === true) {\n                this.showFeedback();\n            }\n            this.showAnswers();\n        }\n    }\n    Ddwtos.prototype.initDdwtos();\n}\n\nDdwtos.prototype.initDdwtos = function() {\n    jQuery(ACTION.SEND_RESPONSE).on('click', Ddwtos.prototype.reply);\n    Ddwtos.prototype.initEvents();\n    Ddwtos.prototype.resizeAllDragsAndDrops();\n    Ddwtos.prototype.initDragAndDrop();\n};\n\nDdwtos.prototype.initEvents = function() {\n    addEventListener('timeFinish', Ddwtos.prototype.reply, {once: true});\n    if (manualMode !== false) {\n        addEventListener('teacherQuestionEnd_' + jqid, (e) => {\n            if (questionEnd !== true) {\n                Ddwtos.prototype.reply();\n            }\n            e.detail.statistics.forEach((statistic) => {\n                jQuery('[data-answerid=\"' + statistic.answerid + '\"] .numberofreplies').html(statistic.numberofreplies);\n            });\n        }, {once: true});\n        addEventListener('pauseQuestion_' + jqid, () => {\n            Ddwtos.prototype.pauseQuestion();\n        }, false);\n        addEventListener('playQuestion_' + jqid, () => {\n            Ddwtos.prototype.playQuestion();\n        }, false);\n        addEventListener('showAnswers_' + jqid, () => {\n            Ddwtos.prototype.showAnswers();\n        }, false);\n        addEventListener('hideAnswers_' + jqid, () => {\n            Ddwtos.prototype.hideAnswers();\n        }, false);\n        addEventListener('showStatistics_' + jqid, () => {\n            Ddwtos.prototype.showStatistics();\n        }, false);\n        addEventListener('hideStatistics_' + jqid, () => {\n            Ddwtos.prototype.hideStatistics();\n        }, false);\n        addEventListener('showFeedback_' + jqid, () => {\n            Ddwtos.prototype.showFeedback();\n        }, false);\n        addEventListener('hideFeedback_' + jqid, () => {\n            Ddwtos.prototype.hideFeedback();\n        }, false);\n    }\n\n    window.onbeforeunload = function() {\n        if (jQuery(REGION.SECONDS).length > 0 && questionEnd === false) {\n            Ddwtos.prototype.reply();\n            return 'Because the question is overdue and an attempt has been made to reload the page,' +\n                ' the question has remained unanswered.';\n        }\n    };\n};\n\nDdwtos.prototype.resizeAllDragsAndDrops = function() {\n    let thisQ = this;\n    jQuery(REGION.AREA).find('.answercontainer > div').each(function(i, node) {\n        thisQ.resizeAllDragsAndDropsInGroup(\n            thisQ.getClassnameNumericSuffix(jQuery(node), 'draggrouphomes'));\n    });\n};\n\nDdwtos.prototype.resizeAllDragsAndDropsInGroup = function(group) {\n    let thisQ = this,\n        dragHomes = jQuery(REGION.AREA).find('.draggrouphomes' + group + ' span.draghome'),\n        maxWidth = 0,\n        maxHeight = 0;\n\n    // Find the maximum size of any drag in this groups.\n    dragHomes.each(function(i, drag) {\n        maxWidth = Math.max(maxWidth, Math.ceil(drag.offsetWidth));\n        maxHeight = Math.max(maxHeight, Math.ceil(0 + drag.offsetHeight));\n    });\n\n    // The size we will want to set is a bit bigger than this.\n    maxWidth += 8;\n    maxHeight += 2;\n\n    // Set each drag home to that size.\n    dragHomes.each(function(i, drag) {\n        thisQ.setElementSize(drag, maxWidth, maxHeight);\n    });\n\n    // Set each drop to that size.\n    jQuery(REGION.AREA).find('span.drop.group' + group).each(function(i, drop) {\n        thisQ.setElementSize(drop, maxWidth, maxHeight);\n    });\n};\n\nDdwtos.prototype.setElementSize = function(element, width, height) {\n    jQuery(element).width(width).height(height).css('lineHeight', height + 'px');\n};\n\nDdwtos.prototype.getClassnameNumericSuffix = function(node, prefix) {\n    let classes = node.attr('class');\n    if (classes !== '') {\n        let classesArr = classes.split(' ');\n        for (let index = 0; index < classesArr.length; index++) {\n            let patt1 = new RegExp('^' + prefix + '([0-9])+$');\n            if (patt1.test(classesArr[index])) {\n                let patt2 = new RegExp('([0-9])+$');\n                let match = patt2.exec(classesArr[index]);\n                return Number(match[0]);\n            }\n        }\n    }\n    return null;\n};\n\nDdwtos.prototype.initDragAndDrop = function() {\n    let dragElements = [...document.querySelectorAll(REGION.DRAGELEMENT)];\n    dragElements.forEach(function(dragElement) {\n        dragElement.setAttribute('draggable', 'true');\n        dragElement.addEventListener('drag', (e) => {\n            Ddwtos.prototype.drag(e);\n        });\n        dragElement.addEventListener('dragstart', (e) => {\n            Ddwtos.prototype.drag(e);\n        });\n    });\n    let dropElements = [...document.querySelectorAll(REGION.DROPELEMENT)];\n    dropElements.forEach(function(dropElement) {\n        dropElement.addEventListener('drop', (e) => {\n            Ddwtos.prototype.drop(e);\n        });\n        dropElement.addEventListener('dragover', (e) => {\n            Ddwtos.prototype.allowDrop(e);\n        });\n    });\n    // eslint-disable-next-line no-console\n    console.log(dragElements, dropElements);\n};\n\nDdwtos.prototype.allowDrop = function(e) {\n    e.preventDefault();\n    // eslint-disable-next-line no-console\n    console.log('allowDrop');\n};\n\nDdwtos.prototype.drag = function(e) {\n    e.preventDefault();\n    // eslint-disable-next-line no-console\n    console.log('drag');\n    e.dataTransfer.setData('text', e.target.id);\n};\n\nDdwtos.prototype.drop = function(e) {\n    e.preventDefault();\n    // eslint-disable-next-line no-console\n    console.log('drop');\n    let data = e.dataTransfer.getData('text');\n    e.target.appendChild(document.getElementById(data));\n};\n\nDdwtos.prototype.removeEvents = function() {\n    removeEventListener('timeFinish', Ddwtos.prototype.reply, {once: true});\n};\n\nDdwtos.prototype.reply = function() {\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        jQuery(REGION.ROOT).append(html);\n        dispatchEvent(Ddwtos.prototype.endTimer);\n        Ddwtos.prototype.removeEvents();\n        let timeLeft = parseInt(jQuery(REGION.SECONDS).text());\n        let request = {\n            methodname: SERVICES.REPLY,\n            args: {\n                sessionid: sId,\n                jqshowid: jqshowId,\n                cmid: cmId,\n                questionid: questionid,\n                jqid: jqid,\n                timeleft: timeLeft || 0,\n                preview: false\n            }\n        };\n        Ajax.call([request])[0].done(function(response) {\n            if (response.reply_status === true) {\n                questionEnd = true;\n                Ddwtos.prototype.answered(response);\n                dispatchEvent(Ddwtos.prototype.studentQuestionEnd);\n                if (jQuery('.modal-body').length) { // Preview.\n                    Ddwtos.prototype.showAnswers();\n                    if (showQuestionFeedback === true) {\n                        Ddwtos.prototype.showFeedback();\n                    }\n                } else {\n                    if (manualMode === false) {\n                        Ddwtos.prototype.showAnswers();\n                        if (showQuestionFeedback === true) {\n                            Ddwtos.prototype.showFeedback();\n                        }\n                    }\n                }\n            } else {\n                alert('error');\n            }\n            jQuery(REGION.LOADING).remove();\n        }).fail(Notification.exception);\n    });\n};\n\nDdwtos.prototype.answered = function(response) {\n    questionEnd = true;\n    if (response.hasfeedbacks) {\n        jQuery(REGION.FEEDBACK).html(response.statment_feedback);\n        jQuery(REGION.FEEDBACKANSWER).html(response.answer_feedback);\n    }\n    jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(REGION.NEXT).removeClass('d-none');\n    mEvent.notifyFilterContentUpdated(document.querySelector(REGION.CONTENTFEEDBACKS));\n};\n\nDdwtos.prototype.pauseQuestion = function() {\n    dispatchEvent(new Event('pauseQuestion'));\n    jQuery(REGION.TIMER).css('z-index', 3);\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(ACTION.REPLY).css('pointer-events', 'none');\n};\n\nDdwtos.prototype.playQuestion = function() {\n    if (questionEnd !== true) {\n        dispatchEvent(new Event('playQuestion'));\n        jQuery(REGION.TIMER).css('z-index', 1);\n        jQuery(REGION.FEEDBACKBACGROUND).css('display', 'none');\n        jQuery(ACTION.REPLY).css('pointer-events', 'auto');\n    }\n};\n\nDdwtos.prototype.showFeedback = function() {\n    if (questionEnd === true) {\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'block', 'z-index': 3});\n    }\n};\n\nDdwtos.prototype.hideFeedback = function() {\n    if (questionEnd === true) {\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'none', 'z-index': 0});\n    }\n};\n\nDdwtos.prototype.showAnswers = function() {\n    if (questionEnd === true) {\n        // TODO obtain the possible answers, and paint them in a list.\n        jQuery(REGION.ANSWERHELP).removeClass('d-none').css({'z-index': 3});\n    }\n};\n\nDdwtos.prototype.hideAnswers = function() {\n    if (questionEnd === true) {\n        jQuery(REGION.ANSWERHELP).addClass('d-none');\n    }\n};\n\nexport const initDdwtos = (selector, showquestionfeedback, manualmode, jsonresponse) => {\n    return new Ddwtos(selector, showquestionfeedback, manualmode, jsonresponse);\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","_toConsumableArray","arr","_arrayWithoutHoles","Array","isArray","_arrayLikeToArray","iter","Symbol","iterator","from","_iterableToArray","o","minLen","n","Object","prototype","toString","call","slice","constructor","name","test","_unsupportedIterableToArray","TypeError","_nonIterableSpread","len","length","i","arr2","defineProperty","_exports","value","initDdwtos","_jquery","_ajax","_templates","_notification","_event","cmId","sId","questionid","jqshowId","jqid","ACTION","SEND_RESPONSE","REGION","ROOT","LOADING","NEXT","TIMER","SECONDS","CONTENTFEEDBACKS","FEEDBACK","FEEDBACKANSWER","FEEDBACKBACGROUND","AREA","DRAGELEMENT","DROPELEMENT","SERVICES","TEMPLATES","questionEnd","showQuestionFeedback","manualMode","Ddwtos","selector","showquestionfeedback","arguments","undefined","manualmode","jsonresponse","this","node","jQuery","attr","answered","JSON","parse","showFeedback","showAnswers","endTimer","Event","studentQuestionEnd","on","reply","initEvents","resizeAllDragsAndDrops","initDragAndDrop","addEventListener","once","e","detail","statistics","forEach","statistic","answerid","html","numberofreplies","pauseQuestion","playQuestion","hideAnswers","showStatistics","hideStatistics","hideFeedback","window","onbeforeunload","thisQ","find","each","resizeAllDragsAndDropsInGroup","getClassnameNumericSuffix","group","dragHomes","maxWidth","maxHeight","drag","Math","max","ceil","offsetWidth","offsetHeight","setElementSize","drop","element","width","height","css","prefix","classes","classesArr","split","index","RegExp","match","exec","Number","dragElements","document","querySelectorAll","dragElement","setAttribute","dropElements","dropElement","allowDrop","console","log","preventDefault","dataTransfer","setData","target","id","data","getData","appendChild","getElementById","removeEvents","removeEventListener","Templates","render","visible","done","append","dispatchEvent","timeLeft","parseInt","text","request","methodname","args","sessionid","jqshowid","cmid","timeleft","preview","Ajax","response","reply_status","alert","remove","fail","Notification","exception","hasfeedbacks","statment_feedback","answer_feedback","addClass","removeClass","mEvent","notifyFilterContentUpdated","querySelector","REPLY","display","ANSWERHELP"],"mappings":"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"}