{"version":3,"file":"question_report.min.js","sources":["../src/question_report.js"],"sourcesContent":["\"use strict\";\n/* eslint-disable no-unused-vars */\n\nimport jQuery from 'jquery';\nimport Templates from 'core/templates';\nimport ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport ModalJqshow from 'mod_jqshow/modal';\nimport Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport {get_string as getString} from 'core/str';\n\nlet REGION = {\n    ROOT: '[data-region=\"question-report\"]', // This root.\n    LOADING: '[data-region=\"overlay-icon-container\"]',\n};\n\nlet ACTION = {\n    QUESTIONPREVIEW: '[data-action=\"question-preview\"]',\n};\n\nlet SERVICES = {\n    GETQUESTION: 'mod_jqshow_getquestion',\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading',\n    QUESTION: 'mod_jqshow/questions/encasement'\n};\n\nQuestionReport.prototype.root = null;\n\n/**\n * @constructor\n * @param {String} region\n */\nfunction QuestionReport(region) {\n    this.root = jQuery(region);\n    this.root.find(ACTION.QUESTIONPREVIEW).on('click', this.questionPreview);\n}\n\nQuestionReport.prototype.questionPreview = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let sessionId = jQuery(e.currentTarget).attr('data-sessionid');\n    let questionnId = jQuery(e.currentTarget).attr('data-questionnid');\n    let cmId = jQuery(e.currentTarget).attr('data-cmid');\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        let identifier = jQuery(REGION.ROOT);\n        identifier.append(html);\n        let request = {\n            methodname: SERVICES.GETQUESTION,\n            args: {\n                cmid: cmId,\n                sid: sessionId,\n                jqid: questionnId\n            }\n        };\n        Ajax.call([request])[0].done(function(question) {\n            Templates.render(TEMPLATES.QUESTION, question).then(function(html, js) {\n                getString('preview', 'mod_jqshow').done((title) => {\n                    ModalFactory.create({\n                        classes: 'modal_jqshow',\n                        body: html,\n                        title: title,\n                        footer: '',\n                        type: ModalJqshow.TYPE\n                    }).then(modal => {\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            modal.destroy();\n                        });\n                        jQuery(REGION.LOADING).remove();\n                        modal.show();\n                        Templates.runTemplateJS(js);\n                    }).fail(Notification.exception);\n                }).fail(Notification.exception);\n            });\n        });\n    });\n};\n\nexport const questionReport = (region) => {\n    return new QuestionReport(region);\n};\n"],"names":["_interopRequireDefault","obj","__esModule","default","Object","defineProperty","_exports","value","questionReport","_jquery","_templates","_modal_factory","_modal_events","_modal","_ajax","_notification","REGION","ACTION","SERVICES","TEMPLATES","QuestionReport","region","this","root","jQuery","find","on","questionPreview","prototype","e","preventDefault","stopPropagation","sessionId","currentTarget","attr","questionnId","cmId","Templates","render","visible","done","html","append","request","methodname","args","cmid","sid","jqid","Ajax","call","question","then","js","getString","title","ModalFactory","create","classes","body","footer","type","ModalJqshow","TYPE","modal","getRoot","ModalEvents","hidden","destroy","remove","show","runTemplateJS","fail","Notification","exception"],"mappings":"qRAS6C,SAAAA,uBAAAC,KAAAA,OAAAA,KAAAA,IAAAC,WAAAD,IAAAE,CAAAA,QAAAF,IAAA,CAThCG,OAAAC,eAAAC,SAAA,aAAA,CAAAC,OAAA,IAAAD,SAAAE,oBAAA,EAGbC,QAAAT,uBAAAS,SACAC,WAAAV,uBAAAU,YACAC,eAAAX,uBAAAW,gBACAC,cAAAZ,uBAAAY,eACAC,OAAAb,uBAAAa,QACAC,MAAAd,uBAAAc,OACAC,cAAAf,uBAAAe,eAGA,IAAIC,YACM,kCADNA,eAES,yCAGTC,uBACiB,mCAGjBC,qBACa,yBAGbC,kBACS,uBADTA,mBAEU,kCASd,SAASC,eAAeC,QACpBC,KAAKC,MAAO,EAAAC,QAAMrB,SAACkB,QACnBC,KAAKC,KAAKE,KAAKR,wBAAwBS,GAAG,QAASJ,KAAKK,gBAC5D,CATAP,eAAeQ,UAAUL,KAAO,KAWhCH,eAAeQ,UAAUD,gBAAkB,SAASE,GAChDA,EAAEC,iBACFD,EAAEE,kBACF,IAAIC,WAAY,EAAAR,QAAAA,SAAOK,EAAEI,eAAeC,KAAK,kBACzCC,aAAc,EAAAX,QAAAA,SAAOK,EAAEI,eAAeC,KAAK,oBAC3CE,MAAO,EAAAZ,QAAAA,SAAOK,EAAEI,eAAeC,KAAK,aACxCG,WAAAA,QAAUC,OAAOnB,kBAAmB,CAACoB,SAAS,IAAOC,MAAK,SAASC,OAC9C,EAAAjB,QAAAA,SAAOR,aACb0B,OAAOD,MAClB,IAAIE,QAAU,CACVC,WAAY1B,qBACZ2B,KAAM,CACFC,KAAMV,KACNW,IAAKf,UACLgB,KAAMb,cAGdc,MAAAA,QAAKC,KAAK,CAACP,UAAU,GAAGH,MAAK,SAASW,UAClCd,WAAAA,QAAUC,OAAOnB,mBAAoBgC,UAAUC,MAAK,SAASX,KAAMY,KAC/D,EAAAC,KAAAA,YAAU,UAAW,cAAcd,MAAK,SAACe,OACrCC,eAAYrD,QAACsD,OAAO,CAChBC,QAAS,eACTC,KAAMlB,KACNc,MAAOA,MACPK,OAAQ,GACRC,KAAMC,eAAYC,OACnBX,MAAK,SAAAY,OACJA,MAAMC,UAAUvC,GAAGwC,cAAW/D,QAACgE,QAAQ,WACnCH,MAAMI,SACV,KACA,EAAA5C,QAAAA,SAAOR,gBAAgBqD,SACvBL,MAAMM,OACNjC,WAAAA,QAAUkC,cAAclB,GAC3B,IAAEmB,KAAKC,cAAYtE,QAACuE,UACxB,IAAEF,KAAKC,cAAYtE,QAACuE,UACzB,GACJ,GACJ,KAKFpE,SAAAE,eAF4B,SAACa,QAC3B,OAAO,IAAID,eAAeC,QAC5B"}