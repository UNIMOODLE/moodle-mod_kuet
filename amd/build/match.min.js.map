{"version":3,"file":"match.min.js","sources":["../src/match.js"],"sourcesContent":["\"use strict\";\n/* eslint-disable no-unused-vars */\n\nimport jQuery from 'jquery';\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\n\nlet ACTION = {\n    SEND_RESPONSE: '[data-action=\"send-match\"]',\n};\n\nlet REGION = {\n    ROOT: '[data-region=\"question-content\"]',\n    LOADING: '[data-region=\"overlay-icon-container\"]',\n    LEFT_OPTION: '#dragOption',\n    RIGHT_OPTION: '#dropOption',\n    CONTAINER_ANSWERS: '#dragQuestion',\n    CANVAS: '#canvas',\n    CANVASTEMP: '#canvasTemp',\n    LEFT_OPTION_SELECTOR: '#dragOption .option',\n    OPTION: '.option',\n    CLEARPATH: '#dropOption .drop-element',\n    POINTER: '.option-pointer'\n};\n\nlet SERVICES = {\n    REPLY: 'mod_jqshow_match'\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading'\n};\n\nlet cmId;\nlet sId;\nlet questionid;\nlet jqshowId;\nlet jqid;\nlet questionEnd = false;\nlet correctAnswers = null;\nlet showQuestionFeedback = false;\nlet manualMode = false;\nlet startPoint;\nlet color;\nlet toucheX;\nlet toucheY;\nlet linkList = [];\n/* Let linkList = [{dragId: \"7-draggable\", dropId: \"7-dropzone\", color: \"#264653\"}]; */ // Example for user response\nlet linkCorrection = []; // TODO\n/* let linkCorrection = [{dragId: \"7-draggable\", dropId: \"7-dropzone\", color: \"#33991a\"},\n    {dragId: \"8-draggable\", dropId: \"8-dropzone\", color: \"#4c061d\"},\n    {dragId: \"9-draggable\", dropId: \"9-dropzone\", color: \"#d17a22\"},\n    {dragId: \"10-draggable\", dropId: \"10-dropzone\", color: \"#3b3923\"},\n    {dragId: \"11-draggable\", dropId: \"11-dropzone\", color: \"#3b5249\"}]; // TODO */\n\n/** @type {jQuery} The jQuery node for the page region. */\nMatch.prototype.node = null;\nMatch.prototype.endTimer = new Event('endTimer');\nMatch.prototype.studentQuestionEnd = new Event('studentQuestionEnd');\n\n/**\n * @constructor\n * @param {String} selector\n * @param {Boolean} showquestionfeedback\n * @param {Boolean} manualmode\n * @param {String} jsonresponse\n */\nfunction Match(selector, showquestionfeedback = false, manualmode = false, jsonresponse = '') {\n    this.node = jQuery(selector);\n    sId = this.node.attr('data-sid');\n    cmId = this.node.attr('data-cmid');\n    questionid = this.node.attr('data-questionid');\n    jqshowId = this.node.attr('data-jqshowid');\n    jqid = this.node.attr('data-jqid');\n    showQuestionFeedback = showquestionfeedback;\n    manualMode = manualmode;\n    questionEnd = false;\n    if (jsonresponse !== '') {\n        linkList = JSON.parse(jsonresponse);\n        // TODO show feedback, and avoid clicks.\n    }\n    this.initMatch();\n    this.createLinkCorrection();\n}\n\nMatch.prototype.initMatch = function() {\n    let height = jQuery(REGION.LEFT_OPTION).height();\n    jQuery(REGION.CANVAS).attr('height', height);\n    jQuery(REGION.CANVAS).attr('width', jQuery(REGION.CANVAS).width());\n\n    jQuery(REGION.CANVASTEMP).attr('width', jQuery(REGION.CANVASTEMP).width());\n    jQuery(REGION.CANVASTEMP).attr('height', height);\n    jQuery(REGION.CONTAINER_ANSWERS).bind('dragover', function(){\n        let top = window.event.pageY,\n            left = window.event.pageX;\n        Match.prototype.drawLinkTemp(startPoint, {top, left});\n    });\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.addEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.addTargetEvents(dropEl));\n    Match.prototype.drawLinks();\n    jQuery(REGION.CLEARPATH).on('click', Match.prototype.clearPath.bind(this));\n    jQuery(ACTION.SEND_RESPONSE).on('click', Match.prototype.sendResponse);\n};\n\nMatch.prototype.createLinkCorrection = function() { // TODO is unnecessary for debugging.\n    jQuery.each(jQuery(REGION.LEFT_OPTION_SELECTOR), function(index, item) {\n        let dragId = jQuery(item).data('stems') + '-draggable';\n        let steam = Match.prototype.baseConvert(jQuery(item).data('stems'), 2, 16);\n        let dropId = Match.prototype.baseConvert(steam, 10, 26) + '-draggable';\n        linkCorrection.push({dragId: dragId, dropId: dropId});\n    });\n};\n\nMatch.prototype.getRandomColor = function(position) {\n    let colorArray = ['#FF6633', '#FFB399', '#FF33FF', '#FF9999', '#00B3E6',\n                      '#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',\n                      '#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A',\n                      '#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',\n                      '#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC',\n                      '#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',\n                      '#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n                      '#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',\n                      '#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3',\n                      '#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF'];\n    return colorArray[position];\n};\n\nMatch.prototype.sendResponse = function() {\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        jQuery(REGION.ROOT).append(html);\n        dispatchEvent(Match.prototype.endTimer);\n        let timeLeft = parseInt(jQuery(REGION.SECONDS).text());\n        let result = 3; // No response\n        let corrects = 0;\n        let fails = 0;\n        linkList.forEach(userR =>{\n            if (userR.stemDragId === userR.stemDropId) {\n                userR.color = \"green\";\n                corrects++;\n            } else {\n                userR.color = \"red\";\n                fails++;\n            }\n        });\n        if (corrects !== 0) {\n            result = 2; // Partially\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === corrects) {\n            result = 1; // Correct\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === fails) {\n            result = 0; // Failure\n        }\n        Match.prototype.drawLinks();\n\n        let request = {\n            methodname: SERVICES.REPLY,\n            args: {\n                jsonresponse: JSON.stringify(linkList),\n                result: result,\n                sessionid: sId,\n                jqshowid: jqshowId,\n                cmid: cmId,\n                questionid: questionid,\n                jqid: jqid,\n                timeleft: timeLeft || 0,\n                preview: false\n            }\n        };\n        Ajax.call([request])[0].done(function(response) {\n            if (response.reply_status === true) {\n                // TODO show feedbacks.\n                jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n                dispatchEvent(Match.prototype.studentQuestionEnd);\n            } else {\n                alert('error');\n            }\n            jQuery(REGION.LOADING).remove();\n        });\n    });\n};\n\n/* Add event */\nMatch.prototype.addEventsDragAndDrop = function(el) {\n    // TODO clicks.\n    el.addEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.addEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.addEventListener('touchstart', Match.prototype.touchStart, false);\n    el.addEventListener('touchmove', Match.prototype.touchMove, false);\n    el.addEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.addTargetEvents = function(target) {\n    target.addEventListener('dragover', Match.prototype.onDragOver, false);\n    target.addEventListener('drop', Match.prototype.onDrop, false);\n};\n\n/* DRAG AND DROP */\nMatch.prototype.onDragStart = function(event) {\n    event\n        .dataTransfer\n        .setData('text/plain', event.target.id);\n    startPoint = event.target.id;\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(event.currentTarget));\n};\n\nMatch.prototype.onDragOver = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDragEnd = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDrop = function(event) {\n    const dragId = event\n        .dataTransfer\n        .getData('text');\n\n    const dropId = jQuery(event.currentTarget).find(REGION.POINTER).attr('id');\n    Match.prototype.Drop(dragId, dropId);\n};\n\nMatch.prototype.Drop = function(dragId, dropId){\n    let deselected = linkList.filter(obj => {\n        return obj.dragId === dragId || obj.dropId === dropId;\n    });\n    if (deselected.length) {\n        deselected.forEach(x => {\n            let selectroDropId = jQuery(\"#\" + x.dropId);\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n            selectroDropId.find(\"i\").removeClass('linked');\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n        });\n    }\n\n    linkList = linkList.filter(obj => {\n        return obj.dragId !== dragId;\n    });\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== dropId;\n    });\n\n    let stemDragId = Match.prototype.baseConvert(jQuery('#' + dragId).data('forstems'), 2, 16);\n    let stemDropId = Match.prototype.baseConvert(jQuery('#' + dropId).data('forstems'), 26, 10);\n\n    linkList.push({dragId, dropId, color, stemDragId, stemDropId});\n    Match.prototype.drawLinks();\n    Match.prototype.clearPathTemp();\n};\n\nMatch.prototype.baseConvert = function(number, frombase, tobase) {\n    // eslint-disable-next-line no-bitwise\n    return parseInt(number + '', frombase | 0).toString(tobase | 0);\n};\n\n/* TOUCHE DEVICE */\nMatch.prototype.touchStart = function(e) {\n    let dragEl = e.path.find(x => {\n        return x.className === \"drag-element\";\n    });\n    startPoint = jQuery(dragEl).get(0).id;\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(event.currentTarget));\n};\n\nMatch.prototype.touchMove = function(e) {\n    e.preventDefault();\n    let top = toucheY = e.touches[0].pageY,\n        left = toucheX = e.touches[0].pageX;\n    Match.prototype.drawLinkTemp(startPoint, {top, left});\n};\n\nMatch.prototype.touchEnd = function(e) {\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(target => {\n        let box2 = target.getBoundingClientRect(),\n            x = box2.left,\n            y = box2.top,\n            h = target.offsetHeight,\n            w = target.offsetWidth,\n            b = y + h,\n            r = x + w;\n\n        if (toucheX > x && toucheX < r && toucheY > y && toucheY < b) {\n            Match.prototype.Drop(startPoint, target.id);\n        } else {\n            return false;\n        }\n    });\n    Match.prototype.clearPathTemp();\n    e.preventDefault();\n};\n\n/* Draw final line */\nMatch.prototype.drawLinks = function() {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    linkList.forEach(link => Match.prototype.drawLink(link.dragId, link.dropId, link.color));\n};\n\nMatch.prototype.drawLink = function(obj1, obj2, pColor) {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let $obj2 = jQuery(\"#\" + obj2);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = $obj2.offset();\n    let w2 = $obj2.width();\n    let h2 = $obj2.height();\n    let wc = jQuery(REGION.CANVAS).width();\n    ctx.beginPath();\n    ctx.strokeStyle = pColor ? pColor : color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n    ctx.bezierCurveTo(wc / 2, p1.top - parent.top + (h1 / 2) - 20 - 2,\n        wc / 2, p2.top - parent.top + (h2 / 2) - 20 - 2,\n        wc - 4, p2.top - parent.top + (h2 / 2) - 20 - 2);\n    ctx.stroke();\n\n    $obj1.children().css('color', pColor ? pColor : color);\n    $obj1.children().css('font-weight', '900');\n    $obj2.children().css('color', pColor ? pColor : color);\n    $obj2.children().css('font-weight', '900');\n    $obj2.children().addClass('linked');\n};\n\nMatch.prototype.clearPath = function(event) {\n    let ident = event.currentTarget.id;\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== ident;\n    });\n    let dragQuestionObject = jQuery(REGION.CONTAINER_ANSWERS);\n    dragQuestionObject.find(\"i\").removeClass('linked');\n    dragQuestionObject.find(\"i\").css('font-weight', '400');\n    dragQuestionObject.find(\"i\").css('color', '#5a57ff');\n    Match.prototype.drawLinks();\n};\n\n/* Draw path mouse line */\nMatch.prototype.drawLinkTemp = function(obj1, coordPt) {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = coordPt;\n    let c = jQuery(REGION.CANVASTEMP).offset();\n\n    ctx.beginPath();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n\n    ctx.bezierCurveTo((p2.left - c.left) / 2, p1.top - parent.top - 19 - 2,\n        (p2.left - c.left) / 2,p2.top - parent.top - 19 - 2,\n        p2.left - c.left, p2.top - parent.top - 19 - 2);\n    Match.prototype.clearPathTemp();\n    ctx.stroke();\n};\n\nMatch.prototype.clearPathTemp = function() {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n};\n\n\nexport const initMatch = (selector, showquestionfeedback, manualmode, jsonresponse) => {\n    return new Match(selector, showquestionfeedback, manualmode, jsonresponse);\n};"],"names":["_interopRequireDefault","obj","__esModule","default","Object","defineProperty","_exports","value","initMatch","_jquery","_ajax","_templates","cmId","sId","questionid","jqshowId","jqid","startPoint","color","toucheX","toucheY","ACTION","REGION","ROOT","LOADING","LEFT_OPTION","RIGHT_OPTION","CONTAINER_ANSWERS","CANVAS","CANVASTEMP","LEFT_OPTION_SELECTOR","OPTION","CLEARPATH","POINTER","SERVICES","TEMPLATES","linkList","linkCorrection","Match","selector","showquestionfeedback","arguments","length","undefined","manualmode","jsonresponse","this","node","jQuery","attr","JSON","parse","createLinkCorrection","prototype","endTimer","Event","studentQuestionEnd","_this","height","width","bind","top","window","event","pageY","left","pageX","drawLinkTemp","find","toArray","forEach","dragEl","addEventsDragAndDrop","dropEl","addTargetEvents","drawLinks","on","clearPath","sendResponse","each","index","item","dragId","data","steam","baseConvert","dropId","push","getRandomColor","position","Templates","render","visible","done","html","append","dispatchEvent","timeLeft","parseInt","SECONDS","text","result","corrects","fails","userR","stemDragId","stemDropId","request","methodname","args","stringify","sessionid","jqshowid","cmid","timeleft","preview","Ajax","call","response","reply_status","addClass","alert","remove","el","addEventListener","onDragStart","onDragEnd","touchStart","touchMove","touchEnd","target","onDragOver","onDrop","dataTransfer","setData","id","options","document","querySelectorAll","Array","from","indexOf","currentTarget","clearPathTemp","preventDefault","getData","Drop","deselected","filter","x","selectroDropId","css","removeClass","number","frombase","tobase","toString","e","path","className","get","touches","box2","getBoundingClientRect","y","h","offsetHeight","w","offsetWidth","canvas","getContext","clearRect","link","drawLink","obj1","obj2","pColor","ctx","$obj1","$obj2","parent","offset","p1","h1","p2","h2","wc","beginPath","strokeStyle","lineWidth","moveTo","bezierCurveTo","stroke","children","ident","dragQuestionObject","coordPt","c"],"mappings":"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"}