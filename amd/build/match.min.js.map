{"version":3,"file":"match.min.js","sources":["../src/match.js"],"sourcesContent":["\"use strict\";\n/* eslint-disable no-unused-vars */\n\nimport jQuery from 'jquery';\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport mEvent from 'core/event';\n\nlet ACTION = {\n    SEND_RESPONSE: '[data-action=\"send-match\"]',\n};\n\nlet REGION = {\n    ROOT: '[data-region=\"question-content\"]',\n    MATCH: '[data-region=\"match\"]',\n    LOADING: '[data-region=\"overlay-icon-container\"]',\n    LEFT_OPTION: '#dragOption',\n    RIGHT_OPTION: '#dropOption',\n    CONTAINER_ANSWERS: '#dragQuestion',\n    CANVAS: '#canvas',\n    CANVASTEMP: '#canvasTemp',\n    LEFT_OPTION_SELECTOR: '#dragOption .option',\n    LEFT_OPTION_CLICKABLE: '#dragOption .option.option-left .content-option',\n    RIGHT_OPTION_CLICKABLE: '#dropOption .option.option-right .content-option',\n    OPTION: '.option',\n    CLEARPATH: '#dropOption .drop-element',\n    POINTER: '.option-pointer',\n    NEXT: '[data-action=\"next-question\"]',\n    TIMER: '[data-region=\"question-timer\"]',\n    SECONDS: '[data-region=\"seconds\"]',\n    CONTENTFEEDBACKS: '[data-region=\"containt-feedbacks\"]',\n    FEEDBACK: '[data-region=\"statement-feedback\"]',\n    FEEDBACKANSWER: '[data-region=\"answer-feedback\"]',\n    FEEDBACKBACGROUND: '[data-region=\"feedback-background\"]',\n};\n\nlet SERVICES = {\n    REPLY: 'mod_jqshow_match'\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading'\n};\n\nlet cmId;\nlet sId;\nlet questionid;\nlet jqshowId;\nlet jqid;\nlet questionEnd = false;\nlet correctAnswers = null;\nlet showQuestionFeedback = false;\nlet manualMode = false;\nlet startPoint;\nlet color;\nlet toucheX;\nlet toucheY;\nlet linkList = [];\nlet linkCorrection = [];\nlet showingAnswers = false;\nlet showingFeedback = false;\n\n/** @type {jQuery} The jQuery node for the page region. */\nMatch.prototype.node = null;\nMatch.prototype.endTimer = new Event('endTimer');\nMatch.prototype.studentQuestionEnd = new Event('studentQuestionEnd');\n\n/**\n * @constructor\n * @param {String} selector\n * @param {Boolean} showquestionfeedback\n * @param {Boolean} manualmode\n * @param {String} jsonresponse\n */\nfunction Match(selector, showquestionfeedback = false, manualmode = false, jsonresponse = '') {\n    this.node = jQuery(selector);\n    sId = this.node.attr('data-sid');\n    cmId = this.node.attr('data-cmid');\n    questionid = this.node.attr('data-questionid');\n    jqshowId = this.node.attr('data-jqshowid');\n    jqid = this.node.attr('data-jqid');\n    showQuestionFeedback = showquestionfeedback;\n    manualMode = manualmode;\n    questionEnd = false;\n    linkList = [];\n    this.createLinkCorrection();\n    if (jsonresponse !== '') {\n        this.answered(jsonresponse);\n        if (manualMode === false || jQuery('.modal-body').length) {\n            questionEnd = true;\n            if (showQuestionFeedback === true) {\n                this.showFeedback();\n            }\n            this.showAnswers();\n        }\n    }\n    setTimeout(() => { // For modal preview, is executed before the DOM is rendered.\n        this.initMatch();\n    }, 500);\n}\n\nMatch.prototype.answered = function(jsonresponse) {\n    Match.prototype.allDisabled();\n    linkList = JSON.parse(jsonresponse);\n    Match.prototype.drawResponse();\n    questionEnd = true;\n    jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(REGION.CONTAINER_ANSWERS).css('z-index', 3);\n    if (manualMode === false) {\n        jQuery(REGION.NEXT).removeClass('d-none');\n    }\n    mEvent.notifyFilterContentUpdated(document.querySelector(REGION.CONTENTFEEDBACKS));\n};\n\nMatch.prototype.initMatch = function() {\n    let heightLeft = jQuery(REGION.LEFT_OPTION).height();\n    let heightRight = jQuery(REGION.RIGHT_OPTION).height();\n    let canvasHeight = heightLeft > heightRight ? heightLeft : heightRight;\n    jQuery(REGION.CANVAS).attr('height', canvasHeight);\n    jQuery(REGION.CANVAS).attr('width', jQuery(REGION.CANVAS).width());\n\n    jQuery(REGION.CANVASTEMP).attr('width', jQuery(REGION.CANVASTEMP).width());\n    jQuery(REGION.CANVASTEMP).attr('height', canvasHeight);\n    jQuery(REGION.CONTAINER_ANSWERS).bind('dragover', function(){\n        let top = window.event.pageY,\n            left = window.event.pageX;\n        Match.prototype.drawLinkTemp(startPoint, {top, left});\n    });\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.addEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.addTargetEvents(dropEl));\n    Match.prototype.drawLinks();\n    jQuery(REGION.CLEARPATH).on('click', Match.prototype.clearPath.bind(this));\n    jQuery(REGION.LEFT_OPTION_CLICKABLE).on('click', Match.prototype.leftOptionSelected.bind(this));\n    jQuery(ACTION.SEND_RESPONSE).off('click');\n    jQuery(ACTION.SEND_RESPONSE).on('click', Match.prototype.sendResponse);\n    Match.prototype.initEvents();\n};\n\nMatch.prototype.initEvents = function() {\n    addEventListener('timeFinish', Match.prototype.sendResponse, {once: true});\n    if (manualMode !== false) {\n        addEventListener('teacherQuestionEnd_' + jqid, (e) => {\n            if (questionEnd !== true) {\n                Match.prototype.sendResponse();\n            }\n        }, {once: true});\n        addEventListener('pauseQuestion_' + jqid, () => {\n            Match.prototype.pauseQuestion();\n        }, false);\n        addEventListener('playQuestion_' + jqid, () => {\n            Match.prototype.playQuestion();\n        }, false);\n        addEventListener('showAnswers_' + jqid, () => {\n            Match.prototype.showAnswers();\n        }, false);\n        addEventListener('hideAnswers_' + jqid, () => {\n            Match.prototype.hideAnswers();\n        }, false);\n        addEventListener('showStatistics_' + jqid, () => {\n            Match.prototype.showStatistics();\n        }, false);\n        addEventListener('hideStatistics_' + jqid, () => {\n            Match.prototype.hideStatistics();\n        }, false);\n        addEventListener('showFeedback_' + jqid, () => {\n            Match.prototype.showFeedback();\n        }, false);\n        addEventListener('hideFeedback_' + jqid, () => {\n            Match.prototype.hideFeedback();\n        }, false);\n    }\n\n    window.onbeforeunload = function() {\n        if (jQuery(REGION.SECONDS).length > 0 && questionEnd === false) {\n            Match.prototype.sendResponse();\n            return 'Because the question is overdue and an attempt has been made to reload the page,' +\n                ' the question has remained unanswered.';\n        }\n    };\n};\n\nMatch.prototype.removeEvents = function() {\n    removeEventListener('timeFinish', () => Match.prototype.sendResponse, {once: true});\n};\n\nMatch.prototype.createLinkCorrection = function() {\n    linkCorrection = [];\n    jQuery.each(jQuery(REGION.LEFT_OPTION_SELECTOR), function(index, item) {\n        let dragId = jQuery(item).data('stems') + '-draggable';\n        let steam = Match.prototype.baseConvert(jQuery(item).data('stems'), 2, 16);\n        let dropId = Match.prototype.baseConvert(steam, 10, 26) + '-dropzone';\n        linkCorrection.push({dragId: dragId, dropId: dropId});\n    });\n};\n\nMatch.prototype.getRandomColor = function(position) {\n    let colorArray = ['#FF6633', '#FFB399', '#FF33FF', '#FF9999', '#00B3E6',\n                      '#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',\n                      '#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A',\n                      '#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',\n                      '#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC',\n                      '#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',\n                      '#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n                      '#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',\n                      '#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3',\n                      '#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF'];\n    return colorArray[position];\n};\n\nMatch.prototype.drawResponse = function(fromTeacher = false) {\n    let corrects = 0;\n    let fails = 0;\n    linkList.forEach(userR => {\n        let optionLeft = jQuery('#' + userR.dragId).parents('.option-left').first();\n        let optionRight = jQuery('#' + userR.dropId).parents('.option-right').first();\n        if (userR.stemDragId === userR.stemDropId) { // CORRECT.\n            if (manualMode === false || jQuery('.modal-body').length || fromTeacher === true) {\n                userR.color = '#0fd08c';\n                optionLeft.find('.feedback-icon.correct').css({'display': 'flex'});\n                optionLeft.find('.content-option').removeClass('bg-primary').css({'background-color': '#0fd08c'});\n                optionRight.find('.content-option').removeClass('bg-primary').css({'background-color': '#0fd08c'});\n            }\n            corrects++;\n        } else { // INCORRECT.\n            if (manualMode === false || jQuery('.modal-body').length || fromTeacher === true) {\n                userR.color = '#f85455';\n                optionLeft.find('.feedback-icon.incorrect').css({'display': 'flex'});\n                optionLeft.find('.content-option').removeClass('bg-primary').css({'background-color': '#f85455'});\n                optionRight.find('.content-option').removeClass('bg-primary').css({'background-color': '#f85455'});\n            }\n            fails++;\n        }\n    });\n    return [corrects, fails];\n};\n\nMatch.prototype.hideResponse = function() {\n    let corrects = 0;\n    let fails = 0;\n    linkList.forEach(userR => {\n        let optionLeft = jQuery('#' + userR.dragId).parents('.option-left').first();\n        let optionRight = jQuery('#' + userR.dropId).parents('.option-right').first();\n        userR.color = Match.prototype.getRandomColor(linkList.indexOf(userR));\n        optionLeft.find('.feedback-icon').css({'display': 'none'});\n        optionLeft.find('.content-option').css({'background-color': 'inherit'}).addClass('bg-primary');\n        optionRight.find('.content-option').css({'background-color': 'inherit'}).addClass('bg-primary');\n    });\n    return [corrects, fails];\n};\n\nMatch.prototype.showCorrects = function() {\n    let corrects = 0;\n    let fails = 0;\n    linkCorrection.forEach(userR => {\n        let optionLeft = jQuery('#' + userR.dragId).parents('.option-left').first();\n        let optionRight = jQuery('#' + userR.dropId).parents('.option-right').first();\n        userR.color = '#0fd08c';\n    });\n    return [corrects, fails];\n};\n\nMatch.prototype.sendResponse = function() {\n    Match.prototype.allDisabled();\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        jQuery(REGION.ROOT).append(html);\n        dispatchEvent(Match.prototype.endTimer);\n        Match.prototype.removeEvents();\n        let timeLeft = parseInt(jQuery(REGION.SECONDS).text());\n        let result = 3; // No response.\n        let [corrects, fails] = Match.prototype.drawResponse();\n        if (corrects !== 0) {\n            result = 2; // Partially.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === corrects) {\n            result = 1; // Correct.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === fails) {\n            result = 0; // Failure.\n        }\n        Match.prototype.drawLinks();\n\n        let request = {\n            methodname: SERVICES.REPLY,\n            args: {\n                jsonresponse: JSON.stringify(linkList),\n                result: result,\n                sessionid: sId,\n                jqshowid: jqshowId,\n                cmid: cmId,\n                questionid: questionid,\n                jqid: jqid,\n                timeleft: timeLeft || 0,\n                preview: false\n            }\n        };\n        Ajax.call([request])[0].done(function(response) {\n            if (response.reply_status === true) {\n                questionEnd = true;\n                jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n                jQuery(REGION.NEXT).removeClass('d-none');\n                dispatchEvent(Match.prototype.studentQuestionEnd);\n                if (response.hasfeedbacks) {\n                    jQuery(REGION.FEEDBACK).html(response.statment_feedback);\n                    jQuery(REGION.FEEDBACKANSWER).html(response.answer_feedback);\n                }\n                if (jQuery('.modal-body').length) { // Preview.\n                    Match.prototype.showAnswers();\n                    if (showQuestionFeedback === true) {\n                        Match.prototype.showFeedback();\n                    }\n                } else {\n                    if (manualMode === false) {\n                        Match.prototype.showAnswers();\n                        if (showQuestionFeedback === true) {\n                            Match.prototype.showFeedback();\n                        }\n                    }\n                }\n                jQuery(REGION.CONTAINER_ANSWERS).css('z-index', 3);\n                jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n                if (manualMode === false) {\n                    linkList = [];\n                }\n            } else {\n                alert('error');\n            }\n            jQuery(REGION.LOADING).remove();\n        });\n    });\n};\n\n/* Add event */\nMatch.prototype.addEventsDragAndDrop = function(el) {\n    el.addEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.addEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.addEventListener('touchstart', Match.prototype.touchStart, false);\n    el.addEventListener('touchmove', Match.prototype.touchMove, false);\n    el.addEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.removeEventsDragAndDrop = function(el) {\n    el.removeEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.removeEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.removeEventListener('touchstart', Match.prototype.touchStart, false);\n    el.removeEventListener('touchmove', Match.prototype.touchMove, false);\n    el.removeEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.addTargetEvents = function(target) {\n    target.addEventListener('dragover', Match.prototype.onDragOver, false);\n    target.addEventListener('drop', Match.prototype.onDrop, false);\n};\n\nMatch.prototype.removeTargetEvents = function(target) {\n    target.removeEventListener('dragover', Match.prototype.onDragOver, false);\n    target.removeEventListener('drop', Match.prototype.onDrop, false);\n};\n\n/* DRAG AND DROP */\nMatch.prototype.onDragStart = function(event) {\n    event\n        .dataTransfer\n        .setData('text/plain', event.target.id);\n    startPoint = event.target.id;\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(event.currentTarget));\n};\n\nMatch.prototype.onDragOver = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDragEnd = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDrop = function(event) {\n    const dragId = event\n        .dataTransfer\n        .getData('text');\n\n    const dropId = jQuery(event.currentTarget).find(REGION.POINTER).attr('id');\n    Match.prototype.Drop(dragId, dropId);\n};\n\nMatch.prototype.Drop = function(dragId, dropId){\n    let deselected = linkList.filter(obj => {\n        return obj.dragId === dragId || obj.dropId === dropId;\n    });\n    if (deselected.length) {\n        deselected.forEach(x => {\n            let selectroDropId = jQuery(\"#\" + x.dropId);\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n            selectroDropId.find(\"i\").removeClass('linked');\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n        });\n    }\n\n    linkList = linkList.filter(obj => {\n        return obj.dragId !== dragId;\n    });\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== dropId;\n    });\n\n    let stemDragId = Match.prototype.baseConvert(jQuery('#' + dragId).data('forstems'), 2, 16);\n    let stemDropId = Match.prototype.baseConvert(jQuery('#' + dropId).data('forstems'), 26, 10);\n\n    linkList.push({dragId, dropId, color, stemDragId, stemDropId});\n    Match.prototype.drawLinks();\n    Match.prototype.clearPathTemp();\n};\n\nMatch.prototype.baseConvert = function(number, frombase, tobase) {\n    // eslint-disable-next-line no-bitwise\n    return parseInt(number + '', frombase | 0).toString(tobase | 0);\n};\n\n/* TOUCHE DEVICE */\nMatch.prototype.touchStart = function(e) {\n    if (e.target.id === undefined || e.target.id === '') {\n        if (jQuery(e.target).parent().attr('id') !== undefined) {\n            startPoint = jQuery(e.target).parent().attr('id');\n        } else {\n            startPoint = jQuery(e.target).closest('.option-left').find(\".drag-element\").first().attr('id');\n        }\n    }\n\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(e.currentTarget));\n};\n\nMatch.prototype.touchMove = function(e) {\n    e.preventDefault();\n    let top = toucheY = e.touches[0].pageY,\n        left = toucheX = e.touches[0].pageX;\n    Match.prototype.drawLinkTemp(startPoint, {top, left});\n};\n\nMatch.prototype.touchEnd = function(e) {\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(target => {\n        let box2 = target.getBoundingClientRect(),\n            x = box2.left,\n            y = box2.top,\n            h = target.offsetHeight,\n            w = target.offsetWidth,\n            b = y + h,\n            r = x + w;\n\n        if (toucheX > x && toucheX < r && toucheY > y && toucheY < b) {\n            let dropId;\n            if (target.id === undefined || target.id === '' || target.id === 'dropOption') {\n                if (jQuery(target).parent().attr('id') !== undefined && jQuery(target).parent().attr('id') !== 'dropOption') {\n                    dropId = jQuery(target).parent().attr('id');\n                } else {\n                    dropId = jQuery(target).closest('.option-right').find(\".drop-element\").first().attr('id');\n                }\n            } else {\n                dropId = target.id;\n            }\n            Match.prototype.Drop(startPoint, dropId);\n        } else {\n            return false;\n        }\n    });\n    Match.prototype.clearPathTemp();\n    e.preventDefault();\n};\n\n/* Draw final line */\nMatch.prototype.drawLinks = function() {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    linkList.forEach(link => Match.prototype.drawLink(link.dragId, link.dropId, link.color));\n};\n\nMatch.prototype.drawCorrectLinks = function() {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    linkCorrection.forEach(link => Match.prototype.drawLink(link.dragId, link.dropId, link.color));\n};\n\nMatch.prototype.drawLink = function(obj1, obj2, pColor) {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let $obj2 = jQuery(\"#\" + obj2);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = $obj2.offset();\n    let w2 = $obj2.width();\n    let h2 = $obj2.height();\n    let wc = jQuery(REGION.CANVAS).width();\n    ctx.beginPath();\n    ctx.strokeStyle = pColor ? pColor : color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n    ctx.bezierCurveTo(wc / 2, p1.top - parent.top + (h1 / 2) - 20 - 2,\n        wc / 2, p2.top - parent.top + (h2 / 2) - 20 - 2,\n        wc - 4, p2.top - parent.top + (h2 / 2) - 20 - 2);\n    ctx.stroke();\n\n    $obj1.children().css('color', pColor ? pColor : color);\n    $obj1.children().css('font-weight', '900');\n    $obj2.children().css('color', pColor ? pColor : color);\n    $obj2.children().css('font-weight', '900');\n    $obj2.children().addClass('linked');\n};\n\nMatch.prototype.clearPath = function(event) {\n    let ident = event.currentTarget.id;\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== ident;\n    });\n    let dragQuestionObject = jQuery(REGION.CONTAINER_ANSWERS);\n    dragQuestionObject.find(\"i\").removeClass('linked');\n    dragQuestionObject.find(\"i\").css('font-weight', '400');\n    dragQuestionObject.find(\"i\").css('color', '#5a57ff');\n    Match.prototype.drawLinks();\n};\n\n/* Draw path mouse line */\nMatch.prototype.drawLinkTemp = function(obj1, coordPt) {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = coordPt;\n    let c = jQuery(REGION.CANVASTEMP).offset();\n\n    ctx.beginPath();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n\n    ctx.bezierCurveTo((p2.left - c.left) / 2, p1.top - parent.top - 19 - 2,\n        (p2.left - c.left) / 2,p2.top - parent.top - 19 - 2,\n        p2.left - c.left, p2.top - parent.top - 19 - 2);\n    Match.prototype.clearPathTemp();\n    ctx.stroke();\n};\n\nMatch.prototype.clearPathTemp = function() {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n};\n\n/* CLICKS */\nMatch.prototype.leftOptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        if (e.target !== item) {\n            jQuery(item).parent().addClass('disabled');\n        } else {\n            jQuery(item).parents('.option').first().find('.option-pointer').addClass('disabled');\n        }\n    });\n    jQuery.each(jQuery(REGION.CLEARPATH), function(index, item) {\n        jQuery(item).addClass('disabled');\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'inherit'});\n    });\n    jQuery(REGION.RIGHT_OPTION_CLICKABLE).on('click', Match.prototype.rightOptionSelected.bind(this));\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(jQuery(e.target).parents('.option').first().get(0)));\n};\n\nMatch.prototype.rightOptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let dragId = jQuery('.option-left:not(.disabled)').find('.drag-element').attr('id');\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        if (e.target === item) {\n            let dropId = jQuery(item).parents('.option-right').first().find('.drop-element').attr('id');\n            document.getElementById(dropId).click();\n            Match.prototype.Drop(dragId, dropId);\n            jQuery(dragId).removeClass('disabled');\n        }\n        jQuery('.option-left').removeClass('disabled');\n        jQuery('.drag-element').removeClass('disabled');\n        jQuery(REGION.RIGHT_OPTION_CLICKABLE).off('click');\n        jQuery.each(jQuery(REGION.CLEARPATH), function(index, item) {\n            jQuery(item).removeClass('disabled');\n        });\n        jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'none'});\n        });\n    });\n};\n\nMatch.prototype.allDisabled = function() {\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.POINTER), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery(REGION.CONTAINER_ANSWERS).unbind('dragover');\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.removeEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.removeTargetEvents(dropEl));\n    jQuery(REGION.CLEARPATH).off('click');\n    jQuery(REGION.LEFT_OPTION_CLICKABLE).off('click');\n    jQuery(ACTION.SEND_RESPONSE).off('click');\n};\n\n/* EVENTS */ // TODO adjust.\nMatch.prototype.pauseQuestion = function() {\n    dispatchEvent(new Event('pauseQuestion'));\n    jQuery(REGION.TIMER).css('z-index', 3);\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(ACTION.REPLY).css('pointer-events', 'none');\n    jQuery.each(jQuery('.drag-element'), function(index, item) {\n        jQuery(item).css({'z-index': '0'});\n    });\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n};\n\nMatch.prototype.playQuestion = function() {\n    if (questionEnd !== true) {\n        dispatchEvent(new Event('playQuestion'));\n        jQuery(REGION.TIMER).css('z-index', 1);\n        jQuery(REGION.FEEDBACKBACGROUND).css('display', 'none');\n        jQuery(ACTION.REPLY).css('pointer-events', 'auto');\n        jQuery.each(jQuery('.drag-element'), function(index, item) {\n            jQuery(item).css({'z-index': '2'});\n        });\n        jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'inherit'});\n        });\n        jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'inherit'});\n        });\n    }\n};\n\nMatch.prototype.showAnswers = function() {\n    showingAnswers = true;\n    Match.prototype.drawResponse(true);\n    Match.prototype.drawLinks();\n};\n\nMatch.prototype.hideAnswers = function() {\n    showingAnswers = false;\n    Match.prototype.hideResponse();\n    Match.prototype.drawLinks();\n    if (showingFeedback) {\n        Match.prototype.showFeedback();\n    } else {\n        Match.prototype.hideFeedback();\n    }\n};\n\nMatch.prototype.showStatistics = function() {};\n\nMatch.prototype.hideStatistics = function() {};\n\nMatch.prototype.showFeedback = function() {\n    if (questionEnd === true) {\n        showingFeedback = true;\n        if (jQuery('.modal-body').length === 0 && manualMode === true) {\n            Match.prototype.hideResponse();\n            Match.prototype.showCorrects();\n            Match.prototype.drawCorrectLinks();\n        }\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'block', 'z-index': 3});\n    }\n};\n\nMatch.prototype.hideFeedback = function() {\n    if (questionEnd === true) {\n        showingFeedback = false;\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'none', 'z-index': 0});\n        if (showingAnswers) {\n            Match.prototype.drawResponse(true);\n            Match.prototype.drawLinks();\n        } else {\n            Match.prototype.hideResponse();\n            Match.prototype.drawLinks();\n        }\n    }\n};\n\n\nexport const initMatch = (selector, showquestionfeedback, manualmode, jsonresponse) => {\n    return new Match(selector, showquestionfeedback, manualmode, jsonresponse);\n};\n"],"names":["cmId","sId","questionid","jqshowId","jqid","startPoint","color","toucheX","toucheY","ACTION","SEND_RESPONSE","REGION","SERVICES","TEMPLATES","questionEnd","showQuestionFeedback","manualMode","linkList","linkCorrection","showingAnswers","showingFeedback","Match","selector","showquestionfeedback","manualmode","jsonresponse","node","this","attr","createLinkCorrection","answered","length","showFeedback","showAnswers","setTimeout","initMatch","prototype","endTimer","Event","studentQuestionEnd","allDisabled","JSON","parse","drawResponse","addClass","css","removeClass","notifyFilterContentUpdated","document","querySelector","heightLeft","height","heightRight","canvasHeight","width","bind","top","window","event","pageY","left","pageX","drawLinkTemp","find","toArray","forEach","dragEl","addEventsDragAndDrop","dropEl","addTargetEvents","drawLinks","on","clearPath","leftOptionSelected","off","sendResponse","initEvents","addEventListener","once","e","pauseQuestion","playQuestion","hideAnswers","showStatistics","hideStatistics","hideFeedback","onbeforeunload","removeEvents","removeEventListener","each","index","item","dragId","data","steam","baseConvert","dropId","push","getRandomColor","position","fromTeacher","corrects","fails","userR","optionLeft","parents","first","optionRight","stemDragId","stemDropId","hideResponse","indexOf","showCorrects","render","visible","done","html","append","dispatchEvent","timeLeft","parseInt","text","result","request","methodname","args","stringify","sessionid","jqshowid","cmid","timeleft","preview","call","response","reply_status","hasfeedbacks","statment_feedback","answer_feedback","alert","remove","el","onDragStart","onDragEnd","touchStart","touchMove","touchEnd","removeEventsDragAndDrop","target","onDragOver","onDrop","removeTargetEvents","dataTransfer","setData","id","options","querySelectorAll","Array","from","currentTarget","clearPathTemp","preventDefault","getData","Drop","deselected","filter","obj","x","selectroDropId","number","frombase","tobase","toString","undefined","parent","closest","touches","box2","getBoundingClientRect","y","h","offsetHeight","w","offsetWidth","canvas","get","getContext","clearRect","link","drawLink","drawCorrectLinks","obj1","obj2","pColor","ctx","$obj1","$obj2","offset","p1","h1","p2","h2","wc","beginPath","strokeStyle","lineWidth","moveTo","bezierCurveTo","stroke","children","ident","dragQuestionObject","coordPt","c","stopPropagation","rightOptionSelected","getElementById","click","unbind","REPLY"],"mappings":"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"}