{"version":3,"file":"match.min.js","sources":["../src/match.js"],"sourcesContent":["\"use strict\";\n/* eslint-disable no-unused-vars */\n\nimport jQuery from 'jquery';\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\n\nlet ACTION = {\n    SEND_RESPONSE: '[data-action=\"send-match\"]',\n};\n\nlet REGION = {\n    ROOT: '[data-region=\"question-content\"]',\n    MATCH: '[data-region=\"match\"]',\n    LOADING: '[data-region=\"overlay-icon-container\"]',\n    LEFT_OPTION: '#dragOption',\n    RIGHT_OPTION: '#dropOption',\n    CONTAINER_ANSWERS: '#dragQuestion',\n    CANVAS: '#canvas',\n    CANVASTEMP: '#canvasTemp',\n    LEFT_OPTION_SELECTOR: '#dragOption .option',\n    LEFT_OPTION_CLICKABLE: '#dragOption .option.option-left .content-option',\n    RIGHT_OPTION_CLICKABLE: '#dropOption .option.option-right .content-option',\n    OPTION: '.option',\n    CLEARPATH: '#dropOption .drop-element',\n    POINTER: '.option-pointer',\n    NEXT: '[data-action=\"next-question\"]',\n    TIMER: '[data-region=\"question-timer\"]',\n    SECONDS: '[data-region=\"seconds\"]',\n    CONTENTFEEDBACKS: '[data-region=\"containt-feedbacks\"]',\n    FEEDBACK: '[data-region=\"statement-feedback\"]',\n    FEEDBACKANSWER: '[data-region=\"answer-feedback\"]',\n    FEEDBACKBACGROUND: '[data-region=\"feedback-background\"]',\n};\n\nlet SERVICES = {\n    REPLY: 'mod_jqshow_match'\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading'\n};\n\nlet cmId;\nlet sId;\nlet questionid;\nlet jqshowId;\nlet jqid;\nlet questionEnd = false;\nlet correctAnswers = null;\nlet showQuestionFeedback = false;\nlet manualMode = false;\nlet startPoint;\nlet color;\nlet toucheX;\nlet toucheY;\nlet linkList = [];\nlet linkCorrection = [];\n\n/** @type {jQuery} The jQuery node for the page region. */\nMatch.prototype.node = null;\nMatch.prototype.endTimer = new Event('endTimer');\nMatch.prototype.studentQuestionEnd = new Event('studentQuestionEnd');\n\n/**\n * @constructor\n * @param {String} selector\n * @param {Boolean} showquestionfeedback\n * @param {Boolean} manualmode\n * @param {String} jsonresponse\n */\nfunction Match(selector, showquestionfeedback = false, manualmode = false, jsonresponse = '') {\n    this.node = jQuery(selector);\n    sId = this.node.attr('data-sid');\n    cmId = this.node.attr('data-cmid');\n    questionid = this.node.attr('data-questionid');\n    jqshowId = this.node.attr('data-jqshowid');\n    jqid = this.node.attr('data-jqid');\n    showQuestionFeedback = showquestionfeedback;\n    manualMode = manualmode;\n    questionEnd = false;\n    linkList = [];\n    if (jsonresponse !== '') {\n        this.answered(jsonresponse);\n        if (manualMode === false || jQuery('.modal-body').length) {\n            this.showAnswers();\n            if (showQuestionFeedback === true) {\n                this.showFeedback();\n            }\n        }\n    }\n    setTimeout(() => { // For modal preview, is executed before the DOM is rendered.\n        this.initMatch();\n    }, 500);\n    this.createLinkCorrection(); // TODO seems unnecessary, check.\n}\n\nMatch.prototype.answered = function(jsonresponse) {\n    Match.prototype.allDisabled();\n    linkList = JSON.parse(jsonresponse);\n    Match.prototype.drawResponse();\n    questionEnd = true;\n    jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(REGION.CONTAINER_ANSWERS).css('z-index', 3);\n    if (manualMode === false) {\n        jQuery(REGION.NEXT).removeClass('d-none');\n    }\n};\n\nMatch.prototype.initMatch = function() {\n    let heightLeft = jQuery(REGION.LEFT_OPTION).height();\n    let heightRight = jQuery(REGION.RIGHT_OPTION).height();\n    let canvasHeight = heightLeft > heightRight ? heightLeft : heightRight;\n    jQuery(REGION.CANVAS).attr('height', canvasHeight);\n    jQuery(REGION.CANVAS).attr('width', jQuery(REGION.CANVAS).width());\n\n    jQuery(REGION.CANVASTEMP).attr('width', jQuery(REGION.CANVASTEMP).width());\n    jQuery(REGION.CANVASTEMP).attr('height', canvasHeight);\n    jQuery(REGION.CONTAINER_ANSWERS).bind('dragover', function(){\n        let top = window.event.pageY,\n            left = window.event.pageX;\n        Match.prototype.drawLinkTemp(startPoint, {top, left});\n    });\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.addEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.addTargetEvents(dropEl));\n    Match.prototype.drawLinks();\n    jQuery(REGION.CLEARPATH).on('click', Match.prototype.clearPath.bind(this));\n    jQuery(REGION.LEFT_OPTION_CLICKABLE).on('click', Match.prototype.leftOptionSelected.bind(this));\n    jQuery(ACTION.SEND_RESPONSE).on('click', Match.prototype.sendResponse);\n    Match.prototype.initEvents();\n};\n\nMatch.prototype.initEvents = function() {\n    addEventListener('timeFinish', () => {\n        Match.prototype.sendResponse();\n    }, {once: true});\n    if (manualMode !== false) {\n        addEventListener('teacherQuestionEnd_' + jqid, (e) => {\n            if (questionEnd !== true) {\n                Match.prototype.sendResponse();\n            }\n            e.detail.statistics.forEach((statistic) => {\n                // TODO statistics.\n            });\n        }, {once: true});\n        addEventListener('pauseQuestion_' + jqid, () => {\n            Match.prototype.pauseQuestion();\n        }, false);\n        addEventListener('playQuestion_' + jqid, () => {\n            Match.prototype.playQuestion();\n        }, false);\n        addEventListener('showAnswers_' + jqid, () => {\n            Match.prototype.showAnswers();\n        }, false);\n        addEventListener('hideAnswers_' + jqid, () => {\n            Match.prototype.hideAnswers();\n        }, false);\n        addEventListener('showStatistics_' + jqid, () => {\n            Match.prototype.showStatistics();\n        }, false);\n        addEventListener('hideStatistics_' + jqid, () => {\n            Match.prototype.hideStatistics();\n        }, false);\n        addEventListener('showFeedback_' + jqid, () => {\n            Match.prototype.showFeedback();\n        }, false);\n        addEventListener('hideFeedback_' + jqid, () => {\n            Match.prototype.hideFeedback();\n        }, false);\n    }\n\n    window.onbeforeunload = function() {\n        if (jQuery(REGION.SECONDS).length > 0 && questionEnd === false) {\n            Match.prototype.sendResponse();\n            return 'Because the question is overdue and an attempt has been made to reload the page,' +\n                ' the question has remained unanswered.';\n        }\n    };\n};\n\nMatch.prototype.createLinkCorrection = function() { // TODO is unnecessary for debugging.\n    jQuery.each(jQuery(REGION.LEFT_OPTION_SELECTOR), function(index, item) {\n        let dragId = jQuery(item).data('stems') + '-draggable';\n        let steam = Match.prototype.baseConvert(jQuery(item).data('stems'), 2, 16);\n        let dropId = Match.prototype.baseConvert(steam, 10, 26) + '-dropzone';\n        linkCorrection.push({dragId: dragId, dropId: dropId});\n    });\n    // eslint-disable-next-line no-console\n    console.log(linkCorrection);\n};\n\nMatch.prototype.getRandomColor = function(position) {\n    let colorArray = ['#FF6633', '#FFB399', '#FF33FF', '#FF9999', '#00B3E6',\n                      '#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',\n                      '#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A',\n                      '#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',\n                      '#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC',\n                      '#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',\n                      '#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n                      '#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',\n                      '#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3',\n                      '#E64D66', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF'];\n    return colorArray[position];\n};\n\nMatch.prototype.drawResponse = function() {\n    let corrects = 0;\n    let fails = 0;\n    linkList.forEach(userR => {\n        let optionLeft = jQuery('#' + userR.dragId).parents('.option-left').first();\n        let optionRight = jQuery('#' + userR.dropId).parents('.option-right').first();\n        if (userR.stemDragId === userR.stemDropId) { // CORRECT.\n            userR.color = '#0fd08c';\n            if (manualMode === false || jQuery('.modal-body').length) {\n                optionLeft.find('.feedback-icon.correct').css({'display': 'flex'});\n                optionLeft.find('.content-option').removeClass('bg-primary').css({'background-color': '#0fd08c'});\n                optionRight.find('.content-option').removeClass('bg-primary').css({'background-color': '#0fd08c'});\n            }\n            corrects++;\n        } else { // INCORRECT.\n            userR.color = '#f85455';\n            if (manualMode === false || jQuery('.modal-body').length) {\n                optionLeft.find('.feedback-icon.incorrect').css({'display': 'flex'});\n                optionLeft.find('.content-option').removeClass('bg-primary').css({'background-color': '#f85455'});\n                optionRight.find('.content-option').removeClass('bg-primary').css({'background-color': '#f85455'});\n            }\n            fails++;\n        }\n    });\n    return [corrects, fails];\n};\n\nMatch.prototype.sendResponse = function() {\n    Match.prototype.allDisabled();\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        jQuery(REGION.ROOT).append(html);\n        dispatchEvent(Match.prototype.endTimer);\n        let timeLeft = parseInt(jQuery(REGION.SECONDS).text());\n        let result = 3; // No response.\n        let [corrects, fails] = Match.prototype.drawResponse();\n        if (corrects !== 0) {\n            result = 2; // Partially.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === corrects) {\n            result = 1; // Correct.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === fails) {\n            result = 0; // Failure.\n        }\n        Match.prototype.drawLinks();\n\n        let request = {\n            methodname: SERVICES.REPLY,\n            args: {\n                jsonresponse: JSON.stringify(linkList),\n                result: result,\n                sessionid: sId,\n                jqshowid: jqshowId,\n                cmid: cmId,\n                questionid: questionid,\n                jqid: jqid,\n                timeleft: timeLeft || 0,\n                preview: false\n            }\n        };\n        Ajax.call([request])[0].done(function(response) {\n            if (response.reply_status === true) {\n                questionEnd = true;\n                jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n                jQuery(REGION.NEXT).removeClass('d-none');\n                dispatchEvent(Match.prototype.studentQuestionEnd);\n                if (response.hasfeedbacks) {\n                    jQuery(REGION.FEEDBACK).html(response.statment_feedback);\n                    jQuery(REGION.FEEDBACKANSWER).html(response.answer_feedback);\n                }\n                if (jQuery('.modal-body').length) { // Preview.\n                    Match.prototype.showAnswers();\n                    if (showQuestionFeedback === true) {\n                        Match.prototype.showFeedback();\n                    }\n                } else {\n                    if (manualMode === false) {\n                        Match.prototype.showAnswers();\n                        if (showQuestionFeedback === true) {\n                            Match.prototype.showFeedback();\n                        }\n                    }\n                }\n                jQuery(REGION.CONTAINER_ANSWERS).css('z-index', 3);\n                jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n                linkList = [];\n            } else {\n                alert('error');\n            }\n            jQuery(REGION.LOADING).remove();\n        });\n    });\n};\n\n/* Add event */\nMatch.prototype.addEventsDragAndDrop = function(el) {\n    el.addEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.addEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.addEventListener('touchstart', Match.prototype.touchStart, false);\n    el.addEventListener('touchmove', Match.prototype.touchMove, false);\n    el.addEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.removeEventsDragAndDrop = function(el) {\n    el.removeEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.removeEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.removeEventListener('touchstart', Match.prototype.touchStart, false);\n    el.removeEventListener('touchmove', Match.prototype.touchMove, false);\n    el.removeEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.addTargetEvents = function(target) {\n    target.addEventListener('dragover', Match.prototype.onDragOver, false);\n    target.addEventListener('drop', Match.prototype.onDrop, false);\n};\n\nMatch.prototype.removeTargetEvents = function(target) {\n    target.removeEventListener('dragover', Match.prototype.onDragOver, false);\n    target.removeEventListener('drop', Match.prototype.onDrop, false);\n};\n\n/* DRAG AND DROP */\nMatch.prototype.onDragStart = function(event) {\n    event\n        .dataTransfer\n        .setData('text/plain', event.target.id);\n    startPoint = event.target.id;\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(event.currentTarget));\n};\n\nMatch.prototype.onDragOver = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDragEnd = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDrop = function(event) {\n    const dragId = event\n        .dataTransfer\n        .getData('text');\n\n    const dropId = jQuery(event.currentTarget).find(REGION.POINTER).attr('id');\n    Match.prototype.Drop(dragId, dropId);\n};\n\nMatch.prototype.Drop = function(dragId, dropId){\n    let deselected = linkList.filter(obj => {\n        return obj.dragId === dragId || obj.dropId === dropId;\n    });\n    if (deselected.length) {\n        deselected.forEach(x => {\n            let selectroDropId = jQuery(\"#\" + x.dropId);\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n            selectroDropId.find(\"i\").removeClass('linked');\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n        });\n    }\n\n    linkList = linkList.filter(obj => {\n        return obj.dragId !== dragId;\n    });\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== dropId;\n    });\n\n    let stemDragId = Match.prototype.baseConvert(jQuery('#' + dragId).data('forstems'), 2, 16);\n    let stemDropId = Match.prototype.baseConvert(jQuery('#' + dropId).data('forstems'), 26, 10);\n\n    linkList.push({dragId, dropId, color, stemDragId, stemDropId});\n    Match.prototype.drawLinks();\n    Match.prototype.clearPathTemp();\n};\n\nMatch.prototype.baseConvert = function(number, frombase, tobase) {\n    // eslint-disable-next-line no-bitwise\n    return parseInt(number + '', frombase | 0).toString(tobase | 0);\n};\n\n/* TOUCHE DEVICE */\nMatch.prototype.touchStart = function(e) {\n    if (e.target.id === undefined || e.target.id === '') {\n        if (jQuery(e.target).parent().attr('id') !== undefined) {\n            startPoint = jQuery(e.target).parent().attr('id');\n        } else {\n            startPoint = jQuery(e.target).closest('.option-left').find(\".drag-element\").first().attr('id');\n        }\n    }\n\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(e.currentTarget));\n};\n\nMatch.prototype.touchMove = function(e) {\n    e.preventDefault();\n    let top = toucheY = e.touches[0].pageY,\n        left = toucheX = e.touches[0].pageX;\n    Match.prototype.drawLinkTemp(startPoint, {top, left});\n};\n\nMatch.prototype.touchEnd = function(e) {\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(target => {\n        let box2 = target.getBoundingClientRect(),\n            x = box2.left,\n            y = box2.top,\n            h = target.offsetHeight,\n            w = target.offsetWidth,\n            b = y + h,\n            r = x + w;\n\n        if (toucheX > x && toucheX < r && toucheY > y && toucheY < b) {\n            let dropId;\n            if (target.id === undefined || target.id === '' || target.id === 'dropOption') {\n                if (jQuery(target).parent().attr('id') !== undefined && jQuery(target).parent().attr('id') !== 'dropOption') {\n                    dropId = jQuery(target).parent().attr('id');\n                } else {\n                    dropId = jQuery(target).closest('.option-right').find(\".drop-element\").first().attr('id');\n                }\n            } else {\n                dropId = target.id;\n            }\n            Match.prototype.Drop(startPoint, dropId);\n        } else {\n            return false;\n        }\n    });\n    Match.prototype.clearPathTemp();\n    e.preventDefault();\n};\n\n/* Draw final line */\nMatch.prototype.drawLinks = function() {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    linkList.forEach(link => Match.prototype.drawLink(link.dragId, link.dropId, link.color));\n};\n\nMatch.prototype.drawLink = function(obj1, obj2, pColor) {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let $obj2 = jQuery(\"#\" + obj2);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = $obj2.offset();\n    let w2 = $obj2.width();\n    let h2 = $obj2.height();\n    let wc = jQuery(REGION.CANVAS).width();\n    ctx.beginPath();\n    ctx.strokeStyle = pColor ? pColor : color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n    ctx.bezierCurveTo(wc / 2, p1.top - parent.top + (h1 / 2) - 20 - 2,\n        wc / 2, p2.top - parent.top + (h2 / 2) - 20 - 2,\n        wc - 4, p2.top - parent.top + (h2 / 2) - 20 - 2);\n    ctx.stroke();\n\n    $obj1.children().css('color', pColor ? pColor : color);\n    $obj1.children().css('font-weight', '900');\n    $obj2.children().css('color', pColor ? pColor : color);\n    $obj2.children().css('font-weight', '900');\n    $obj2.children().addClass('linked');\n};\n\nMatch.prototype.clearPath = function(event) {\n    let ident = event.currentTarget.id;\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== ident;\n    });\n    let dragQuestionObject = jQuery(REGION.CONTAINER_ANSWERS);\n    dragQuestionObject.find(\"i\").removeClass('linked');\n    dragQuestionObject.find(\"i\").css('font-weight', '400');\n    dragQuestionObject.find(\"i\").css('color', '#5a57ff');\n    Match.prototype.drawLinks();\n};\n\n/* Draw path mouse line */\nMatch.prototype.drawLinkTemp = function(obj1, coordPt) {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = coordPt;\n    let c = jQuery(REGION.CANVASTEMP).offset();\n\n    ctx.beginPath();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n\n    ctx.bezierCurveTo((p2.left - c.left) / 2, p1.top - parent.top - 19 - 2,\n        (p2.left - c.left) / 2,p2.top - parent.top - 19 - 2,\n        p2.left - c.left, p2.top - parent.top - 19 - 2);\n    Match.prototype.clearPathTemp();\n    ctx.stroke();\n};\n\nMatch.prototype.clearPathTemp = function() {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n};\n\n/* CLICKS */\nMatch.prototype.leftOptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        if (e.target !== item) {\n            jQuery(item).parent().addClass('disabled');\n        } else {\n            jQuery(item).parents('.option').first().find('.option-pointer').addClass('disabled');\n        }\n    });\n    jQuery.each(jQuery(REGION.CLEARPATH), function(index, item) {\n        jQuery(item).addClass('disabled');\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'inherit'});\n    });\n    jQuery(REGION.RIGHT_OPTION_CLICKABLE).on('click', Match.prototype.rightOptionSelected.bind(this));\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(jQuery(e.target).parents('.option').first().get(0)));\n};\n\nMatch.prototype.rightOptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let dragId = jQuery('.option-left:not(.disabled)').find('.drag-element').attr('id');\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        if (e.target === item) {\n            let dropId = jQuery(item).parents('.option-right').first().find('.drop-element').attr('id');\n            document.getElementById(dropId).click();\n            Match.prototype.Drop(dragId, dropId);\n            jQuery(dragId).removeClass('disabled');\n        }\n        jQuery('.option-left').removeClass('disabled');\n        jQuery('.drag-element').removeClass('disabled');\n        jQuery(REGION.RIGHT_OPTION_CLICKABLE).off('click');\n        jQuery.each(jQuery(REGION.CLEARPATH), function(index, item) {\n            jQuery(item).removeClass('disabled');\n        });\n        jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'none'});\n        });\n    });\n};\n\nMatch.prototype.allDisabled = function() {\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.POINTER), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery(REGION.CONTAINER_ANSWERS).unbind('dragover');\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.removeEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.removeTargetEvents(dropEl));\n    jQuery(REGION.CLEARPATH).off('click');\n    jQuery(REGION.LEFT_OPTION_CLICKABLE).off('click');\n    jQuery(ACTION.SEND_RESPONSE).off('click');\n};\n\n/* EVENTS */ // TODO adjust.\nMatch.prototype.pauseQuestion = function() {\n    dispatchEvent(new Event('pauseQuestion'));\n    jQuery(REGION.TIMER).css('z-index', 3);\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(ACTION.REPLY).css('pointer-events', 'none');\n};\n\nMatch.prototype.playQuestion = function() {\n    dispatchEvent(new Event('playQuestion'));\n    jQuery(REGION.TIMER).css('z-index', 1);\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'none');\n    jQuery(ACTION.REPLY).css('pointer-events', 'auto');\n};\n\nMatch.prototype.showAnswers = function() {\n    jQuery('.feedback-icon').css({'displey': 'flex'});\n};\n\nMatch.prototype.hideAnswers = function() {\n    jQuery('.feedback-icon').css({'displey': 'none'});\n};\n\nMatch.prototype.showStatistics = function() {\n    if (questionEnd === true) {\n        jQuery('.statistics-icon').css('display', 'flex');\n    }\n};\n\nMatch.prototype.hideStatistics = function() {\n    if (questionEnd === true) {\n        jQuery('.statistics-icon').css('display', 'none');\n    }\n};\n\nMatch.prototype.showFeedback = function() {\n    if (questionEnd === true) {\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'block', 'z-index': 3});\n    }\n};\n\nMatch.prototype.hideFeedback = function() {\n    if (questionEnd === true) {\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'none', 'z-index': 0});\n    }\n};\n\n\nexport const initMatch = (selector, showquestionfeedback, manualmode, jsonresponse) => {\n    return new Match(selector, showquestionfeedback, manualmode, jsonresponse);\n};"],"names":["_interopRequireDefault","obj","__esModule","default","_slicedToArray","arr","i","Array","isArray","_arrayWithHoles","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","call","next","Object","done","push","value","length","err","return","_iterableToArrayLimit","o","minLen","_arrayLikeToArray","n","prototype","toString","slice","constructor","name","from","test","_unsupportedIterableToArray","TypeError","_nonIterableRest","len","arr2","defineProperty","_exports","initMatch","_jquery","_ajax","_templates","cmId","sId","questionid","jqshowId","jqid","startPoint","color","toucheX","toucheY","ACTION","SEND_RESPONSE","REGION","SERVICES","TEMPLATES","questionEnd","showQuestionFeedback","manualMode","linkList","linkCorrection","Match","selector","_this","this","showquestionfeedback","arguments","undefined","manualmode","jsonresponse","node","jQuery","attr","answered","showAnswers","showFeedback","setTimeout","createLinkCorrection","endTimer","Event","studentQuestionEnd","allDisabled","JSON","parse","drawResponse","addClass","css","removeClass","_this2","heightLeft","height","heightRight","canvasHeight","width","bind","top","window","event","pageY","left","pageX","drawLinkTemp","find","toArray","forEach","dragEl","addEventsDragAndDrop","dropEl","addTargetEvents","drawLinks","on","clearPath","leftOptionSelected","sendResponse","initEvents","addEventListener","once","e","detail","statistics","statistic","pauseQuestion","playQuestion","hideAnswers","showStatistics","hideStatistics","hideFeedback","onbeforeunload","each","index","item","dragId","data","steam","baseConvert","dropId","console","log","getRandomColor","position","corrects","fails","userR","optionLeft","parents","first","optionRight","stemDragId","stemDropId","display","Templates","render","visible","html","append","dispatchEvent","timeLeft","parseInt","text","result","_Match$prototype$draw2","request","methodname","args","stringify","sessionid","jqshowid","cmid","timeleft","preview","Ajax","response","reply_status","hasfeedbacks","statment_feedback","answer_feedback","alert","remove","el","onDragStart","onDragEnd","touchStart","touchMove","touchEnd","removeEventsDragAndDrop","removeEventListener","target","onDragOver","onDrop","removeTargetEvents","dataTransfer","setData","id","options","document","querySelectorAll","indexOf","currentTarget","clearPathTemp","preventDefault","getData","Drop","deselected","filter","x","selectroDropId","number","frombase","tobase","parent","closest","touches","box2","getBoundingClientRect","y","h","offsetHeight","w","offsetWidth","canvas","get","getContext","clearRect","link","drawLink","obj1","obj2","pColor","ctx","$obj1","$obj2","offset","p1","h1","p2","h2","wc","beginPath","strokeStyle","lineWidth","moveTo","bezierCurveTo","stroke","children","ident","dragQuestionObject","coordPt","c","stopPropagation","rightOptionSelected","getElementById","click","off","_this3","unbind","REPLY","displey"],"mappings":"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"}