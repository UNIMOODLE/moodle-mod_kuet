{"version":3,"file":"match.min.js","sources":["../src/match.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n// Project implemented by the \"Recovery, Transformation and Resilience Plan.\n// Funded by the European Union - Next GenerationEU\".\n//\n// Produced by the UNIMOODLE University Group: Universities of\n// Valladolid, Complutense de Madrid, UPV/EHU, León, Salamanca,\n// Illes Balears, Valencia, Rey Juan Carlos, La Laguna, Zaragoza, Málaga,\n// Córdoba, Extremadura, Vigo, Las Palmas de Gran Canaria y Burgos\n\n/**\n *\n * @module    mod_kuet/match\n * @copyright  2023 Proyecto UNIMOODLE\n * @author     UNIMOODLE Group (Coordinator) <direccion.area.estrategia.digital@uva.es>\n * @author     3IPUNT <contacte@tresipunt.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\n/* eslint-disable no-unused-vars */\n\nimport jQuery from 'jquery';\nimport Ajax from 'core/ajax';\nimport Templates from 'core/templates';\nimport mEvent from 'core/event';\n\nlet ACTION = {\n    SEND_RESPONSE: '[data-action=\"send-match\"]',\n    SELECTOPTION: '[data-action=\"mark-left-option-mobile\"]'\n};\n\nlet REGION = {\n    ROOT: '[data-region=\"question-content\"]',\n    MATCH: '[data-region=\"match\"]',\n    LOADING: '[data-region=\"overlay-icon-container\"]',\n    LEFT_OPTION: '#dragOption',\n    RIGHT_OPTION: '#dropOption',\n    CONTAINER_ANSWERS: '#dragQuestion',\n    CONTAINER_ANSWERS_MOBILE: '#selectQuestion',\n    CANVAS: '#canvas',\n    CANVASTEMP: '#canvasTemp',\n    LEFT_OPTION_SELECTOR: '#dragOption .option',\n    LEFT_OPTION_CLICKABLE: '#dragOption .option.option-left .content-option',\n    RIGHT_OPTION_CLICKABLE: '#dropOption .option.option-right .content-option',\n    OPTION: '.option',\n    CLEARPATH: '#dropOption .drop-element',\n    POINTER: '.option-pointer',\n    NEXT: '[data-action=\"next-question\"]',\n    TIMER: '[data-region=\"question-timer\"]',\n    SECONDS: '[data-region=\"seconds\"]',\n    CONTENTFEEDBACKS: '[data-region=\"containt-feedbacks\"]',\n    FEEDBACK: '[data-region=\"statement-feedback\"]',\n    FEEDBACKANSWER: '[data-region=\"answer-feedback\"]',\n    FEEDBACKBACGROUND: '[data-region=\"feedback-background\"]',\n};\n\nlet SERVICES = {\n    REPLY: 'mod_kuet_match'\n};\n\nlet TEMPLATES = {\n    LOADING: 'core/overlay_loading'\n};\n\nlet cmId;\nlet sId;\nlet questionid;\nlet jqshowId;\nlet jqid;\nlet questionEnd = false;\nlet showQuestionFeedback = false;\nlet manualMode = false;\nlet startPoint;\nlet color;\nlet toucheX;\nlet toucheY;\nlet linkList = [];\nlet linkCorrection = [];\nlet showingAnswers = false;\nlet showingFeedback = false;\n\n/** @type {jQuery} The jQuery node for the page region. */\nMatch.prototype.node = null;\nMatch.prototype.endTimer = new Event('endTimer');\nMatch.prototype.studentQuestionEnd = new Event('studentQuestionEnd');\n\n/**\n * @constructor\n * @param {String} selector\n * @param {Boolean} showquestionfeedback\n * @param {Boolean} manualmode\n * @param {String} jsonresponse\n */\nfunction Match(selector, showquestionfeedback = false, manualmode = false, jsonresponse = '') {\n    this.node = jQuery(selector);\n    sId = this.node.attr('data-sid');\n    cmId = this.node.attr('data-cmid');\n    questionid = this.node.attr('data-questionid');\n    jqshowId = this.node.attr('data-jqshowid');\n    jqid = this.node.attr('data-jqid');\n    showQuestionFeedback = showquestionfeedback;\n    manualMode = manualmode;\n    questionEnd = false;\n    linkList = [];\n    this.createLinkCorrection();\n    if (jsonresponse !== '') {\n        this.answered(JSON.parse(atob(jsonresponse)));\n        if (manualMode === false || jQuery('.modal-body').length) {\n            questionEnd = true;\n            if (showQuestionFeedback === true) {\n                this.showFeedback();\n            }\n            this.showAnswers();\n        }\n    }\n    setTimeout(() => { // For modal preview, is executed before the DOM is rendered.\n        this.initMatch();\n    }, 500);\n}\n\nMatch.prototype.answered = function(jsonresponse) {\n    Match.prototype.allDisabled();\n    linkList = jsonresponse;\n    Match.prototype.drawResponse();\n    Match.prototype.drawSelects();\n    questionEnd = true;\n    jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(REGION.CONTAINER_ANSWERS).css('z-index', 3);\n    jQuery(REGION.CONTAINER_ANSWERS_MOBILE).css('z-index', 3);\n    if (manualMode === false) {\n        jQuery(REGION.NEXT).removeClass('d-none');\n    }\n    let contentFeedbacks = document.querySelector(REGION.CONTENTFEEDBACKS);\n    if (contentFeedbacks !== null) {\n        mEvent.notifyFilterContentUpdated(document.querySelector(REGION.CONTENTFEEDBACKS));\n    }\n};\n\nMatch.prototype.initMatch = function() {\n    Match.prototype.normalizeCanvas();\n    jQuery(REGION.CONTAINER_ANSWERS).bind('dragover', function(){\n        let top = window.event.pageY,\n            left = window.event.pageX;\n        Match.prototype.drawLinkTemp(startPoint, {top, left});\n    });\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.addEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.addTargetEvents(dropEl));\n    Match.prototype.drawLinks();\n    jQuery(REGION.CLEARPATH).on('click touchend', Match.prototype.clearPath.bind(this));\n    jQuery(REGION.LEFT_OPTION_CLICKABLE).on('click touchend', Match.prototype.leftOptionSelected.bind(this));\n    jQuery(ACTION.SEND_RESPONSE).off('click');\n    jQuery(ACTION.SEND_RESPONSE).on('click', Match.prototype.sendResponse);\n\n    // Mobile.\n    jQuery(ACTION.SELECTOPTION).on('change', Match.prototype.OptionSelected.bind(this));\n    jQuery(window).on('resize', function() {\n        Match.prototype.normalizeCanvas();\n        if ((manualMode === false || jQuery('.modal-body').length) && questionEnd === true) {\n            Match.prototype.showAnswers();\n        } else {\n            Match.prototype.drawLinks();\n            Match.prototype.drawSelects();\n        }\n    });\n    Match.prototype.initEvents();\n};\n\nMatch.prototype.normalizeCanvas = function() {\n    let heightLeft = jQuery(REGION.LEFT_OPTION).height();\n    let heightRight = jQuery(REGION.RIGHT_OPTION).height();\n    let canvasHeight = heightLeft > heightRight ? heightLeft : heightRight;\n    jQuery(REGION.CANVAS).attr('height', canvasHeight);\n    jQuery(REGION.CANVAS).attr('width', jQuery(REGION.CANVAS).width());\n    jQuery(REGION.CANVASTEMP).attr('width', jQuery(REGION.CANVASTEMP).width());\n    jQuery(REGION.CANVASTEMP).attr('height', canvasHeight);\n};\n\nMatch.prototype.initEvents = function() {\n    addEventListener('timeFinish', Match.prototype.sendResponse, {once: true});\n    if (manualMode !== false) {\n        addEventListener('alreadyAnswered_' + jqid, (ev) => {\n            let userid =  jQuery('[data-region=\"student-canvas\"]').data('userid');\n            if (userid != ev.detail.userid) {\n                jQuery('[data-region=\"group-message\"]').css({'z-index': 3, 'padding': '15px'});\n                jQuery('[data-region=\"group-message\"]').show();\n            }\n            if (questionEnd !== true) {\n                Match.prototype.sendResponse();\n            }\n        }, {once: true});\n        addEventListener('teacherQuestionEnd_' + jqid, (e) => {\n            if (questionEnd !== true) {\n                Match.prototype.sendResponse();\n            }\n            e.detail.statistics.forEach((statistic) => {\n                jQuery('#statistics .correct').attr('aria-valuenow', statistic.correct)\n                    .width(statistic.correct + '%').html(statistic.correct + '%');\n                jQuery('#statistics .failure').attr('aria-valuenow', statistic.failure)\n                    .width(statistic.failure + '%').html(statistic.failure + '%');\n                jQuery('#statistics .invalid').attr('aria-valuenow', statistic.invalid)\n                    .width(statistic.invalid + '%').html(statistic.invalid + '%');\n                jQuery('#statistics .noresponse').attr('aria-valuenow', statistic.noresponse)\n                    .width(statistic.noresponse + '%').html(statistic.noresponse + '%');\n                jQuery('#statistics .partially').attr('aria-valuenow', statistic.partially)\n                    .width(statistic.partially + '%').html(statistic.partially + '%');\n            });\n        }, {once: true});\n        addEventListener('pauseQuestion_' + jqid, () => {\n            Match.prototype.pauseQuestion();\n        }, false);\n        addEventListener('playQuestion_' + jqid, () => {\n            Match.prototype.playQuestion();\n        }, false);\n        addEventListener('showAnswers_' + jqid, () => {\n            Match.prototype.showAnswers();\n        }, false);\n        addEventListener('hideAnswers_' + jqid, () => {\n            Match.prototype.hideAnswers();\n        }, false);\n        addEventListener('showStatistics_' + jqid, () => {\n            Match.prototype.showStatistics();\n        }, false);\n        addEventListener('hideStatistics_' + jqid, () => {\n            Match.prototype.hideStatistics();\n        }, false);\n        addEventListener('showFeedback_' + jqid, () => {\n            Match.prototype.showFeedback();\n        }, false);\n        addEventListener('hideFeedback_' + jqid, () => {\n            Match.prototype.hideFeedback();\n        }, false);\n        addEventListener('removeEvents', () => {\n            Match.prototype.removeEvents();\n        }, {once: true});\n    }\n\n    window.onbeforeunload = function() {\n        if (jQuery(REGION.SECONDS).length > 0 && questionEnd === false) {\n            Match.prototype.sendResponse();\n            return 'Because the question is overdue and an attempt has been made to reload the page,' +\n                ' the question has remained unanswered.';\n        }\n    };\n};\n\nMatch.prototype.removeEvents = function() {\n    removeEventListener('timeFinish', () => Match.prototype.sendResponse, {once: true});\n    if (manualMode !== false) {\n        removeEventListener('alreadyAnswered_' + jqid, (ev) => {\n            let userid =  jQuery('[data-region=\"student-canvas\"]').data('userid');\n            if (userid != ev.detail.userid) {\n                jQuery('[data-region=\"group-message\"]').css({'z-index': 3, 'padding': '15px'});\n                jQuery('[data-region=\"group-message\"]').show();\n            }\n            if (questionEnd !== true) {\n                Match.prototype.sendResponse();\n            }\n        }, {once: true});\n        removeEventListener('teacherQuestionEnd_' + jqid, (e) => {\n            if (questionEnd !== true) {\n                Match.prototype.sendResponse();\n            }\n            e.detail.statistics.forEach((statistic) => {\n                jQuery('#statistics .correct').attr('aria-valuenow', statistic.correct)\n                    .width(statistic.correct + '%').html(statistic.correct + '%');\n                jQuery('#statistics .failure').attr('aria-valuenow', statistic.failure)\n                    .width(statistic.failure + '%').html(statistic.failure + '%');\n                jQuery('#statistics .invalid').attr('aria-valuenow', statistic.invalid)\n                    .width(statistic.invalid + '%').html(statistic.invalid + '%');\n                jQuery('#statistics .noresponse').attr('aria-valuenow', statistic.noresponse)\n                    .width(statistic.noresponse + '%').html(statistic.noresponse + '%');\n                jQuery('#statistics .partially').attr('aria-valuenow', statistic.partially)\n                    .width(statistic.partially + '%').html(statistic.partially + '%');\n            });\n        }, {once: true});\n        removeEventListener('pauseQuestion_' + jqid, () => {\n            Match.prototype.pauseQuestion();\n        }, false);\n        removeEventListener('playQuestion_' + jqid, () => {\n            Match.prototype.playQuestion();\n        }, false);\n        removeEventListener('showAnswers_' + jqid, () => {\n            Match.prototype.showAnswers();\n        }, false);\n        removeEventListener('hideAnswers_' + jqid, () => {\n            Match.prototype.hideAnswers();\n        }, false);\n        removeEventListener('showStatistics_' + jqid, () => {\n            Match.prototype.showStatistics();\n        }, false);\n        removeEventListener('hideStatistics_' + jqid, () => {\n            Match.prototype.hideStatistics();\n        }, false);\n        removeEventListener('showFeedback_' + jqid, () => {\n            Match.prototype.showFeedback();\n        }, false);\n        removeEventListener('hideFeedback_' + jqid, () => {\n            Match.prototype.hideFeedback();\n        }, false);\n        removeEventListener('removeEvents', () => {\n            Match.prototype.removeEvents();\n        }, {once: true});\n    }\n};\n\nMatch.prototype.createLinkCorrection = function() {\n    linkCorrection = [];\n    jQuery.each(jQuery(REGION.LEFT_OPTION_SELECTOR), function(index, item) {\n        let dragId = jQuery(item).data('stems') + '-draggable';\n        let steam = Match.prototype.baseConvert(jQuery(item).data('stems'), 2, 16);\n        let dropId = Match.prototype.baseConvert(steam, 10, 26) + '-dropzone';\n        let stemsLeft = jQuery('#' + dragId).data('forstems');\n        let stemsRight = jQuery('#' + dropId).data('forstems');\n        linkCorrection.push({dragId: dragId, dropId: dropId, stemsLeft: stemsLeft, stemsRight: stemsRight});\n    });\n};\n\nMatch.prototype.getRandomColor = function(position) {\n    let colorArray = ['#FF6633', '#E64D66', '#FF33FF', '#FF9999', '#00B3E6',\n                      '#E6B333', '#3366E6', '#999966', '#99FF99', '#B34D4D',\n                      '#80B300', '#809900', '#E6B3B3', '#6680B3', '#66991A',\n                      '#FF99E6', '#CCFF1A', '#FF1A66', '#E6331A', '#33FFCC',\n                      '#66994D', '#B366CC', '#4D8000', '#B33300', '#CC80CC',\n                      '#66664D', '#991AFF', '#E666FF', '#4DB3FF', '#1AB399',\n                      '#E666B3', '#33991A', '#CC9999', '#B3B31A', '#00E680',\n                      '#4D8066', '#809980', '#E6FF80', '#1AFF33', '#999933',\n                      '#FF3380', '#CCCC00', '#66E64D', '#4D80CC', '#9900B3',\n                      '#FFB399', '#4DB380', '#FF4D4D', '#99E6E6', '#6666FF'];\n    return colorArray[position];\n};\n\nMatch.prototype.drawResponse = function(fromTeacher = false) {\n    let corrects = 0;\n    let fails = 0;\n    linkList.forEach(userR => {\n        let optionLeft = jQuery('#' + userR.dragId).parents('.option-left').first();\n        let optionRight = jQuery('#' + userR.dropId).parents('.option-right').first();\n        if (userR.stemDragId === userR.stemDropId) { // CORRECT.\n            if (manualMode === false || jQuery('.modal-body').length || fromTeacher === true) {\n                userR.color = '#0fd08c';\n                optionLeft.find('.feedback-icon.correct').css({'display': 'flex'});\n                optionLeft.find('.content-option').removeClass('bg-primary').css({'background-color': '#0fd08c'});\n                optionRight.find('.content-option').removeClass('bg-primary').css({'background-color': '#0fd08c'});\n            }\n            corrects++;\n        } else { // INCORRECT.\n            if (manualMode === false || jQuery('.modal-body').length || fromTeacher === true) {\n                userR.color = '#f85455';\n                optionLeft.find('.feedback-icon.incorrect').css({'display': 'flex'});\n                optionLeft.find('.content-option').removeClass('bg-primary').css({'background-color': '#f85455'});\n                optionRight.find('.content-option').removeClass('bg-primary').css({'background-color': '#f85455'});\n            }\n            fails++;\n        }\n    });\n    Match.prototype.drawMobileResponse(fromTeacher);\n    return [corrects, fails];\n};\n\nMatch.prototype.hideResponse = function() {\n    let corrects = 0;\n    let fails = 0;\n    linkList.forEach(userR => {\n        let optionLeft = jQuery('#' + userR.dragId).parents('.option-left').first();\n        let optionRight = jQuery('#' + userR.dropId).parents('.option-right').first();\n        userR.color = Match.prototype.getRandomColor(linkList.indexOf(userR));\n        optionLeft.find('.feedback-icon').css({'display': 'none'});\n        optionLeft.find('.content-option').css({'background-color': 'inherit'}).addClass('bg-primary');\n        optionRight.find('.content-option').css({'background-color': 'inherit'}).addClass('bg-primary');\n    });\n    Match.prototype.hideMobileResponse();\n    return [corrects, fails];\n};\n\nMatch.prototype.showCorrects = function() {\n    linkCorrection.forEach(userR => {\n        userR.color = '#0fd08c';\n    });\n};\n\nMatch.prototype.sendResponse = function() {\n    Match.prototype.allDisabled();\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\n        jQuery(REGION.ROOT).append(html);\n        dispatchEvent(Match.prototype.endTimer);\n        removeEventListener('timeFinish', () => Match.prototype.sendResponse, {once: true});\n        Match.prototype.removeEvents();\n        let timeLeft = parseInt(jQuery(REGION.SECONDS).text());\n        let result = 0; // Failure\n        let [corrects, fails] = Match.prototype.drawResponse();\n        if (corrects !== 0) {\n            result = 2; // Partially.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === corrects) {\n            result = 1; // Correct.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === fails) {\n            result = 0; // Failure.\n        }\n        if (jQuery(REGION.LEFT_OPTION_SELECTOR).length === 0 && jQuery(REGION.LEFT_OPTION_SELECTOR).length === 0) {\n            result = 3; // No response.\n        }\n        Match.prototype.drawLinks();\n\n        let request = {\n            methodname: SERVICES.REPLY,\n            args: {\n                jsonresponse: JSON.stringify(linkList),\n                result: result,\n                sessionid: sId,\n                jqshowid: jqshowId,\n                cmid: cmId,\n                questionid: questionid,\n                jqid: jqid,\n                timeleft: timeLeft || 0,\n                preview: false\n            }\n        };\n        Ajax.call([request])[0].done(function(response) {\n            if (response.reply_status === true) {\n                questionEnd = true;\n                jQuery(ACTION.SEND_RESPONSE).addClass('d-none');\n                jQuery(REGION.NEXT).removeClass('d-none');\n                dispatchEvent(Match.prototype.studentQuestionEnd);\n                if (response.hasfeedbacks) {\n                    jQuery(REGION.FEEDBACK).html(response.statment_feedback);\n                    jQuery(REGION.FEEDBACKANSWER).html(response.answer_feedback);\n                }\n                if (jQuery('.modal-body').length) { // Preview.\n                    Match.prototype.showAnswers();\n                    if (showQuestionFeedback === true) {\n                        Match.prototype.showFeedback();\n                    }\n                } else {\n                    if (manualMode === false) {\n                        Match.prototype.showAnswers();\n                        if (showQuestionFeedback === true) {\n                            Match.prototype.showFeedback();\n                        }\n                    }\n                }\n                jQuery(REGION.CONTAINER_ANSWERS).css('z-index', 3);\n                jQuery(REGION.CONTAINER_ANSWERS_MOBILE).css('z-index', 3);\n                jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n            } else {\n                alert('error');\n            }\n            jQuery(REGION.LOADING).remove();\n        });\n    });\n};\n\n/* Add event */\nMatch.prototype.addEventsDragAndDrop = function(el) {\n    el.addEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.addEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.addEventListener('touchstart', Match.prototype.touchStart, false);\n    el.addEventListener('touchmove', Match.prototype.touchMove, false);\n    el.addEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.removeEventsDragAndDrop = function(el) {\n    el.removeEventListener('dragstart', Match.prototype.onDragStart, false);\n    el.removeEventListener('dragend', Match.prototype.onDragEnd, false);\n    el.removeEventListener('touchstart', Match.prototype.touchStart, false);\n    el.removeEventListener('touchmove', Match.prototype.touchMove, false);\n    el.removeEventListener('touchend', Match.prototype.touchEnd, false);\n};\n\nMatch.prototype.addTargetEvents = function(target) {\n    target.addEventListener('dragover', Match.prototype.onDragOver, false);\n    target.addEventListener('drop', Match.prototype.onDrop, false);\n};\n\nMatch.prototype.removeTargetEvents = function(target) {\n    target.removeEventListener('dragover', Match.prototype.onDragOver, false);\n    target.removeEventListener('drop', Match.prototype.onDrop, false);\n};\n\n/* DRAG AND DROP */\nMatch.prototype.onDragStart = function(event) {\n    event.dataTransfer.setData('text/plain', event.target.id);\n    startPoint = event.target.id;\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(event.currentTarget));\n};\n\nMatch.prototype.onDragOver = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDragEnd = function(event) {\n    Match.prototype.clearPathTemp();\n    event.preventDefault();\n};\n\nMatch.prototype.onDrop = function(event) {\n    const dragId = event.dataTransfer.getData('text');\n    const dropId = jQuery(event.currentTarget).find(REGION.POINTER).attr('id');\n    Match.prototype.Drop(dragId, dropId);\n};\n\nMatch.prototype.Drop = function(dragId, dropId){\n    let deselected = linkList.filter(obj => {\n        return obj.dragId === dragId || obj.dropId === dropId;\n    });\n    if (deselected.length) {\n        deselected.forEach(x => {\n            let selectroDropId = jQuery(\"#\" + x.dropId);\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n            selectroDropId.find(\"i\").removeClass('linked');\n            selectroDropId.find(\"i\").css('font-weight', '400');\n            selectroDropId.find(\"i\").css('color', '#5a57ff');\n        });\n    }\n\n    linkList = linkList.filter(obj => {\n        return obj.dragId !== dragId;\n    });\n    linkList = linkList.filter(obj => {\n        return obj.dropId !== dropId;\n    });\n\n    let stemsLeft = jQuery('#' + dragId).data('forstems');\n    let stemsRight = jQuery('#' + dropId).data('forstems');\n    let stemDragId = Match.prototype.baseConvert(stemsLeft, 2, 16);\n    let stemDropId = Match.prototype.baseConvert(stemsRight, 26, 10);\n\n    linkList.push({dragId, dropId, color, stemDragId, stemDropId, stemsLeft, stemsRight});\n    Match.prototype.drawLinks();\n    Match.prototype.drawSelects();\n    Match.prototype.clearPathTemp();\n};\n\nMatch.prototype.baseConvert = function(number, frombase, tobase) {\n    // eslint-disable-next-line no-bitwise\n    return parseInt(number + '', frombase | 0).toString(tobase | 0);\n};\n\n/* TOUCHE DEVICE */\nMatch.prototype.touchStart = function(e) {\n    if (e.target.id === undefined || e.target.id === '') {\n        if (jQuery(e.target).parent().attr('id') !== undefined) {\n            startPoint = jQuery(e.target).parent().attr('id');\n        } else {\n            startPoint = jQuery(e.target).closest('.option-left').find(\".drag-element\").first().attr('id');\n        }\n    }\n\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(e.currentTarget));\n};\n\nMatch.prototype.touchMove = function(e) {\n    e.preventDefault();\n    let top = toucheY = e.touches[0].pageY,\n        left = toucheX = e.touches[0].pageX;\n    Match.prototype.drawLinkTemp(startPoint, {top, left});\n};\n\nMatch.prototype.touchEnd = function(e) {\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(target => {\n        let box2 = target.getBoundingClientRect(),\n            x = box2.left,\n            y = box2.top,\n            h = target.offsetHeight,\n            w = target.offsetWidth,\n            b = y + h,\n            r = x + w;\n\n        if (toucheX > x && toucheX < r && toucheY > y && toucheY < b) {\n            let dropId;\n            if (target.id === undefined || target.id === '' || target.id === 'dropOption') {\n                if (jQuery(target).parent().attr('id') !== undefined && jQuery(target).parent().attr('id') !== 'dropOption') {\n                    dropId = jQuery(target).parent().attr('id');\n                } else {\n                    dropId = jQuery(target).closest('.option-right').find(\".drop-element\").first().attr('id');\n                }\n            } else {\n                dropId = target.id;\n            }\n            Match.prototype.Drop(startPoint, dropId);\n        } else {\n            return false;\n        }\n    });\n    Match.prototype.clearPathTemp();\n    e.preventDefault();\n};\n\n/* Draw final line */\nMatch.prototype.drawLinks = function() {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    linkList.forEach(link => Match.prototype.drawLink(link.dragId, link.dropId, link.color));\n};\n\nMatch.prototype.drawCorrectLinks = function() {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    linkCorrection.forEach(link => Match.prototype.drawLink(link.dragId, link.dropId, link.color));\n    linkCorrection.forEach(link => Match.prototype.drawSelect(link.stemsLeft, link.stemsRight, link.color));\n};\n\nMatch.prototype.drawLink = function(obj1, obj2, pColor) {\n    let canvas = jQuery(REGION.CANVAS).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let $obj2 = jQuery(\"#\" + obj2);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = $obj2.offset();\n    let w2 = $obj2.width();\n    let h2 = $obj2.height();\n    let wc = jQuery(REGION.CANVAS).width();\n    ctx.beginPath();\n    ctx.strokeStyle = pColor ? pColor : color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n    ctx.bezierCurveTo(wc / 2, p1.top - parent.top + (h1 / 2) - 20 - 2,\n        wc / 2, p2.top - parent.top + (h2 / 2) - 20 - 2,\n        wc - 4, p2.top - parent.top + (h2 / 2) - 20 - 2);\n    ctx.stroke();\n\n    $obj1.children().css('color', pColor ? pColor : color);\n    $obj1.children().css('font-weight', '900');\n    $obj2.children().css('color', pColor ? pColor : color);\n    $obj2.children().css('font-weight', '900');\n    $obj2.children().addClass('linked');\n};\n\nMatch.prototype.clearPath = function(event) {\n    let ident = event.currentTarget.id;\n    let oldStemsLeft = '';\n    let oldStemsRight = '';\n    linkList = linkList.filter(obj => {\n        if (obj.dropId === ident) {\n            oldStemsLeft = obj.stemsLeft;\n            oldStemsRight = obj.stemsRight;\n        }\n        return obj.dropId !== ident;\n    });\n    let dragQuestionObject = jQuery(REGION.CONTAINER_ANSWERS);\n    dragQuestionObject.find(\"i\").removeClass('linked');\n    dragQuestionObject.find(\"i\").css('font-weight', '400');\n    dragQuestionObject.find(\"i\").css('color', '#5a57ff');\n    Match.prototype.drawLinks();\n    if (oldStemsLeft !== '' && oldStemsRight !== '') {\n        Match.prototype.optionDeselected(oldStemsLeft, oldStemsRight);\n    }\n    Match.prototype.drawSelects();\n};\n\n/* Draw path mouse line */\nMatch.prototype.drawLinkTemp = function(obj1, coordPt) {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n\n    let $obj1 = jQuery(\"#\" + obj1);\n    let parent = jQuery(REGION.CONTAINER_ANSWERS).offset();\n    let p1 = $obj1.offset();\n    let w1 = $obj1.width();\n    let h1 = $obj1.height();\n    let p2 = coordPt;\n    let c = jQuery(REGION.CANVASTEMP).offset();\n\n    ctx.beginPath();\n    ctx.strokeStyle = color;\n    ctx.lineWidth = 3;\n    ctx.moveTo(0, p1.top - parent.top + (h1 / 2) - 20 - 2);\n\n    ctx.bezierCurveTo((p2.left - c.left) / 2, p1.top - parent.top - 19 - 2,\n        (p2.left - c.left) / 2,p2.top - parent.top - 19 - 2,\n        p2.left - c.left, p2.top - parent.top - 19 - 2);\n    Match.prototype.clearPathTemp();\n    ctx.stroke();\n};\n\nMatch.prototype.clearPathTemp = function() {\n    let canvas = jQuery(REGION.CANVASTEMP).get(0);\n    let ctx = canvas.getContext('2d');\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n};\n\n/* CLICKS */\nMatch.prototype.leftOptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        if (e.target !== item) {\n            jQuery(item).parent().addClass('disabled');\n        } else {\n            jQuery(item).parents('.option').first().find('.option-pointer').addClass('disabled');\n        }\n    });\n    jQuery.each(jQuery(REGION.CLEARPATH), function(index, item) {\n        jQuery(item).addClass('disabled');\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'inherit'});\n    });\n    jQuery(REGION.RIGHT_OPTION_CLICKABLE).on('click touchend', Match.prototype.rightOptionSelected.bind(this));\n    let options = document.querySelectorAll(REGION.LEFT_OPTION_SELECTOR);\n    color = Match.prototype.getRandomColor(Array.from(options).indexOf(jQuery(e.target).parents('.option').first().get(0)));\n};\n\nMatch.prototype.rightOptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let dragId = jQuery('.option-left:not(.disabled)').find('.drag-element').attr('id');\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        if (e.target === item) {\n            let dropId = jQuery(item).parents('.option-right').first().find('.drop-element').attr('id');\n            document.getElementById(dropId).click();\n            Match.prototype.Drop(dragId, dropId);\n            jQuery(dragId).removeClass('disabled');\n        }\n        jQuery('.option-left').removeClass('disabled');\n        jQuery('.drag-element').removeClass('disabled');\n        jQuery(REGION.RIGHT_OPTION_CLICKABLE).off('click touchend');\n        jQuery.each(jQuery(REGION.CLEARPATH), function(index, item) {\n            jQuery(item).removeClass('disabled');\n        });\n        jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'none'});\n        });\n    });\n};\n\nMatch.prototype.allDisabled = function() {\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.POINTER), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery(REGION.CONTAINER_ANSWERS).unbind('dragover');\n    jQuery(ACTION.SELECTOPTION).unbind('change').css({'pointer-events': 'none'});\n    jQuery(REGION.LEFT_OPTION).find(REGION.OPTION).toArray().forEach(dragEl => this.removeEventsDragAndDrop(dragEl));\n    jQuery(REGION.RIGHT_OPTION).find(REGION.OPTION).toArray().forEach(dropEl => this.removeTargetEvents(dropEl));\n    jQuery(REGION.CLEARPATH).off('click touchend');\n    jQuery(REGION.LEFT_OPTION_CLICKABLE).off('click touchend');\n    jQuery(ACTION.SEND_RESPONSE).off('click');\n};\n\n/* MOBILE */\nMatch.prototype.OptionSelected = function(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    let optionLeft = jQuery(e.target);\n    let optionRight = jQuery(e.target).find('option:selected');\n    let stemsLeft = optionLeft.attr('data-stems');\n    let stemsRight = optionRight.attr('data-stems');\n    if (stemsRight !== 'default') {\n        jQuery('#' + stemsLeft + '-left-clickable').trigger('click');\n        setTimeout(function() {\n            jQuery('#' + stemsRight + '-right-clickable').trigger('click');\n            optionLeft.css({'border': '1px solid ' + color});\n        }, 200);\n    } else {\n        let dragId = stemsLeft + '-draggable';\n        let oldDropId = '';\n        let oldStemsRight = '';\n        linkList = linkList.filter(obj => {\n            if (obj.dragId === dragId) {\n                oldDropId = obj.dropId;\n                oldStemsRight = obj.stemsRight;\n            }\n            return obj.dragId !== dragId;\n        });\n        Match.prototype.optionDeselected(stemsLeft, oldStemsRight);\n        jQuery('#' + oldDropId).trigger('click');\n    }\n};\n\nMatch.prototype.optionSelected = function(stemsLeft, stemsRight, color) {\n    jQuery(ACTION.SELECTOPTION).each(function() {\n        jQuery(this).find('option[data-stems=\"' + stemsRight + '\"]')\n            .each(function() {\n                jQuery(this).css('background-color', color);\n        });\n    });\n};\n\nMatch.prototype.optionDeselected = function(stemsLeft, stemsRight) {\n    jQuery(ACTION.SELECTOPTION).each(function() {\n        if (parseInt(jQuery(this).attr('data-stems')) === parseInt(stemsLeft)) {\n            jQuery(this).css({'border': '1px solid #8f959e'});\n        }\n        if (jQuery(this).find('option[data-stems=\"' + stemsRight + '\"]:selected').length) {\n            jQuery(this).find('option[data-stems=\"default\"]').prop('selected', true);\n        }\n        jQuery(this).find('option[data-stems=\"' + stemsRight + '\"]').each(function() {\n            jQuery(this).css('background-color', 'white');\n        });\n    });\n};\n\nMatch.prototype.drawSelects = function() {\n    jQuery(ACTION.SELECTOPTION).each(function() {\n        jQuery(this).find('option').each(function() {\n            jQuery(this).css('background-color', 'white');\n        });\n    });\n    linkList.forEach(\n        select => Match.prototype.drawSelect(select.stemsLeft, select.stemsRight, select.color)\n    );\n};\n\nMatch.prototype.drawSelect = function(stemsLeft, stemsRight, color) {\n    jQuery('.content-options-right-mobile[data-stems=\"' + stemsLeft + '\"]').css({'border': '1px solid ' + color});\n    jQuery(\n        '.content-options-right-mobile[data-stems=\"' + stemsLeft + '\"]' +\n        ' .option-right-mobile[data-stems=\"' + stemsRight + '\"]').prop('selected', true);\n    Match.prototype.optionSelected(stemsLeft, stemsRight, color);\n};\n\nMatch.prototype.drawMobileResponse = function(fromTeacher = false) {\n    linkList.forEach(userR => {\n        let feedbacks = jQuery('.feedback-icons[data-stems=\"' + userR.stemsLeft + '\"]');\n        let optionLeft = jQuery('.content-options-right-mobile[data-stems=\"' + userR.stemsLeft + '\"]');\n        let optionRight = jQuery(\n            '.content-options-right-mobile[data-stems=\"' + userR.stemsLeft + '\"]' +\n            ' .option-right-mobile[data-stems=\"' + userR.stemsRight + '\"]');\n        if (manualMode === false || jQuery('.modal-body').length || fromTeacher === true) {\n            if (userR.stemDragId === userR.stemDropId) {\n                userR.color = '#0fd08c';\n                feedbacks.find('.feedback-icon.correct').css({'display': 'flex'});\n                optionLeft.css({'border': '1px solid #0fd08c'});\n                optionRight.css({'background-color': '#0fd08c'}).prop('selected', true);\n            } else {\n                userR.color = '#f85455';\n                feedbacks.find('.feedback-icon.incorrect').css({'display': 'flex'});\n                optionLeft.css({'border': '1px solid #f85455'});\n                optionRight.css({'background-color': '#f85455'}).prop('selected', true);\n            }\n        }\n    });\n};\n\nMatch.prototype.hideMobileResponse = function() {\n    linkList.forEach(userR => {\n        let feedbacks = jQuery('.feedback-icons[data-stems=\"' + userR.stemsLeft + '\"]');\n        let optionLeft = jQuery('.content-options-right-mobile[data-stems=\"' + userR.stemsLeft + '\"]');\n        let optionRight = jQuery(\n            '.content-options-right-mobile[data-stems=\"' + userR.stemsLeft + '\"]' +\n            ' .option-right-mobile[data-stems=\"' + userR.stemsRight + '\"]');\n        feedbacks.find('.feedback-icon').css({'display': 'none'});\n        optionLeft.css({'border': '1px solid' + userR.color});\n        optionRight.css({'background-color': userR.color});\n    });\n};\n\n/* EVENTS */\nMatch.prototype.pauseQuestion = function() {\n    dispatchEvent(new Event('pauseQuestion'));\n    jQuery(REGION.TIMER).css('z-index', 3);\n    jQuery(REGION.FEEDBACKBACGROUND).css('display', 'block');\n    jQuery(ACTION.REPLY).css('pointer-events', 'none');\n    jQuery.each(jQuery('.drag-element'), function(index, item) {\n        jQuery(item).css({'z-index': '0'});\n    });\n    jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n    jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n        jQuery(item).css({'pointer-events': 'none'});\n    });\n};\n\nMatch.prototype.playQuestion = function() {\n    if (questionEnd !== true) {\n        dispatchEvent(new Event('playQuestion'));\n        jQuery(REGION.TIMER).css('z-index', 1);\n        jQuery(REGION.FEEDBACKBACGROUND).css('display', 'none');\n        jQuery(ACTION.REPLY).css('pointer-events', 'auto');\n        jQuery.each(jQuery('.drag-element'), function(index, item) {\n            jQuery(item).css({'z-index': '2'});\n        });\n        jQuery.each(jQuery(REGION.LEFT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'inherit'});\n        });\n        jQuery.each(jQuery(REGION.RIGHT_OPTION_CLICKABLE), function(index, item) {\n            jQuery(item).css({'pointer-events': 'inherit'});\n        });\n    }\n};\n\nMatch.prototype.showAnswers = function() {\n    showingAnswers = true;\n    Match.prototype.drawResponse(true);\n    Match.prototype.drawLinks();\n};\n\nMatch.prototype.hideAnswers = function() {\n    showingAnswers = false;\n    Match.prototype.hideResponse();\n    Match.prototype.drawLinks();\n    if (showingFeedback) {\n        Match.prototype.showFeedback();\n    } else {\n        Match.prototype.hideFeedback();\n    }\n};\n\nMatch.prototype.showStatistics = function() {\n    if (questionEnd === true) {\n        jQuery('#statistics').css({'display': 'block', 'z-index': 3});\n    }\n};\n\nMatch.prototype.hideStatistics = function() {\n    if (questionEnd === true) {\n        jQuery('#statistics').css({'display': 'none', 'z-index': 0});\n    }\n};\n\nMatch.prototype.showFeedback = function() {\n    if (questionEnd === true) {\n        showingFeedback = true;\n        if (jQuery('.modal-body').length === 0 && manualMode === true) {\n            Match.prototype.hideResponse();\n            Match.prototype.showCorrects();\n            Match.prototype.drawCorrectLinks();\n        }\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'block', 'z-index': 3});\n    }\n};\n\nMatch.prototype.hideFeedback = function() {\n    if (questionEnd === true) {\n        showingFeedback = false;\n        jQuery(REGION.CONTENTFEEDBACKS).css({'display': 'none', 'z-index': 0});\n        if (showingAnswers) {\n            Match.prototype.drawResponse(true);\n            Match.prototype.drawLinks();\n        } else {\n            Match.prototype.hideResponse();\n            Match.prototype.drawLinks();\n        }\n    }\n};\n\n\nexport const initMatch = (selector, showquestionfeedback, manualmode, jsonresponse) => {\n    return new Match(selector, showquestionfeedback, manualmode, jsonresponse);\n};\n"],"names":["cmId","sId","questionid","jqshowId","jqid","startPoint","color","toucheX","toucheY","ACTION","SEND_RESPONSE","SELECTOPTION","REGION","SERVICES","TEMPLATES","questionEnd","showQuestionFeedback","manualMode","linkList","linkCorrection","showingAnswers","showingFeedback","Match","selector","showquestionfeedback","manualmode","jsonresponse","node","this","attr","createLinkCorrection","answered","JSON","parse","atob","length","showFeedback","showAnswers","setTimeout","initMatch","prototype","endTimer","Event","studentQuestionEnd","allDisabled","drawResponse","drawSelects","addClass","css","removeClass","document","querySelector","notifyFilterContentUpdated","normalizeCanvas","bind","top","window","event","pageY","left","pageX","drawLinkTemp","find","toArray","forEach","dragEl","addEventsDragAndDrop","dropEl","addTargetEvents","drawLinks","on","clearPath","leftOptionSelected","off","sendResponse","OptionSelected","initEvents","heightLeft","height","heightRight","canvasHeight","width","addEventListener","once","ev","data","detail","userid","show","e","statistics","statistic","correct","html","failure","invalid","noresponse","partially","pauseQuestion","playQuestion","hideAnswers","showStatistics","hideStatistics","hideFeedback","removeEvents","onbeforeunload","removeEventListener","each","index","item","dragId","steam","baseConvert","dropId","stemsLeft","stemsRight","push","getRandomColor","position","fromTeacher","corrects","fails","userR","optionLeft","parents","first","optionRight","stemDragId","stemDropId","drawMobileResponse","hideResponse","indexOf","hideMobileResponse","showCorrects","render","visible","done","append","dispatchEvent","timeLeft","parseInt","text","result","request","methodname","args","stringify","sessionid","jqshowid","cmid","timeleft","preview","call","response","reply_status","hasfeedbacks","statment_feedback","answer_feedback","alert","remove","el","onDragStart","onDragEnd","touchStart","touchMove","touchEnd","removeEventsDragAndDrop","target","onDragOver","onDrop","removeTargetEvents","dataTransfer","setData","id","options","querySelectorAll","Array","from","currentTarget","clearPathTemp","preventDefault","getData","Drop","deselected","filter","obj","x","selectroDropId","number","frombase","tobase","toString","undefined","parent","closest","touches","box2","getBoundingClientRect","y","h","offsetHeight","w","offsetWidth","canvas","get","getContext","clearRect","link","drawLink","drawCorrectLinks","drawSelect","obj1","obj2","pColor","ctx","$obj1","$obj2","offset","p1","h1","p2","h2","wc","beginPath","strokeStyle","lineWidth","moveTo","bezierCurveTo","stroke","children","ident","oldStemsLeft","oldStemsRight","dragQuestionObject","optionDeselected","coordPt","c","stopPropagation","rightOptionSelected","getElementById","click","unbind","trigger","oldDropId","optionSelected","prop","select","feedbacks","REPLY"],"mappings":"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"}