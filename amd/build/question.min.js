define("mod_jqshow/question",["exports","jquery","core/ajax","core/templates","core/notification"],(function(_exports,_jquery,_ajax,_templates,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initQuestion=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_templates=_interopRequireDefault(_templates),_notification=_interopRequireDefault(_notification);var cmId,sId,ACTION_EXPAND='[data-action="question-fullscreen"]',ACTION_COMPRESS='[data-action="question-exit-fullscreen"]',ACTION_NEXTQUESTION='[data-action="next-question"]',REGION={PAGE_HEADER:"#page-header",BODY:"body.path-mod-jqshow",NAV:"nav.navbar",SESSIONCONTENT:'[data-region="session-content"]'},SERVICES_NEXTQUESTION="mod_jqshow_nextquestion",TEMPLATES_LOADING="core/overlay_loading",TEMPLATES_QUESTION="mod_jqshow/questions/encasement";function Question(selector){this.node=(0,_jquery.default)(selector),this.initQuestion()}Question.prototype.node=null,Question.prototype.initQuestion=function(){sId=this.node.attr("data-sid"),cmId=this.node.attr("data-cmid"),this.node.find(ACTION_EXPAND).on("click",this.fullScreen),this.node.find(ACTION_COMPRESS).on("click",this.exitFullScreen),(0,_jquery.default)(ACTION_NEXTQUESTION).on("click",this.nextQuestion);var that=this;(0,_jquery.default)(document).keyup((function(e){"Escape"===e.key&&that.exitFullScreen()})),addEventListener("questionEnd",(function(){(0,_jquery.default)(ACTION_NEXTQUESTION).removeClass("d-none")}),!1)},Question.prototype.fullScreen=function(e){e.preventDefault(),e.stopPropagation(),(0,_jquery.default)(ACTION_EXPAND).css("display","none"),(0,_jquery.default)(ACTION_COMPRESS).css("display","block"),(0,_jquery.default)(REGION.BODY).addClass("fullscreen"),(0,_jquery.default)(window).scrollTop(0),(0,_jquery.default)("html, body").animate({scrollTop:0},500);var element=document.getElementById("page-mod-jqshow-view");void 0===element&&(element=document.getElementById("page-mod-jqshow-preview")),element.requestFullscreen?element.requestFullscreen():element.webkitRequestFullscreen?element.webkitRequestFullscreen():element.msRequestFullscreen&&element.msRequestFullscreen()},Question.prototype.exitFullScreen=function(){(0,_jquery.default)(ACTION_EXPAND).css("display","block"),(0,_jquery.default)(ACTION_COMPRESS).css("display","none"),(0,_jquery.default)(REGION.BODY).removeClass("fullscreen"),document.fullscreen&&document.exitFullscreen()},Question.prototype.nextQuestion=function(e){e.preventDefault(),e.stopPropagation(),_templates.default.render(TEMPLATES_LOADING,{visible:!0}).done((function(html){var identifier=(0,_jquery.default)(REGION.SESSIONCONTENT);identifier.append(html);var request={methodname:SERVICES_NEXTQUESTION,args:{cmid:cmId,sessionid:sId,questionid:(0,_jquery.default)(e.currentTarget).attr("data-questionid")}};console.log(request),_ajax.default.call([request])[0].done((function(response){var templateQuestions=TEMPLATES_QUESTION;_templates.default.render(templateQuestions,response).then((function(html,js){identifier.html(html),_templates.default.runTemplateJS(js),(0,_jquery.default)(REGION.LOADING).remove()})).fail(_notification.default.exception)}))}))};_exports.initQuestion=function(selector){return new Question(selector)}}));

//# sourceMappingURL=question.min.js.map