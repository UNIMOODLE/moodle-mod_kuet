define("mod_jqshow/matchConnections",["exports","jquery"],(function(_exports,_jquery){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=_exports.connections=void 0,_jquery=(obj=_jquery)&&obj.__esModule?obj:{default:obj};var connections=function(from,options){return"update"===options?processConnections(update,this):"remove"===options?processConnections(destroy,this):(options=_jquery.default.extend(!0,{borderClasses:{},class:"connection",css:{},from:from,tag:"connection",to:this,within:":root"},options),connect(options),this)};_exports.connections=connections;var connect=function(options){var borderClasses=options.borderClasses,tag=options.tag,end1=(0,_jquery.default)(options.from),end2=(0,_jquery.default)(options.to),within=(0,_jquery.default)(options.within);delete options.borderClasses,delete options.tag,delete options.from,delete options.to,delete options.within,within.each((function(){var container=this,done=[];end1.each((function(){var node=this;done.push(this),end2.not(done).each((function(){createConnection(container,[node,this],tag,borderClasses,options)}))}))}))},createConnection=function(container,nodes,tag,borderClasses,options){var css=_jquery.default.extend({position:"absolute"},options.css),connection=(0,_jquery.default)("<"+tag+"/>",options).css(css);connection.appendTo(container);var border_w=(connection.outerWidth()-connection.innerWidth())/2,border_h=(connection.outerHeight()-connection.innerHeight())/2;border_w<=0&&border_h<=0&&(border_w=border_h=1);var data={borderClasses:borderClasses,border_h:border_h,border_w:border_w,node_from:(0,_jquery.default)(nodes[0]),node_to:(0,_jquery.default)(nodes[1]),nodes_dom:nodes,css:css};"none"===connection.css("border-top-style")&&(data.css.borderStyle="solid"),_jquery.default.data(connection.get(0),"connection",data),_jquery.default.data(connection.get(0),"connections",[connection.get(0)]);for(var i=0;i<2;i++){var _connections=connection.add(_jquery.default.data(nodes[i],"connections")).get();_jquery.default.data(nodes[i],"connections",_connections),1==_connections.length&&(0,_jquery.default)(nodes[i]).on("connections.connections",!1)}update(connection.get(0))},destroy=function(connection){for(var nodes=_jquery.default.data(connection,"connection").nodes_dom,i=0;i<2;i++){var _connections2=(0,_jquery.default)(_jquery.default.data(nodes[i],"connections")).not(connection).get();_jquery.default.data(nodes[i],"connections",_connections2)}(0,_jquery.default)(connection).remove()},update=function(connection){var data=_jquery.default.data(connection,"connection");if(function(data){data.rect_from=data.nodes_dom[0].getBoundingClientRect(),data.rect_to=data.nodes_dom[1].getBoundingClientRect();var cached=data.cache;if(data.cache=[data.rect_from.top,data.rect_from.right,data.rect_from.bottom,data.rect_from.left,data.rect_to.top,data.rect_to.right,data.rect_to.bottom,data.rect_to.left],data.hidden=0==(data.cache[0]|data.cache[1]|data.cache[2]|data.cache[3])||0==(data.cache[4]|data.cache[5]|data.cache[6]|data.cache[7]),data.unmodified=!0,void 0===cached)return data.unmodified=!1;for(var i=0;i<8;i++)if(cached[i]!==data.cache[i])return data.unmodified=!1}(data),!data.unmodified){var border_h=data.border_h,border_w=data.border_w,from=data.rect_from,to=data.rect_to,b=(from.bottom+from.top)/2,r=(to.left+to.right)/2,t=(to.bottom+to.top)/2,l=(from.left+from.right)/2,h=["right","left"];if(l>r){h=["left","right"];var x=Math.max(r-border_w/2,Math.min(from.right,to.right));r=l+border_w/2,l=x}else l-=border_w/2,r=Math.min(r+border_w/2,Math.max(from.left,to.left));var v=["bottom","top"];if(t>b){v=["top","bottom"];var _x=Math.max(b-border_h/2,Math.min(from.bottom,to.bottom));b=t+border_h/2,t=_x}else b=Math.min(b,Math.max(from.top,to.top)),t-=border_h/2;var width=r-l,height=b-t;width<border_w&&(t=Math.max(t,Math.min(from.bottom,to.bottom)),b=Math.min(b,Math.max(from.top,to.top)),r=l=((l=Math.max(from.left,to.left))+(r=Math.min(from.right,to.right))-border_w)/2),height<border_h&&(l=Math.max(l,Math.min(from.right,to.right)),r=Math.min(r,Math.max(from.left,to.left)),b=t=((t=Math.max(from.top,to.top))+(b=Math.min(from.bottom,to.bottom))-border_h)/2),(width=r-l)<=0&&(border_h=0),(height=b-t)<=0&&(border_w=0);var style="border-"+v[0]+"-"+h[0]+"-radius: 0;border-"+v[0]+"-"+h[1]+"-radius: 0;border-"+v[1]+"-"+h[0]+"-radius: 0;";if((border_h<=0||border_w<=0)&&(style+="border-"+v[1]+"-"+h[1]+"-radius: 0;"),data.hidden)style+="display: none;";else{data.css["border-"+v[0]+"-width"]=0,data.css["border-"+h[0]+"-width"]=0,data.css["border-"+v[1]+"-width"]=border_h,data.css["border-"+h[1]+"-width"]=border_w;var current_rect=connection.getBoundingClientRect();data.css.left=connection.offsetLeft+l-current_rect.left,data.css.top=connection.offsetTop+t-current_rect.top,data.css.width=width-border_w,data.css.height=height-border_h}var bc=data.borderClasses;(0,_jquery.default)(connection).removeClass(bc[v[0]]).removeClass(bc[h[0]]).addClass(bc[v[1]]).addClass(bc[h[1]]).attr("style",style).css(data.css)}},processConnections=function(method,elements){return elements.each((function(){var connections=_jquery.default.data(this,"connections");if(connections instanceof Array)for(var i=0,len=connections.length;i<len;i++)method(connections[i])}))},_default={connections:connections};return _exports.default=_default,_exports.default}));

//# sourceMappingURL=matchConnections.min.js.map