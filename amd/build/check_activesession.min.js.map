{"version":3,"file":"check_activesession.min.js","sources":["../src/check_activesession.js"],"sourcesContent":["\"use strict\";\r\n\r\nimport Ajax from 'core/ajax';\r\nimport Notification from 'core/notification';\r\n\r\nlet SERVICES = {\r\n    GETACTIVESESSION: 'mod_jqshow_getactivesession'\r\n};\r\n\r\nlet cmId;\r\nlet jqshowId;\r\n\r\n/**\r\n * @constructor\r\n * @param {int} cmid\r\n * @param {int} jqshowid\r\n */\r\nfunction CheckActiveSession(cmid, jqshowid) {\r\n    cmId = cmid;\r\n    jqshowId = jqshowid;\r\n    setInterval(this.checkActive, 5000);\r\n}\r\n\r\nCheckActiveSession.prototype.checkActive = function() {\r\n    let request = {\r\n        methodname: SERVICES.GETACTIVESESSION,\r\n        args: {\r\n            cmid: cmId,\r\n            jqshowid: jqshowId\r\n        }\r\n    };\r\n    Ajax.call([request])[0].done(function(response) {\r\n        if (response.active !== 0) {\r\n            let sessionUrl = new URL(M.cfg.wwwroot + '/mod/jqshow/session.php');\r\n            sessionUrl.searchParams.set('cmid', cmId);\r\n            sessionUrl.searchParams.set('sid', response.active);\r\n            window.location.href = sessionUrl.href;\r\n        }\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nexport const checkActiveSession = (cmid, jqshowid) => {\r\n    return new CheckActiveSession(cmid, jqshowid);\r\n};\r\n"],"names":["cmId","jqshowId","SERVICES","CheckActiveSession","cmid","jqshowid","setInterval","this","checkActive","prototype","request","methodname","args","call","done","response","active","sessionUrl","URL","M","cfg","wwwroot","searchParams","set","window","location","href","fail","Notification","exception"],"mappings":"qYASIA,KACAC,SALAC,0BACkB,uCAWbC,mBAAmBC,KAAMC,UAC9BL,KAAOI,KACPH,SAAWI,SACXC,YAAYC,KAAKC,YAAa,KAGlCL,mBAAmBM,UAAUD,YAAc,eACnCE,QAAU,CACVC,WAAYT,0BACZU,KAAM,CACFR,KAAMJ,KACNK,SAAUJ,yBAGbY,KAAK,CAACH,UAAU,GAAGI,MAAK,SAASC,aACV,IAApBA,SAASC,OAAc,KACnBC,WAAa,IAAIC,IAAIC,EAAEC,IAAIC,QAAU,2BACzCJ,WAAWK,aAAaC,IAAI,OAAQvB,MACpCiB,WAAWK,aAAaC,IAAI,MAAOR,SAASC,QAC5CQ,OAAOC,SAASC,KAAOT,WAAWS,SAEvCC,KAAKC,sBAAaC,wCAGS,CAACzB,KAAMC,WAC9B,IAAIF,mBAAmBC,KAAMC"}