{"version":3,"file":"teachersockets.min.js","sources":["../src/teachersockets.js"],"sourcesContent":["\"use strict\";\r\n\r\nimport jQuery from 'jquery';\r\nimport Templates from 'core/templates';\r\nimport Notification from 'core/notification';\r\nimport {get_string as getString, get_strings as getStrings} from 'core/str';\r\nimport ModalFactory from 'core/modal_factory';\r\nimport ModalEvents from 'core/modal_events';\r\nimport Ajax from 'core/ajax';\r\nimport Encryptor from 'mod_jqshow/encryptor';\r\nimport Database from 'mod_jqshow/database';\r\nimport mEvent from 'core/event';\r\n\r\nlet REGION = {\r\n    MESSAGEBOX: '#message-box',\r\n    USERLIST: '[data-region=\"active-users\"]',\r\n    COUNTUSERS: '#countusers',\r\n    TEACHERCANVASCONTENT: '[data-region=\"teacher-canvas-content\"]', // This root.\r\n    TEACHERCANVAS: '[data-region=\"teacher-canvas\"]',\r\n    TEACHERPANEL: '[data-region=\"teacher-panel\"]',\r\n    SESSIONCONTROLER: '[data-region=\"session-controller\"]',\r\n    SESSIONRESUME: '[data-region=\"session-resume\"]',\r\n    LISTRESULTS: '[data-region=\"list-results\"]',\r\n};\r\n\r\nlet ACTION = {\r\n    BACKSESSION: '[data-action=\"back-session\"]',\r\n    INITSESSION: '[data-action=\"init-session\"]',\r\n    ENDSESSION: '[data-action=\"end-session\"]'\r\n};\r\n\r\nlet SERVICES = {\r\n    ACTIVESESSION: 'mod_jqshow_activesession',\r\n    GETALLQUESTIONS: 'mod_jqshow_session_getallquestions',\r\n    NEXTQUESTION: 'mod_jqshow_nextquestion',\r\n    FIRSTQUESTION: 'mod_jqshow_firstquestion',\r\n    FINISHSESSION: 'mod_jqshow_finishsession',\r\n    DELETERESPONSES: 'mod_jqshow_deleteresponses',\r\n    JUMPTOQUESTION: 'mod_jqshow_jumptoquestion',\r\n    GETSESSIONRESUME: 'mod_jqshow_getsessionresume',\r\n    GETLISTRESULTS: 'mod_jqshow_getlistresults',\r\n    GETGROUPLISTRESULTS: 'mod_jqshow_getgrouplistresults',\r\n    GETQUESTIONSTATISTICS: 'mod_jqshow_getquestionstatistics',\r\n    GETSESSIONCONFIG: 'mod_jqshow_getsession',\r\n    GETPROVISIONALRANKING: 'mod_jqshow_getprovisionalranking',\r\n    GETFINALRANKING: 'mod_jqshow_getfinalranking',\r\n};\r\n\r\nlet TEMPLATES = {\r\n    LOADING: 'core/overlay_loading',\r\n    SUCCESS: 'core/notification_success',\r\n    ERROR: 'core/notification_error',\r\n    PARTICIPANT: 'mod_jqshow/session/manual/waitingroom/participant',\r\n    QUESTION: 'mod_jqshow/questions/encasement',\r\n    SESSIONRESUME: 'mod_jqshow/session/sessionresume',\r\n    LISTRESULTS: 'mod_jqshow/session/listresults',\r\n    PROVISIONALRANKING: 'mod_jqshow/ranking/provisional'\r\n};\r\n\r\nlet portUrl = '8080'; // It is rewritten in the constructor.\r\nlet userid = null;\r\nlet usersocketid = null;\r\nlet username = null;\r\nlet userimage = null;\r\nlet messageBox = null;\r\nlet countusers = null;\r\nlet cmid = null;\r\nlet sid = null;\r\nlet db = null;\r\nlet questionsJqids = [];\r\nlet waitingRoom = true;\r\nlet currentQuestionJqid = null;\r\nlet nextQuestionJqid = null;\r\nlet sessionMode = null;\r\nlet showRankingBetweenQuestions = false;\r\nlet showRankingBetweenQuestionsSwitch = false;\r\nlet showRankingFinal = false;\r\nlet groupmode = 0;\r\n\r\n/**\r\n * @constructor\r\n * @param {String} region\r\n * @param {String} port\r\n * @param {String} sessionmode\r\n * @param {Boolean} groupmode\r\n */\r\nfunction Sockets(region, port, sessionmode, groupmode) {\r\n    this.root = jQuery(region);\r\n    portUrl = port;\r\n    userid = this.root[0].dataset.userid;\r\n    username = this.root[0].dataset.username;\r\n    userimage = this.root[0].dataset.userimage;\r\n    cmid = this.root[0].dataset.cmid;\r\n    sid = this.root[0].dataset.sid;\r\n    messageBox = this.root.find(REGION.MESSAGEBOX);\r\n    countusers = this.root.find(REGION.COUNTUSERS);\r\n    groupmode = groupmode;\r\n    sessionMode = sessionmode;\r\n    switch (sessionMode) {\r\n        case 'inactive_manual':\r\n        default:\r\n            showRankingBetweenQuestions = false;\r\n            showRankingBetweenQuestionsSwitch = false;\r\n            showRankingFinal = false;\r\n            break;\r\n        case 'podium_manual': {\r\n            let request = {\r\n                methodname: SERVICES.GETSESSIONCONFIG,\r\n                args: {\r\n                    sid: sid,\r\n                    cmid: cmid\r\n                }\r\n            };\r\n            Ajax.call([request])[0].done(function(response) {\r\n                if (response.session.showgraderanking === 1) {\r\n                    showRankingBetweenQuestions = true;\r\n                }\r\n                if (response.session.showfinalgrade === 1) {\r\n                    showRankingFinal = true;\r\n                }\r\n            }).fail(Notification.exception);\r\n            break;\r\n        }\r\n    }\r\n    this.measuringSpeed(); // TODO extend to the whole mod.\r\n    this.disableDevTools(); // TODO extend to the whole mod.\r\n    this.initSockets();\r\n    this.cleanMessages(); // TODO only for develop.\r\n    this.initListeners();\r\n}\r\n\r\nSockets.prototype.cleanMessages = function() {\r\n    setInterval(function() {\r\n        messageBox.find(':first-child').remove();\r\n    }, 10000);\r\n};\r\n\r\nSockets.prototype.disableDevTools = function(){\r\n    document.addEventListener('contextmenu', (e) => e.preventDefault());\r\n    document.onkeydown = (e) => {\r\n        return !(event.keyCode === 123 ||\r\n            this.ctrlShiftKey(e, 'I') ||\r\n            this.ctrlShiftKey(e, 'J') ||\r\n            this.ctrlShiftKey(e, 'C') ||\r\n            (e.ctrlKey && e.keyCode === 'U'.charCodeAt(0)));\r\n    };\r\n};\r\n\r\nSockets.prototype.ctrlShiftKey = function(e, keyCode) {\r\n    return e.ctrlKey && e.shiftKey && e.keyCode === keyCode.charCodeAt(0);\r\n};\r\n\r\nSockets.prototype.measuringSpeed = function() {\r\n    let connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;\r\n    if (connection) {\r\n        let typeConnection = connection.effectiveType;\r\n        let speedMbps = connection.downlink;\r\n        // eslint-disable-next-line no-console\r\n        console.log(\"Type of Connection: \" + typeConnection, \"Estimated speed: \" + speedMbps + \" Mbps\");\r\n        if (speedMbps < 1) {\r\n            let reason = {\r\n                effectiveType: connection.effectiveType,\r\n                downlink: connection.downlink\r\n            };\r\n            getString('lowspeed', 'mod_jqshow', reason).done((s) => {\r\n                messageBox.append(\r\n                    '<div class=\"alert alert-danger\" role=\"alert\">' + s + '</div>'\r\n                );\r\n            });\r\n        }\r\n    } else {\r\n        // eslint-disable-next-line no-console\r\n        console.log(\"Connection speed detection is not supported in this browser.\");\r\n    }\r\n};\r\n\r\nSockets.prototype.backSession = function() {\r\n    const stringkeys = [\r\n        {key: 'backtopanelfromsession', component: 'mod_jqshow'},\r\n        {key: 'backtopanelfromsession_desc', component: 'mod_jqshow'},\r\n        {key: 'confirm', component: 'mod_jqshow'}\r\n    ];\r\n    getStrings(stringkeys).then((langStrings) => {\r\n        return ModalFactory.create({\r\n            title: langStrings[0],\r\n            body: langStrings[1],\r\n            type: ModalFactory.types.SAVE_CANCEL\r\n        }).then(modal => {\r\n            modal.setSaveButtonText(langStrings[2]);\r\n            modal.getRoot().on(ModalEvents.save, () => {\r\n                let request = {\r\n                    methodname: SERVICES.ACTIVESESSION,\r\n                    args: {\r\n                        cmid: cmid,\r\n                        sessionid: sid\r\n                    }\r\n                };\r\n                Ajax.call([request])[0].done(function() {\r\n                    window.location.replace(M.cfg.wwwroot + '/mod/jqshow/view.php?id=' + cmid);\r\n                }).fail(Notification.exception);\r\n            });\r\n            modal.getRoot().on(ModalEvents.hidden, () => {\r\n                modal.destroy();\r\n            });\r\n            return modal;\r\n        });\r\n    }).done(function(modal) {\r\n        modal.show();\r\n        // eslint-disable-next-line no-restricted-globals\r\n    }).fail(Notification.exception);\r\n};\r\n\r\n/* ****************** */\r\n\r\n/** @type {jQuery} The jQuery node for the page region. */\r\nSockets.prototype.root = null;\r\n\r\nSockets.prototype.initSockets = function() {\r\n    let that = this;\r\n    this.root.find(ACTION.BACKSESSION).on('click', this.backSession);\r\n\r\n    db = Database.initDb(sid, userid);\r\n    Sockets.prototype.webSocket = new WebSocket(\r\n        'wss://' + M.cfg.wwwroot.replace(/^https?:\\/\\//, '') + ':' + portUrl + '/jqshow'\r\n    );\r\n\r\n    Sockets.prototype.webSocket.onopen = function() { // Waitingroom.\r\n        /* The first and second questions are obtained.\r\n        When the teacher clicks on init session, the teacher will send the first question over the socket to all\r\n        students, and will get the 3rd question. When a student answers a question, a service will be called to save the answer\r\n        and progress, and the teacher will be informed via the socket. When the teacher clicks on next question,\r\n        the 2nd question will be sent by socket to all students, and the 3th question will be obtained.\r\n        The questions will be stored in the teacher's data storage, you can even store the user's answers so that you\r\n        don't have to call a service at the end for the ranking.\r\n        */\r\n\r\n        let request = {\r\n            methodname: SERVICES.FIRSTQUESTION,\r\n            args: {\r\n                cmid: cmid,\r\n                sessionid: sid\r\n            }\r\n        };\r\n        Ajax.call([request])[0].done(function(firstquestion) {\r\n            let data = {\r\n                jqid: firstquestion.jqid,\r\n                value: firstquestion\r\n            };\r\n            db.add('questions', data);\r\n            questionsJqids.push(firstquestion.jqid);\r\n            currentQuestionJqid = firstquestion.jqid;\r\n            that.setCurrentQuestion(firstquestion.jqid);\r\n            that.getNextQuestion(firstquestion.jqid);\r\n            that.root.find(ACTION.INITSESSION).removeClass('disabled');\r\n            that.root.find(ACTION.INITSESSION).on('click', that.initSession);\r\n            that.root.find(ACTION.ENDSESSION).on('click', that.endSession);\r\n        }).fail(Notification.exception);\r\n    };\r\n\r\n    Sockets.prototype.webSocket.onmessage = function(ev) {\r\n        // TODO Refactor.\r\n        let msgDecrypt = Encryptor.decrypt(ev.data);\r\n        let response = JSON.parse(msgDecrypt); // PHP sends Json data.\r\n        switch (response.action) {\r\n            case 'connect':\r\n                // The server has returned the connected status, it is time to identify yourself.\r\n                if (response.usersocketid !== undefined) {\r\n                    usersocketid = response.usersocketid;\r\n                    let msg = {\r\n                        'userid': userid,\r\n                        'name': username,\r\n                        'pic': userimage, // TODO encrypt.\r\n                        'isteacher': true,\r\n                        'cmid': cmid,\r\n                        'sid': sid,\r\n                        'usersocketid': usersocketid,\r\n                        'action': 'newuser'\r\n                    };\r\n                    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                }\r\n                break;\r\n            case 'newuser': {\r\n                let identifier = jQuery(REGION.USERLIST);\r\n                let data = response.students;\r\n                identifier.html('');\r\n                if (waitingRoom === false) {\r\n                    Sockets.prototype.normalizeUser(response.usersocketid);\r\n                }\r\n                jQuery.each(data, function(i, student) {\r\n                    let templateContext = {\r\n                        'usersocketid': student.usersocketid,\r\n                        'userimage': student.picture,\r\n                        'userfullname': student.name,\r\n                    };\r\n                    Templates.render(TEMPLATES.PARTICIPANT, templateContext).then(function(html) {\r\n                        identifier.append(html);\r\n                    }).fail(Notification.exception);\r\n                });\r\n                countusers.html(response.count);\r\n                break;\r\n            }\r\n            case 'countusers':\r\n                countusers.html(response.count);\r\n                break;\r\n            case 'studentQuestionEnd':\r\n                messageBox.append('<div>' + response.message + '</div>');\r\n                break;\r\n            case 'userdisconnected':\r\n                jQuery('[data-userid=\"' + response.usersocketid + '\"]').remove();\r\n                countusers.html(response.count);\r\n                messageBox.append('<div>' + response.message + '</div>');\r\n                break;\r\n            case 'alreadyteacher':\r\n                messageBox.append(\r\n                    '<div class=\"alert alert-danger\" role=\"alert\">' + response.message + '</div>'\r\n                );\r\n                break;\r\n            case 'pauseQuestion':\r\n                dispatchEvent(new Event('pauseQuestion_' + response.jqid));\r\n                break;\r\n            case 'playQuestion':\r\n                dispatchEvent(new Event('playQuestion_' + response.jqid));\r\n                break;\r\n            case 'showAnswers':\r\n                dispatchEvent(new Event('showAnswers_' + response.jqid));\r\n                break;\r\n            case 'hideAnswers':\r\n                dispatchEvent(new Event('hideAnswers_' + response.jqid));\r\n                break;\r\n            case 'showStatistics':\r\n                dispatchEvent(new Event('showStatistics_' + response.jqid));\r\n                break;\r\n            case 'hideStatistics':\r\n                dispatchEvent(new Event('hideStatistics_' + response.jqid));\r\n                break;\r\n            case 'showFeedback':\r\n                dispatchEvent(new Event('showFeedback_' + response.jqid));\r\n                break;\r\n            case 'hideFeedback':\r\n                dispatchEvent(new Event('hideFeedback_' + response.jqid));\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        messageBox[0].scrollTop = messageBox[0].scrollHeight;\r\n    };\r\n\r\n    Sockets.prototype.webSocket.onerror = function() {\r\n        getString('system_error', 'mod_jqshow').done((s) => {\r\n            messageBox.append(\r\n                '<div class=\"alert alert-danger\" role=\"alert\">' + s + '</div>'\r\n            );\r\n        });\r\n    };\r\n\r\n    Sockets.prototype.webSocket.onclose = function(ev) {\r\n        let reason = {\r\n            reason: ev.reason,\r\n            code: ev.code\r\n        };\r\n        getString('connection_closed', 'mod_jqshow', reason).done((s) => {\r\n            jQuery(REGION.TEACHERCANVASCONTENT).prepend(\r\n                '<div class=\"alert alert-danger\" role=\"alert\">' + s + '</div>'\r\n            );\r\n        });\r\n    };\r\n};\r\n\r\nSockets.prototype.initListeners = function() {\r\n    let that = this;\r\n    addEventListener('nextQuestion', () => {\r\n        switch (sessionMode) {\r\n            case 'inactive_programmed':\r\n            case 'inactive_manual':\r\n            default:\r\n                that.nextQuestion();\r\n                break;\r\n            case 'podium_manual':\r\n            case 'podium_programmed':\r\n                that.manageNext();\r\n                break;\r\n        }\r\n    }, false);\r\n    addEventListener('pauseQuestionSelf', () => {\r\n        that.pauseQuestion();\r\n    }, false);\r\n    addEventListener('playQuestionSelf', () => {\r\n        that.playQuestion();\r\n    }, false);\r\n    addEventListener('resendSelf', () => {\r\n        that.resendSelf();\r\n    }, false);\r\n    addEventListener('jumpTo', (e) => {\r\n        that.jumpTo(e.detail.jumpTo);\r\n    }, false);\r\n    addEventListener('teacherQuestionEndSelf', () => {\r\n        that.questionEnd();\r\n    }, false);\r\n    addEventListener('showAnswersSelf', () => {\r\n        that.showAnswers();\r\n    }, false);\r\n    addEventListener('hideAnswersSelf', () => {\r\n        that.hideAnswers();\r\n    }, false);\r\n    addEventListener('showStatisticsSelf', () => {\r\n        that.showStatistics();\r\n    }, false);\r\n    addEventListener('hideStatisticsSelf', () => {\r\n        that.hideStatistics();\r\n    }, false);\r\n    addEventListener('showFeedbackSelf', () => {\r\n        that.showFeedback();\r\n    }, false);\r\n    addEventListener('hideFeedbackSelf', () => {\r\n        that.hideFeedback();\r\n    }, false);\r\n    addEventListener('endSession', () => {\r\n        that.endSession();\r\n    }, {once: true});\r\n};\r\n\r\nSockets.prototype.setCurrentQuestion = function(currentQuestion) {\r\n    let data = {\r\n        state: 'currentQuestion',\r\n        value: currentQuestion\r\n    };\r\n    db.update('statequestions', data);\r\n};\r\n\r\nSockets.prototype.setNextQuestion = function(nextQuestion) {\r\n    let data = {\r\n        state: 'nextQuestion',\r\n        value: nextQuestion\r\n    };\r\n    db.update('statequestions', data);\r\n};\r\n\r\nSockets.prototype.setEndSession = function(endData) {\r\n    db.delete('statequestions', 'nextQuestion');\r\n    let data = {\r\n        state: 'endSession',\r\n        value: endData\r\n    };\r\n    db.update('statequestions', data);\r\n    showRankingBetweenQuestionsSwitch = false;\r\n};\r\n\r\nSockets.prototype.getNextQuestion = function(jqid) {\r\n    let that = this;\r\n    let request = {\r\n        methodname: SERVICES.NEXTQUESTION,\r\n        args: {\r\n            cmid: cmid,\r\n            sessionid: sid,\r\n            jqid: jqid,\r\n            manual: true\r\n        }\r\n    };\r\n    nextQuestionJqid = null;\r\n    Ajax.call([request])[0].done(function(nextquestion) {\r\n        if (nextquestion.endsession !== true) {\r\n            let data = {\r\n                jqid: nextquestion.jqid,\r\n                value: nextquestion\r\n            };\r\n            db.add('questions', data);\r\n            nextQuestionJqid = nextquestion.jqid;\r\n            that.setNextQuestion(nextquestion.jqid);\r\n        } else {\r\n            // End session.\r\n            nextQuestionJqid = null;\r\n            that.setEndSession(nextquestion);\r\n        }\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nSockets.prototype.initSession = function() {\r\n    db.delete('statequestions', 'endSession');\r\n    const stringkeys = [\r\n        {key: 'init_session', component: 'mod_jqshow'},\r\n        {key: 'init_session_desc', component: 'mod_jqshow'},\r\n        {key: 'confirm', component: 'mod_jqshow'},\r\n        {key: 'sessionstarted', component: 'mod_jqshow'},\r\n        {key: 'sessionstarted_info', component: 'mod_jqshow'}\r\n    ];\r\n    getStrings(stringkeys).then((langStrings) => {\r\n        return ModalFactory.create({\r\n            title: langStrings[0],\r\n            body: langStrings[1],\r\n            type: ModalFactory.types.SAVE_CANCEL\r\n        }).then(modal => {\r\n            modal.setSaveButtonText(langStrings[2]);\r\n            modal.getRoot().on(ModalEvents.save, () => {\r\n                let firstQuestion = db.get('questions', currentQuestionJqid);\r\n                firstQuestion.onsuccess = function() {\r\n                    let msg = {\r\n                        'action': 'question',\r\n                        'sid': sid,\r\n                        'context': firstQuestion.result\r\n                    };\r\n                    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n                        Sockets.prototype.initPanel();\r\n                        let identifier = jQuery(REGION.TEACHERCANVAS);\r\n                        identifier.append(html);\r\n                        currentQuestionJqid = firstQuestion.result.jqid;\r\n                        firstQuestion.result.value.isteacher = true;\r\n                        Templates.render(TEMPLATES.QUESTION, firstQuestion.result.value).then(function(html, js) {\r\n                            identifier.html(html);\r\n                            jQuery(REGION.TEACHERCANVASCONTENT).find('.content-title h2').html(langStrings[3]);\r\n                            jQuery(REGION.TEACHERCANVASCONTENT).find('.content-title small').html(langStrings[4]);\r\n                            jQuery(ACTION.BACKSESSION).remove();\r\n                            jQuery(ACTION.INITSESSION).remove();\r\n                            jQuery(ACTION.ENDSESSION).removeClass('hidden').removeClass('disabled');\r\n                            waitingRoom = false;\r\n                            if (showRankingBetweenQuestions) {\r\n                                showRankingBetweenQuestionsSwitch = true;\r\n                            }\r\n                            Templates.runTemplateJS(js);\r\n                            jQuery(REGION.LOADING).remove();\r\n                            mEvent.notifyFilterContentUpdated(document.querySelector(REGION.TEACHERCANVAS));\r\n                        }).fail(Notification.exception);\r\n                    });\r\n                };\r\n            });\r\n            modal.getRoot().on(ModalEvents.hidden, () => {\r\n                modal.destroy();\r\n            });\r\n            return modal;\r\n        });\r\n    }).done(function(modal) {\r\n        modal.show();\r\n        // eslint-disable-next-line no-restricted-globals\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nSockets.prototype.initPanel = function() {\r\n    let requestResume = {\r\n        methodname: SERVICES.GETSESSIONRESUME,\r\n        args: {\r\n            sid: sid,\r\n            cmid: cmid,\r\n        }\r\n    };\r\n    Ajax.call([requestResume])[0].done(function(responseResume) {\r\n        Templates.render(TEMPLATES.SESSIONRESUME, responseResume).then(function(html) {\r\n            jQuery(REGION.SESSIONRESUME).append(html);\r\n        });\r\n    });\r\n    let methodname = SERVICES.GETLISTRESULTS;\r\n    if (groupmode == '1') {\r\n        methodname = SERVICES.GETGROUPLISTRESULTS\r\n    }\r\n    setInterval(function() {\r\n        let requestResults = {\r\n            methodname: methodname,\r\n            args: {\r\n                sid: sid,\r\n                cmid: cmid,\r\n            }\r\n        };\r\n        Ajax.call([requestResults])[0].done(function(responseResults) {\r\n            Templates.render(TEMPLATES.LISTRESULTS, responseResults).then(function(html) {\r\n                jQuery(REGION.LISTRESULTS).html(html);\r\n            });\r\n        });\r\n    }, 20000);\r\n    jQuery(REGION.TEACHERPANEL).removeClass('d-none');\r\n};\r\n\r\nSockets.prototype.endSession = function() {\r\n    const stringkeys = [\r\n        {key: 'end_session', component: 'mod_jqshow'},\r\n        {key: 'end_session_manual_desc', component: 'mod_jqshow'},\r\n        {key: 'confirm', component: 'mod_jqshow'},\r\n        {key: 'end_session_error', component: 'mod_jqshow'}\r\n    ];\r\n    getStrings(stringkeys).then((langStrings) => {\r\n        return ModalFactory.create({\r\n            title: langStrings[0],\r\n            body: langStrings[1],\r\n            type: ModalFactory.types.SAVE_CANCEL\r\n        }).then(modal => {\r\n            modal.setSaveButtonText(langStrings[2]);\r\n            modal.getRoot().on(ModalEvents.save, () => {\r\n                let request = {\r\n                    methodname: SERVICES.FINISHSESSION,\r\n                    args: {\r\n                        cmid: cmid,\r\n                        sessionid: sid\r\n                    }\r\n                };\r\n                Ajax.call([request])[0].done(function(response) {\r\n                    if (response.finished === true) {\r\n                        let deleteDb = db.deleteDatabase();\r\n                        deleteDb.onerror = function(event) {\r\n                            // eslint-disable-next-line no-console\r\n                            console.error(\"Error deleting database.\", event);\r\n                        };\r\n                        deleteDb.onsuccess = function() {\r\n                            window.location.replace(M.cfg.wwwroot + '/mod/jqshow/view.php?id=' + cmid);\r\n                        };\r\n                    } else {\r\n                        Notification.alert('Error', langStrings[3], langStrings[2]);\r\n                    }\r\n                }).fail(Notification.exception);\r\n            });\r\n            modal.getRoot().on(ModalEvents.hidden, () => {\r\n                modal.destroy();\r\n            });\r\n            return modal;\r\n        });\r\n    }).done(function(modal) {\r\n        modal.show();\r\n        // eslint-disable-next-line no-restricted-globals\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nSockets.prototype.nextQuestion = function() {\r\n    let that = this;\r\n    if (nextQuestionJqid === null) {\r\n        this.getNextQuestion(currentQuestionJqid);\r\n    }\r\n    let nextQuestion = db.get('statequestions', 'nextQuestion');\r\n    nextQuestion.onsuccess = function() {\r\n        if (nextQuestion.result !== undefined) {\r\n            let nextQuestionData = db.get('questions', nextQuestion.result.value);\r\n            nextQuestionData.onsuccess = function() {\r\n                let msg = {\r\n                    'action': 'question',\r\n                    'sid': sid,\r\n                    'context': nextQuestionData.result\r\n                };\r\n                Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n                    let identifier = jQuery(REGION.TEACHERCANVAS);\r\n                    identifier.append(html);\r\n                    currentQuestionJqid = nextQuestionData.result.jqid;\r\n                    // The following question is marked as current.\r\n                    that.setCurrentQuestion(nextQuestionData.result.jqid);\r\n                    // And get the next question to store it.\r\n                    that.getNextQuestion(nextQuestionData.result.jqid);\r\n                    nextQuestionData.result.value.isteacher = true;\r\n                    Templates.render(TEMPLATES.QUESTION, nextQuestionData.result.value).then(function(html, js) {\r\n                        identifier.html(html);\r\n                        Templates.runTemplateJS(js);\r\n                        mEvent.notifyFilterContentUpdated(document.querySelector(REGION.TEACHERCANVAS));\r\n                        jQuery(REGION.LOADING).remove();\r\n                    }).fail(Notification.exception);\r\n                });\r\n            };\r\n        } else {\r\n            let endSession = db.get('statequestions', 'endSession');\r\n            if (showRankingFinal === false) {\r\n                endSession.onsuccess = function() {\r\n                    let msg = {\r\n                        'action': 'endSession',\r\n                        'sid': sid,\r\n                        'context': endSession.result\r\n                    };\r\n                    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n                        let identifier = jQuery(REGION.TEACHERCANVAS);\r\n                        identifier.append(html);\r\n                        currentQuestionJqid = null;\r\n                        db.delete('statequestions', 'currentQuestion');\r\n                        that.setEndSession(endSession.result);\r\n                        endSession.result.value.isteacher = true;\r\n                        Templates.render(TEMPLATES.QUESTION, endSession.result.value).then(function(html, js) {\r\n                            identifier.html(html);\r\n                            Templates.runTemplateJS(js);\r\n                            jQuery(REGION.LOADING).remove();\r\n                        }).fail(Notification.exception);\r\n                    });\r\n                };\r\n            } else {\r\n                endSession.onsuccess = function() {\r\n                    let request = {\r\n                        methodname: SERVICES.GETFINALRANKING,\r\n                        args: {\r\n                            sid: sid,\r\n                            cmid: cmid\r\n                        }\r\n                    };\r\n                    Ajax.call([request])[0].done(function(finalRanking) {\r\n                        endSession.result.value = finalRanking;\r\n                        let msg = {\r\n                            'action': 'endSession',\r\n                            'sid': sid,\r\n                            'context': endSession.result\r\n                        };\r\n                        Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                        Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n                            let identifier = jQuery(REGION.TEACHERCANVAS);\r\n                            identifier.append(html);\r\n                            currentQuestionJqid = null;\r\n                            db.delete('statequestions', 'currentQuestion');\r\n                            that.setEndSession(endSession.result);\r\n                            endSession.result.value.isteacher = true;\r\n                            Templates.render(TEMPLATES.QUESTION, endSession.result.value).then(function(html, js) {\r\n                                identifier.html(html);\r\n                                Templates.runTemplateJS(js);\r\n                                jQuery(REGION.LOADING).remove();\r\n                            }).fail(Notification.exception);\r\n                        });\r\n                    }).fail(Notification.exception);\r\n                };\r\n            }\r\n        }\r\n    };\r\n};\r\n\r\nSockets.prototype.manageNext = function() {\r\n    let that = this;\r\n    if (showRankingBetweenQuestions === false) {\r\n        that.nextQuestion();\r\n    } else {\r\n        if (showRankingBetweenQuestionsSwitch === false) {\r\n            that.nextQuestion();\r\n            showRankingBetweenQuestionsSwitch = true;\r\n        } else {\r\n            let request = {\r\n                methodname: SERVICES.GETPROVISIONALRANKING,\r\n                args: {\r\n                    sid: sid,\r\n                    cmid: cmid,\r\n                    jqid: currentQuestionJqid\r\n                }\r\n            };\r\n            Ajax.call([request])[0].done(function(provisionalRanking) {\r\n                let msg = {\r\n                    'action': 'ranking',\r\n                    'sid': sid,\r\n                    'context': provisionalRanking\r\n                };\r\n                Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                showRankingBetweenQuestionsSwitch = false;\r\n                Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n                    let identifier = jQuery(REGION.TEACHERCANVAS);\r\n                    identifier.append(html);\r\n                    provisionalRanking.isteacher = true;\r\n                    Templates.render(TEMPLATES.PROVISIONALRANKING, provisionalRanking).then(function(html, js) {\r\n                        identifier.html(html);\r\n                        Templates.runTemplateJS(js);\r\n                        jQuery(REGION.LOADING).remove();\r\n                    }).fail(Notification.exception);\r\n                });\r\n            }).fail(Notification.exception);\r\n        }\r\n    }\r\n};\r\n\r\nSockets.prototype.pauseQuestion = function() {\r\n    let msg = {\r\n        'action': 'pauseQuestion',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.playQuestion = function() {\r\n    let msg = {\r\n        'action': 'playQuestion',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.resendSelf = function() {\r\n    let request = {\r\n        methodname: SERVICES.DELETERESPONSES,\r\n        args: {\r\n            cmid: cmid,\r\n            sessionid: sid,\r\n            jqid: currentQuestionJqid\r\n        }\r\n    };\r\n    Ajax.call([request])[0].done(function(response) {\r\n        if (response.deleted === true) {\r\n            let currentQuestionData = db.get('questions', currentQuestionJqid);\r\n            currentQuestionData.onsuccess = function() {\r\n                let msg = {\r\n                    'action': 'question',\r\n                    'sid': sid,\r\n                    'context': currentQuestionData.result\r\n                };\r\n                Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n                showRankingBetweenQuestionsSwitch = true;\r\n                Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n                    let identifier = jQuery(REGION.TEACHERCANVAS);\r\n                    identifier.append(html);\r\n                    currentQuestionData.result.value.isteacher = true;\r\n                    Templates.render(TEMPLATES.QUESTION, currentQuestionData.result.value).then(function(html, js) {\r\n                        identifier.html(html);\r\n                        Templates.runTemplateJS(js);\r\n                        mEvent.notifyFilterContentUpdated(document.querySelector(REGION.TEACHERCANVAS));\r\n                        jQuery(REGION.LOADING).remove();\r\n                    }).fail(Notification.exception);\r\n                });\r\n            };\r\n        }\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nSockets.prototype.jumpTo = function(questionNumber) {\r\n    let that = this;\r\n    let request = {\r\n        methodname: SERVICES.JUMPTOQUESTION,\r\n        args: {\r\n            cmid: cmid,\r\n            sessionid: sid,\r\n            position: questionNumber,\r\n            manual: true\r\n        }\r\n    };\r\n    nextQuestionJqid = null;\r\n    Ajax.call([request])[0].done(function(question) {\r\n        let data = {\r\n            jqid: question.jqid,\r\n            value: question\r\n        };\r\n        db.add('questions', data);\r\n        currentQuestionJqid = question.jqid;\r\n        that.setCurrentQuestion(question.jqid);\r\n        that.getNextQuestion(question.jqid);\r\n        let msg = {\r\n            'action': 'question',\r\n            'sid': sid,\r\n            'context': data\r\n        };\r\n        Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n        showRankingBetweenQuestionsSwitch = true;\r\n        Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n            let identifier = jQuery(REGION.TEACHERCANVAS);\r\n            identifier.append(html);\r\n            question.isteacher = true;\r\n            Templates.render(TEMPLATES.QUESTION, question).then(function(html, js) {\r\n                identifier.html(html);\r\n                Templates.runTemplateJS(js);\r\n                mEvent.notifyFilterContentUpdated(document.querySelector(REGION.TEACHERCANVAS));\r\n                jQuery(REGION.LOADING).remove();\r\n            }).fail(Notification.exception);\r\n        });\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nSockets.prototype.questionEnd = function() {\r\n    let request = {\r\n        methodname: SERVICES.GETQUESTIONSTATISTICS,\r\n        args: {\r\n            sid: sid,\r\n            jqid: currentQuestionJqid\r\n        }\r\n    };\r\n    Ajax.call([request])[0].done(function(response) {\r\n        let msg = {\r\n            'action': 'teacherQuestionEnd',\r\n            'sid': sid,\r\n            'jqid': currentQuestionJqid,\r\n            'statistics': response.statistics\r\n        };\r\n        Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n        dispatchEvent(new CustomEvent('teacherQuestionEnd_' + currentQuestionJqid, {\r\n            \"detail\": {\"statistics\": response.statistics}\r\n        }));\r\n    }).fail(Notification.exception);\r\n};\r\n\r\nSockets.prototype.showAnswers = function() {\r\n    let msg = {\r\n        'action': 'showAnswers',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.hideAnswers = function() {\r\n    let msg = {\r\n        'action': 'hideAnswers',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.showStatistics = function() {\r\n    let msg = {\r\n        'action': 'showStatistics',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.hideStatistics = function() {\r\n    let msg = {\r\n        'action': 'hideStatistics',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.showFeedback = function() {\r\n    let msg = {\r\n        'action': 'showFeedback',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.hideFeedback = function() {\r\n    let msg = {\r\n        'action': 'hideFeedback',\r\n        'sid': sid,\r\n        'jqid': currentQuestionJqid\r\n    };\r\n    Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n};\r\n\r\nSockets.prototype.normalizeUser = function(usersocketid) {\r\n    let currentQuestion = db.get('statequestions', 'currentQuestion');\r\n    currentQuestion.onsuccess = function() {\r\n        let currentQuestiondata = db.get('questions', currentQuestion.result.value);\r\n        currentQuestiondata.onsuccess = function() {\r\n            let msg = {\r\n                'action': 'normalizeUser',\r\n                'sid': sid,\r\n                'ofs': true, // Only for student.\r\n                'usersocketid': usersocketid,\r\n                'context': currentQuestiondata.result\r\n            };\r\n            Sockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n        };\r\n    };\r\n};\r\n\r\nSockets.prototype.sendMessageSocket = function(msg) {\r\n    this.webSocket.send(msg);\r\n};\r\n\r\nexport const teacherInitSockets = (region, port, sessionmode) => {\r\n    return new Sockets(region, port, sessionmode);\r\n};\r\n"],"names":["REGION","MESSAGEBOX","USERLIST","COUNTUSERS","TEACHERCANVASCONTENT","TEACHERCANVAS","TEACHERPANEL","SESSIONCONTROLER","SESSIONRESUME","LISTRESULTS","ACTION","SERVICES","ACTIVESESSION","GETALLQUESTIONS","NEXTQUESTION","FIRSTQUESTION","FINISHSESSION","DELETERESPONSES","JUMPTOQUESTION","GETSESSIONRESUME","GETLISTRESULTS","GETGROUPLISTRESULTS","GETQUESTIONSTATISTICS","GETSESSIONCONFIG","GETPROVISIONALRANKING","GETFINALRANKING","TEMPLATES","portUrl","userid","usersocketid","username","userimage","messageBox","countusers","cmid","sid","db","questionsJqids","waitingRoom","currentQuestionJqid","nextQuestionJqid","sessionMode","showRankingBetweenQuestions","showRankingBetweenQuestionsSwitch","showRankingFinal","Sockets","region","port","sessionmode","groupmode","root","this","dataset","find","request","methodname","args","call","done","response","session","showgraderanking","showfinalgrade","fail","Notification","exception","measuringSpeed","disableDevTools","initSockets","cleanMessages","initListeners","prototype","setInterval","remove","document","addEventListener","e","preventDefault","onkeydown","event","keyCode","ctrlShiftKey","ctrlKey","charCodeAt","shiftKey","connection","navigator","mozConnection","webkitConnection","typeConnection","effectiveType","speedMbps","downlink","console","log","reason","s","append","backSession","key","component","then","langStrings","ModalFactory","create","title","body","type","types","SAVE_CANCEL","modal","setSaveButtonText","getRoot","on","ModalEvents","save","sessionid","window","location","replace","M","cfg","wwwroot","hidden","destroy","show","that","Database","initDb","webSocket","WebSocket","onopen","firstquestion","data","jqid","value","add","push","setCurrentQuestion","getNextQuestion","removeClass","initSession","endSession","onmessage","ev","msgDecrypt","Encryptor","decrypt","JSON","parse","action","undefined","msg","sendMessageSocket","stringify","identifier","students","html","normalizeUser","each","i","student","templateContext","picture","name","render","count","message","dispatchEvent","Event","scrollTop","scrollHeight","onerror","onclose","code","prepend","nextQuestion","manageNext","pauseQuestion","playQuestion","resendSelf","jumpTo","detail","questionEnd","showAnswers","hideAnswers","showStatistics","hideStatistics","showFeedback","hideFeedback","once","currentQuestion","state","update","setNextQuestion","setEndSession","endData","delete","manual","nextquestion","endsession","firstQuestion","get","onsuccess","result","visible","initPanel","isteacher","js","runTemplateJS","LOADING","notifyFilterContentUpdated","querySelector","requestResume","responseResume","requestResults","responseResults","finished","deleteDb","deleteDatabase","error","alert","nextQuestionData","finalRanking","provisionalRanking","deleted","currentQuestionData","questionNumber","position","question","statistics","CustomEvent","currentQuestiondata","send"],"mappings":"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"}