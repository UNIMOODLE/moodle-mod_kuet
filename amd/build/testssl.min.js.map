{"version":3,"file":"testssl.min.js","sources":["../src/testssl.js"],"sourcesContent":["define(['jquery', 'core/str', 'core/notification'], function($, str, notification) {\n    \"use strict\";\n\n    let portUrl = '8080';\n\n    /**\n     * @constructor\n     * @param {String} region\n     * @param {String} port\n     */\n    function TestSockets(region, port) {\n        this.root = $(region);\n        portUrl = port;\n        this.portUrl = port;\n        // eslint-disable-next-line no-console\n        console.log('port', portUrl, region);\n        this.initTestSockets();\n    }\n\n    // eslint-disable-next-line no-console\n    console.log('port fuera', this.portUrl);\n\n    /** @type {jQuery} The jQuery node for the page region. */\n    TestSockets.prototype.root = null;\n    TestSockets.prototype.portUrl = null;\n    TestSockets.prototype.webSocket = new WebSocket(\n        'wss://' + M.cfg.wwwroot.replace(/^https?:\\/\\//, '') + ':' + this.portUrl + '/jqshow'\n    );\n\n    let messageBox = null;\n\n    TestSockets.prototype.initTestSockets = function() {\n        messageBox = this.root.find('#testresult');\n    };\n\n    TestSockets.prototype.webSocket.onopen = function() {\n        str.get_strings([\n            {key: 'validcertificates', component: 'mod_jqshow'}\n        ]).done(function(strings) {\n            messageBox.append('<div class=\"alert alert-success\" role=\"alert\">' + strings[0] + '</div>');\n            let msg = {\n                'action': 'shutdownTest',\n            };\n            TestSockets.prototype.sendMessageSocket(JSON.stringify(msg));\n        }).fail(notification.exception);\n    };\n\n    TestSockets.prototype.webSocket.onerror = function() {\n        str.get_strings([\n            {key: 'invalidcertificates', component: 'mod_jqshow'}\n        ]).done(function(strings) {\n            messageBox.append('<div class=\"alert alert-danger\" role=\"alert\">' + strings[0] + '</div>');\n        }).fail(notification.exception);\n    };\n\n    TestSockets.prototype.webSocket.onclose = function() {\n        str.get_strings([\n            {key: 'socketclosed', component: 'mod_jqshow'}\n        ]).done(function(strings) {\n            messageBox.append('<div class=\"alert alert-warning\" role=\"alert\">' + strings[0] + '</div>');\n        }).fail(notification.exception);\n    };\n\n    TestSockets.prototype.sendMessageSocket = function(msg) {\n        this.webSocket.send(msg);\n    };\n\n    return {\n        /**\n         * @param {String} region\n         * @param {String} port\n         * @return {TestSockets}\n         */\n        initTestSockets: function(region, port) {\n            return new TestSockets(region, port);\n        },\n    };\n\n});\n"],"names":["define","$","str","notification","portUrl","TestSockets","region","port","this","root","console","log","initTestSockets","prototype","webSocket","WebSocket","M","cfg","wwwroot","replace","messageBox","find","onopen","get_strings","key","component","done","strings","append","sendMessageSocket","JSON","stringify","action","fail","exception","onerror","onclose","msg","send"],"mappings":"AAAAA,OAAO,qBAAA,CAAC,SAAU,WAAY,sBAAsB,SAASC,EAAGC,IAAKC,cAGjE,IAAIC,QAAU,OAOd,SAASC,YAAYC,OAAQC,MACzBC,KAAKC,KAAOR,EAAEK,QACdF,QAAUG,KACVC,KAAKJ,QAAUG,KAEfG,QAAQC,IAAI,OAAQP,QAASE,QAC7BE,KAAKI,iBACT,CAGAF,QAAQC,IAAI,aAAcH,KAAKJ,SAG/BC,YAAYQ,UAAUJ,KAAO,KAC7BJ,YAAYQ,UAAUT,QAAU,KAChCC,YAAYQ,UAAUC,UAAY,IAAIC,UAClC,SAAWC,EAAEC,IAAIC,QAAQC,QAAQ,eAAgB,IAAM,IAAMX,KAAKJ,QAAU,WAGhF,IAAIgB,WAAa,KAsCjB,OApCAf,YAAYQ,UAAUD,gBAAkB,WACpCQ,WAAaZ,KAAKC,KAAKY,KAAK,gBAGhChB,YAAYQ,UAAUC,UAAUQ,OAAS,WACrCpB,IAAIqB,YAAY,CACZ,CAACC,IAAK,oBAAqBC,UAAW,gBACvCC,MAAK,SAASC,SACbP,WAAWQ,OAAO,iDAAmDD,QAAQ,GAAK,UAIlFtB,YAAYQ,UAAUgB,kBAAkBC,KAAKC,UAHnC,CACNC,OAAU,iBAGjB,IAAEC,KAAK9B,aAAa+B,YAGzB7B,YAAYQ,UAAUC,UAAUqB,QAAU,WACtCjC,IAAIqB,YAAY,CACZ,CAACC,IAAK,sBAAuBC,UAAW,gBACzCC,MAAK,SAASC,SACbP,WAAWQ,OAAO,gDAAkDD,QAAQ,GAAK,SACpF,IAAEM,KAAK9B,aAAa+B,YAGzB7B,YAAYQ,UAAUC,UAAUsB,QAAU,WACtClC,IAAIqB,YAAY,CACZ,CAACC,IAAK,eAAgBC,UAAW,gBAClCC,MAAK,SAASC,SACbP,WAAWQ,OAAO,iDAAmDD,QAAQ,GAAK,SACrF,IAAEM,KAAK9B,aAAa+B,YAGzB7B,YAAYQ,UAAUgB,kBAAoB,SAASQ,KAC/C7B,KAAKM,UAAUwB,KAAKD,MAGjB,CAMHzB,gBAAiB,SAASN,OAAQC,MAC9B,OAAO,IAAIF,YAAYC,OAAQC,KACnC,EAGR"}