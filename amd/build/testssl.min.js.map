{"version":3,"file":"testssl.min.js","sources":["../src/testssl.js"],"sourcesContent":["define(['jquery', 'core/str', 'core/notification'], function($, str, notification) {\r\n    \"use strict\";\r\n\r\n    let portUrl = '8080';\r\n\r\n    /**\r\n     * @constructor\r\n     * @param {String} region\r\n     * @param {String} port\r\n     */\r\n    function TestSockets(region, port) {\r\n        this.root = $(region);\r\n        portUrl = port;\r\n        this.initTestSockets();\r\n    }\r\n\r\n    /** @type {jQuery} The jQuery node for the page region. */\r\n    TestSockets.prototype.root = null;\r\n\r\n    let messageBox = null;\r\n\r\n    TestSockets.prototype.initTestSockets = function() {\r\n        messageBox = this.root.find('#testresult');\r\n\r\n        TestSockets.prototype.webSocket = new WebSocket(\r\n            'wss://' + M.cfg.wwwroot.replace(/^https?:\\/\\//, '') + ':' + portUrl + '/testjqshow'\r\n        );\r\n\r\n        TestSockets.prototype.webSocket.onopen = function() {\r\n            str.get_strings([\r\n                {key: 'validcertificates', component: 'mod_jqshow'}\r\n            ]).done(function(strings) {\r\n                messageBox.append('<div class=\"alert alert-success\" role=\"alert\">' + strings[0] + '</div>');\r\n                let msg = {\r\n                    'action': 'shutdownTest',\r\n                };\r\n                TestSockets.prototype.sendMessageSocket(JSON.stringify(msg));\r\n            }).fail(notification.exception);\r\n        };\r\n\r\n        TestSockets.prototype.webSocket.onerror = function() {\r\n            str.get_strings([\r\n                {key: 'invalidcertificates', component: 'mod_jqshow'}\r\n            ]).done(function(strings) {\r\n                messageBox.append('<div class=\"alert alert-danger\" role=\"alert\">' + strings[0] + '</div>');\r\n            }).fail(notification.exception);\r\n        };\r\n\r\n        TestSockets.prototype.webSocket.onclose = function() {\r\n            str.get_strings([\r\n                {key: 'socketclosed', component: 'mod_jqshow'}\r\n            ]).done(function(strings) {\r\n                messageBox.append('<div class=\"alert alert-warning\" role=\"alert\">' + strings[0] + '</div>');\r\n            }).fail(notification.exception);\r\n        };\r\n    };\r\n\r\n    TestSockets.prototype.sendMessageSocket = function(msg) {\r\n        this.webSocket.send(msg);\r\n    };\r\n\r\n    return {\r\n        /**\r\n         * @param {String} region\r\n         * @param {String} port\r\n         * @return {TestSockets}\r\n         */\r\n        initTestSockets: function(region, port) {\r\n            return new TestSockets(region, port);\r\n        },\r\n    };\r\n});\r\n"],"names":["define","$","str","notification","portUrl","TestSockets","region","port","root","initTestSockets","prototype","messageBox","this","find","webSocket","WebSocket","M","cfg","wwwroot","replace","onopen","get_strings","key","component","done","strings","append","sendMessageSocket","JSON","stringify","fail","exception","onerror","onclose","msg","send"],"mappings":"AAAAA,4BAAO,CAAC,SAAU,WAAY,sBAAsB,SAASC,EAAGC,IAAKC,kBAG7DC,QAAU,gBAOLC,YAAYC,OAAQC,WACpBC,KAAOP,EAAEK,QACdF,QAAUG,UACLE,kBAITJ,YAAYK,UAAUF,KAAO,SAEzBG,WAAa,YAEjBN,YAAYK,UAAUD,gBAAkB,WACpCE,WAAaC,KAAKJ,KAAKK,KAAK,eAE5BR,YAAYK,UAAUI,UAAY,IAAIC,UAClC,SAAWC,EAAEC,IAAIC,QAAQC,QAAQ,eAAgB,IAAM,IAAMf,QAAU,eAG3EC,YAAYK,UAAUI,UAAUM,OAAS,WACrClB,IAAImB,YAAY,CACZ,CAACC,IAAK,oBAAqBC,UAAW,gBACvCC,MAAK,SAASC,SACbd,WAAWe,OAAO,iDAAmDD,QAAQ,GAAK,UAIlFpB,YAAYK,UAAUiB,kBAAkBC,KAAKC,UAHnC,QACI,qBAGfC,KAAK3B,aAAa4B,YAGzB1B,YAAYK,UAAUI,UAAUkB,QAAU,WACtC9B,IAAImB,YAAY,CACZ,CAACC,IAAK,sBAAuBC,UAAW,gBACzCC,MAAK,SAASC,SACbd,WAAWe,OAAO,gDAAkDD,QAAQ,GAAK,aAClFK,KAAK3B,aAAa4B,YAGzB1B,YAAYK,UAAUI,UAAUmB,QAAU,WACtC/B,IAAImB,YAAY,CACZ,CAACC,IAAK,eAAgBC,UAAW,gBAClCC,MAAK,SAASC,SACbd,WAAWe,OAAO,iDAAmDD,QAAQ,GAAK,aACnFK,KAAK3B,aAAa4B,aAI7B1B,YAAYK,UAAUiB,kBAAoB,SAASO,UAC1CpB,UAAUqB,KAAKD,MAGjB,CAMHzB,gBAAiB,SAASH,OAAQC,aACvB,IAAIF,YAAYC,OAAQC,OAG1C"}