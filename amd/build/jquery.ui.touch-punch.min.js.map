{"version":3,"file":"jquery.ui.touch-punch.min.js","sources":["../src/jquery.ui.touch-punch.js"],"sourcesContent":["/*\n * JQuery UI Touch Punch 1.0.9 as modified by RWAP Software\n * based on original touchpunch v0.2.3 which has not been updated since 2014\n *\n * Updates by RWAP Software to take account of various suggested changes on the original code issues\n *\n * Original: https://github.com/furf/jquery-ui-touch-punch\n * Copyright 2011â€“2014, Dave Furfero\n * Dual licensed under the MIT or GPL Version 2 licenses.\n *\n * Fork: https://github.com/RWAP/jquery-ui-touch-punch\n *\n * Depends:\n * jquery.ui.widget.js\n * jquery.ui.mouse.js\n */\n\n(function(factory) {\n    if (typeof define === \"function\" && define.amd) {\n\n        // AMD. Register as an anonymous module.\n        define([\"jquery\", \"jquery-ui\"], factory);\n    } else {\n        // eslint-disable-next-line no-undef\n        factory(jQuery);\n    }\n}(function($) {\n\n    // Detect touch support - Windows Surface devices and other touch devices.\n    $.mspointer = window.navigator.msPointerEnabled;\n    $.touch = ('ontouchstart' in document\n       || 'ontouchstart' in window\n       || window.TouchEvent\n        // eslint-disable-next-line no-undef\n       || (window.DocumentTouch && document instanceof DocumentTouch)\n       || navigator.maxTouchPoints > 0\n       || navigator.msMaxTouchPoints > 0\n    );\n\n    // Ignore browsers without touch or mouse support.\n    if ((!$.touch && !$.mspointer) || !$.ui.mouse) {\n        return;\n    }\n\n    let mouseProto = $.ui.mouse.prototype,\n      _mouseInit = mouseProto._mouseInit,\n      _mouseDestroy = mouseProto._mouseDestroy,\n      touchHandled;\n\n    /**\n     * Get the x,y position of a touch event\n     * @param {Object} event A touch event\n     */\n    function getTouchCoords(event) {\n        return {\n            x: event.originalEvent.changedTouches[0].pageX,\n            y: event.originalEvent.changedTouches[0].pageY\n        };\n    }\n\n    /**\n     * Simulate a mouse event based on a corresponding touch event\n     * @param {Object} event A touch event\n     * @param {String} simulatedType The corresponding mouse event\n     */\n    function simulateMouseEvent(event, simulatedType) {\n\n        // Ignore multi-touch events.\n        if (event.originalEvent.touches.length > 1) {\n            return;\n        }\n\n        // Ignore input or textarea elements so user can still enter text.\n        if ($(event.target).is(\"input\") || $(event.target).is(\"textarea\")) {\n            return;\n        }\n\n        // Prevent \"Ignored attempt to cancel a touchmove event with cancelable=false\" errors.\n        if (event.cancelable) {\n            event.preventDefault();\n        }\n\n        let touch = event.originalEvent.changedTouches[0],\n        simulatedEvent = document.createEvent('MouseEvents');\n\n        // Initialize the simulated mouse event using the touch event's coordinates.\n        simulatedEvent.initMouseEvent(\n        simulatedType,\n        true,\n        true,\n        window,\n        1,\n        touch.screenX,\n        touch.screenY,\n        touch.clientX,\n        touch.clientY,\n        false,\n        false,\n        false,\n        false,\n        0,\n        null\n        );\n\n        // Dispatch the simulated event to the target element.\n        event.target.dispatchEvent(simulatedEvent);\n    }\n\n    /**\n     * Handle the jQuery UI widget's touchstart events\n     * @param {Object} event The widget element's touchstart event\n     */\n    mouseProto._touchStart = function(event) {\n\n        let self = this;\n\n        // Interaction time.\n        this._startedMove = event.timeStamp;\n\n        // Track movement to determine if interaction was a click.\n        self._startPos = getTouchCoords(event);\n\n        // Ignore the event if another widget is already being handled.\n        if (touchHandled || !self._mouseCapture(event.originalEvent.changedTouches[0])) {\n            return;\n        }\n\n        // Set the flag to prevent other widgets from inheriting the touch event.\n        touchHandled = true;\n\n        // Track movement to determine if interaction was a click.\n        self._touchMoved = false;\n\n        // Simulate the mouseover event.\n        simulateMouseEvent(event, 'mouseover');\n\n        // Simulate the mousemove event.\n        simulateMouseEvent(event, 'mousemove');\n\n        // Simulate the mousedown event.\n        simulateMouseEvent(event, 'mousedown');\n    };\n\n    /**\n     * Handle the jQuery UI widget's touchmove events\n     * @param {Object} event The document's touchmove event\n     */\n    mouseProto._touchMove = function(event) {\n\n        // Ignore event if not handled.\n        if (!touchHandled) {\n            return;\n        }\n\n        // Interaction was moved.\n        this._touchMoved = true;\n\n        // Simulate the mousemove event.\n        simulateMouseEvent(event, 'mousemove');\n    };\n\n    /**\n     * Handle the jQuery UI widget's touchend events\n     * @param {Object} event The document's touchend event\n     */\n    mouseProto._touchEnd = function(event) {\n\n        // Ignore event if not handled.\n        if (!touchHandled) {\n            return;\n        }\n\n        // Simulate the mouseup event.\n        simulateMouseEvent(event, 'mouseup');\n\n        // Simulate the mouseout event.\n        simulateMouseEvent(event, 'mouseout');\n\n        // If the touch interaction did not move, it should trigger a click\n        // Check for this in two ways - length of time of simulation and distance moved\n        // Allow for Apple Stylus to be used also.\n        let timeMoving = event.timeStamp - this._startedMove;\n        if (!this._touchMoved || timeMoving < 500) {\n            // Simulate the click event.\n            simulateMouseEvent(event, 'click');\n        } else {\n            let endPos = getTouchCoords(event);\n            if ((Math.abs(endPos.x - this._startPos.x) < 10) && (Math.abs(endPos.y - this._startPos.y) < 10)) {\n\n                // If the touch interaction did not move, it should trigger a click.\n                if (!this._touchMoved || event.originalEvent.changedTouches[0].touchType === 'stylus') {\n                    // Simulate the click event.\n                    simulateMouseEvent(event, 'click');\n                }\n            }\n        }\n\n        // Unset the flag to determine the touch movement stopped.\n        this._touchMoved = false;\n\n        // Unset the flag to allow other widgets to inherit the touch event.\n        touchHandled = false;\n    };\n\n    /**\n     * A duck punch of the $.ui.mouse _mouseInit method to support touch events.\n     * This method extends the widget with bound touch event handlers that\n     * translate touch events to mouse events and pass them to the widget's\n     * original mouse event handling methods.\n     */\n    mouseProto._mouseInit = function() {\n\n        let self = this;\n\n        // Microsoft Surface Support = remove original touch Action.\n        if ($.support.mspointer) {\n            self.element[0].style.msTouchAction = 'none';\n        }\n\n        // Delegate the touch handlers to the widget's element.\n        self.element.on({\n            touchstart: $.proxy(self, '_touchStart'),\n            touchmove: $.proxy(self, '_touchMove'),\n            touchend: $.proxy(self, '_touchEnd')\n        });\n\n        // Call the original $.ui.mouse init method.\n        _mouseInit.call(self);\n    };\n\n    /**\n     * Remove the touch event handlers\n     */\n    mouseProto._mouseDestroy = function() {\n\n        let self = this;\n\n        // Delegate the touch handlers to the widget's element.\n        self.element.off({\n            touchstart: $.proxy(self, '_touchStart'),\n            touchmove: $.proxy(self, '_touchMove'),\n            touchend: $.proxy(self, '_touchEnd')\n        });\n\n        // Call the original $.ui.mouse destroy method.\n        _mouseDestroy.call(self);\n    };\n\n}));\n"],"names":["factory","$","mspointer","window","navigator","msPointerEnabled","touch","document","TouchEvent","DocumentTouch","maxTouchPoints","msMaxTouchPoints","ui","mouse","touchHandled","mouseProto","prototype","_mouseInit","_mouseDestroy","_touchStart","event","this","_startedMove","timeStamp","_startPos","getTouchCoords","_mouseCapture","originalEvent","changedTouches","_touchMoved","simulateMouseEvent","_touchMove","_touchEnd","timeMoving","endPos","Math","abs","x","y","touchType","support","element","style","msTouchAction","on","touchstart","proxy","touchmove","touchend","call","off","pageX","pageY","simulatedType","touches","length","target","is","cancelable","preventDefault","simulatedEvent","createEvent","initMouseEvent","screenX","screenY","clientX","clientY","dispatchEvent","define","amd","jQuery"],"mappings":"AAiBC,IAASA,gBASR,SAASC,GAcP,GAXAA,EAAEC,UAAYC,OAAOC,UAAUC,iBAC/BJ,EAAEK,MAAS,iBAAkBC,UACvB,iBAAkBJ,QAClBA,OAAOK,YAENL,OAAOM,eAAiBF,oBAAoBE,eAC7CL,UAAUM,eAAiB,GAC3BN,UAAUO,iBAAmB,GAI7BV,EAAEK,OAAUL,EAAEC,YAAeD,EAAEW,GAAGC,MAAxC,CAIA,IAGEC,aAHEC,WAAad,EAAEW,GAAGC,MAAMG,UAC1BC,WAAaF,WAAWE,WACxBC,cAAgBH,WAAWG,cAkE7BH,WAAWI,YAAc,SAASC,OAK9BC,KAAKC,aAAeF,MAAMG,UAHfF,KAMNG,UAAYC,eAAeL,QAG5BN,cATOO,KASeK,cAAcN,MAAMO,cAAcC,eAAe,MAK3Ed,cAAe,EAdJO,KAiBNQ,aAAc,EAGnBC,mBAAmBV,MAAO,aAG1BU,mBAAmBV,MAAO,aAG1BU,mBAAmBV,MAAO,eAO9BL,WAAWgB,WAAa,SAASX,OAGxBN,eAKLO,KAAKQ,aAAc,EAGnBC,mBAAmBV,MAAO,eAO9BL,WAAWiB,UAAY,SAASZ,OAG5B,GAAKN,aAAL,CAKAgB,mBAAmBV,MAAO,WAG1BU,mBAAmBV,MAAO,YAK1B,IAAIa,WAAab,MAAMG,UAAYF,KAAKC,aACxC,IAAKD,KAAKQ,aAAeI,WAAa,IAElCH,mBAAmBV,MAAO,aACvB,CACH,IAAIc,OAAST,eAAeL,OACvBe,KAAKC,IAAIF,OAAOG,EAAIhB,KAAKG,UAAUa,GAAK,IAAQF,KAAKC,IAAIF,OAAOI,EAAIjB,KAAKG,UAAUc,GAAK,KAGpFjB,KAAKQ,aAAmE,WAApDT,MAAMO,cAAcC,eAAe,GAAGW,WAE3DT,mBAAmBV,MAAO,SAGtC,CAGAC,KAAKQ,aAAc,EAGnBf,cAAe,CA/Bf,GAwCJC,WAAWE,WAAa,WAKhBhB,EAAEuC,QAAQtC,YAHHmB,KAIFoB,QAAQ,GAAGC,MAAMC,cAAgB,QAJ/BtB,KAQNoB,QAAQG,GAAG,CACZC,WAAY5C,EAAE6C,MATPzB,KASmB,eAC1B0B,UAAW9C,EAAE6C,MAVNzB,KAUkB,cACzB2B,SAAU/C,EAAE6C,MAXLzB,KAWiB,eAI5BJ,WAAWgC,KAfA5B,OAqBfN,WAAWG,cAAgB,WAEZG,KAGNoB,QAAQS,IAAI,CACbL,WAAY5C,EAAE6C,MAJPzB,KAImB,eAC1B0B,UAAW9C,EAAE6C,MALNzB,KAKkB,cACzB2B,SAAU/C,EAAE6C,MANLzB,KAMiB,eAI5BH,cAAc+B,KAVH5B,MAjMf,CAWA,SAASI,eAAeL,OACpB,MAAO,CACHiB,EAAGjB,MAAMO,cAAcC,eAAe,GAAGuB,MACzCb,EAAGlB,MAAMO,cAAcC,eAAe,GAAGwB,MAEjD,CAOA,SAAStB,mBAAmBV,MAAOiC,eAG/B,KAAIjC,MAAMO,cAAc2B,QAAQC,OAAS,GAKrCtD,EAAEmB,MAAMoC,QAAQC,GAAG,UAAYxD,EAAEmB,MAAMoC,QAAQC,GAAG,aAAtD,CAKIrC,MAAMsC,YACNtC,MAAMuC,iBAGV,IAAIrD,MAAQc,MAAMO,cAAcC,eAAe,GAC/CgC,eAAiBrD,SAASsD,YAAY,eAGtCD,eAAeE,eACfT,eACA,GACA,EACAlD,OACA,EACAG,MAAMyD,QACNzD,MAAM0D,QACN1D,MAAM2D,QACN3D,MAAM4D,SACN,GACA,GACA,GACA,EACA,EACA,MAIA9C,MAAMoC,OAAOW,cAAcP,eA9B3B,CA+BJ,CA8IJ,EAtO0B,mBAAXQ,QAAyBA,OAAOC,IAGvCD,OAAM,mCAAC,CAAC,SAAU,aAAcpE,SAGhCA,QAAQsE"}