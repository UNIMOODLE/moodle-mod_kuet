{"version":3,"file":"teacher_programmedmode.min.js","sources":["../src/teacher_programmedmode.js"],"sourcesContent":["\"use strict\";\r\n/* eslint-disable no-unused-vars */ // TODO remove.\r\n\r\nimport jQuery from 'jquery';\r\nimport Ajax from 'core/ajax';\r\nimport Templates from 'core/templates';\r\nimport Notification from 'core/notification';\r\n\r\nlet REGION = {\r\n    LISTRESULTS: '[data-region=\"list-results\"]'\r\n};\r\n\r\nlet SERVICES = {\r\n    GETLISTRESULTS: 'mod_jqshow_getlistresults'\r\n};\r\n\r\nlet TEMPLATES = {\r\n    LOADING: 'core/overlay_loading',\r\n    LISTRESULTS: 'mod_jqshow/session/listresults'\r\n};\r\n\r\nlet cmId;\r\nlet sId;\r\n\r\n/**\r\n * @constructor\r\n * @param {String} selector\r\n */\r\nfunction ProgrammedMode(selector) {\r\n    this.node = jQuery(selector);\r\n    this.initProgrammedMode();\r\n}\r\n\r\n/** @type {jQuery} The jQuery node for the page region. */\r\nProgrammedMode.prototype.node = null;\r\n\r\nProgrammedMode.prototype.initProgrammedMode = function() {\r\n    sId = this.node.attr('data-sid');\r\n    cmId = this.node.attr('data-cmid');\r\n    setInterval(this.reloadList, 20000);\r\n};\r\n\r\nProgrammedMode.prototype.reloadList = function() {\r\n    Templates.render(TEMPLATES.LOADING, {visible: true}).done(function(html) {\r\n        let identifier = jQuery(REGION.LISTRESULTS);\r\n        identifier.append(html);\r\n        let request = {\r\n            methodname: SERVICES.GETLISTRESULTS,\r\n            args: {\r\n                sid: sId,\r\n                cmid: cmId\r\n            }\r\n        };\r\n        Ajax.call([request])[0].done(function(response) {\r\n            // eslint-disable-next-line promise/always-return\r\n            Templates.render(TEMPLATES.LISTRESULTS, response).then((html) => {\r\n                identifier.html(html);\r\n            }).fail(Notification.exception);\r\n        }).fail(Notification.exception);\r\n    });\r\n};\r\n\r\nexport const initProgrammedMode = (selector) => {\r\n    return new ProgrammedMode(selector);\r\n};\r\n"],"names":["cmId","sId","REGION","SERVICES","TEMPLATES","ProgrammedMode","selector","node","initProgrammedMode","prototype","this","attr","setInterval","reloadList","render","visible","done","html","identifier","append","request","methodname","args","sid","cmid","call","response","then","fail","Notification","exception"],"mappings":"2gBAqBIA,KACAC,IAdAC,mBACa,+BAGbC,wBACgB,4BAGhBC,kBACS,uBADTA,sBAEa,0CAURC,eAAeC,eACfC,MAAO,mBAAOD,eACdE,qBAITH,eAAeI,UAAUF,KAAO,KAEhCF,eAAeI,UAAUD,mBAAqB,WAC1CP,IAAMS,KAAKH,KAAKI,KAAK,YACrBX,KAAOU,KAAKH,KAAKI,KAAK,aACtBC,YAAYF,KAAKG,WAAY,MAGjCR,eAAeI,UAAUI,WAAa,8BACxBC,OAAOV,kBAAmB,CAACW,SAAS,IAAOC,MAAK,SAASC,UAC3DC,YAAa,mBAAOhB,oBACxBgB,WAAWC,OAAOF,UACdG,QAAU,CACVC,WAAYlB,wBACZmB,KAAM,CACFC,IAAKtB,IACLuB,KAAMxB,qBAGTyB,KAAK,CAACL,UAAU,GAAGJ,MAAK,SAASU,6BAExBZ,OAAOV,sBAAuBsB,UAAUC,MAAMV,OACpDC,WAAWD,KAAKA,SACjBW,KAAKC,sBAAaC,cACtBF,KAAKC,sBAAaC,2CAIMxB,UACxB,IAAID,eAAeC"}